language: python

cache: pip

python:
  - '3.6'
  - '3.7'
  - '3.8'

matrix:
  include:
    - dist: xenial

    # measure coverage here
    - dist: bionic
      python: '3.6'
      before_install:
        - pip install pytest-cov
      script:
        - pytest -n0 -v
        - pytest -n2 -v
        - pytest -n3 -v
        - pytest -n4 -v
        - pytest -n5 -v
        - pytest -n6 -v
        - pytest -n auto -v
        - pytest -n auto -v --cov --cov-report xml:coverage.xml
        - datum -h
      after_success:
        - bash <(curl -Ls https://coverage.codacy.com/get.sh) report -r coverage.xml

    - dist: bionic
      python: '3.7'
    - dist: bionic
      python: '3.8'

install:
  - pip install -e ./
  - pip install tensorflow
  - pip install pandas

script:
  - pytest -n 6
  - datum -h