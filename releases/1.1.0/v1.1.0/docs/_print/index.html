<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.83.1" /><link rel="canonical" type="text/html" href="../../docs/">
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="shortcut icon" href="../../favicons/favicon.ico" >
<link rel="apple-touch-icon" href="../../favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="../../favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="../../favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="../../favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="../../favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="../../favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="../../favicons/android-192x192.png" sizes="192x192">

<title>Dataset Management Framework Documentation | Dataset Management Framework</title>
<meta name="description" content=""><meta property="og:title" content="Dataset Management Framework Documentation" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/docs/" /><meta property="og:site_name" content="Dataset Management Framework" />

<meta itemprop="name" content="Dataset Management Framework Documentation">
<meta itemprop="description" content=""><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Dataset Management Framework Documentation"/>
<meta name="twitter:description" content=""/>




<link rel="preload" href="../../scss/main.min.7739044bd284ace8b77f1ace79422fd408a2224eb69c6b8d48ef94dde2a179d5.css" as="style">
<link href="../../scss/main.min.7739044bd284ace8b77f1ace79422fd408a2224eb69c6b8d48ef94dde2a179d5.css" rel="stylesheet" integrity="">


<script
  src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script
  src="https://unpkg.com/lunr@2.3.8/lunr.min.js"
  integrity="sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY"
  crossorigin="anonymous"></script>






<link rel="stylesheet" href="../../css/prism.css"/>




  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
  <a class="navbar-brand" href="../../docs">
    <span class="navbar-logo"></span><span class="font-weight-bold">Dataset Management Framework</span>
  </a>
  <div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
    <ul class="navbar-nav mt-2 mt-lg-0">
      
      
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          
          
          
          
          
          
          <a class="nav-link" href="https://github.com/openvinotoolkit/datumaro"  ><i class='fab fa-github'></i><span>GitHub</span></a>
        </li>
      
        <li class="nav-item mr-4 mb-2 mb-lg-0" id="api">
          <a class="nav-link" href="../../api">API documentation</a>
        </li>
      
        <li class="nav-item dropdown mr-4 d-lg-block">
          

<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
  v1.1.0
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
  
    
      <a class="dropdown-item" href="../../../docs/">develop</a>
  
    
      <a class="dropdown-item" href="../../../v0.1.11/docs/">v0.1.11</a>
  
    
      <a class="dropdown-item" href="../../../v0.2/docs/">v0.2</a>
  
    
      <a class="dropdown-item" href="../../../v0.2.1/docs/">v0.2.1</a>
  
    
      <a class="dropdown-item" href="../../../v0.2.2/docs/">v0.2.2</a>
  
    
      <a class="dropdown-item" href="../../../v0.2.3/docs/">v0.2.3</a>
  
    
      <a class="dropdown-item" href="../../../v0.3/docs/">v0.3</a>
  
    
      <a class="dropdown-item" href="../../../v0.3.1/docs/">v0.3.1</a>
  
    
      <a class="dropdown-item" href="../../../v0.4.0.1/docs/">v0.4.0.1</a>
  
    
      <a class="dropdown-item" href="../../../v0.5.0/docs/">v0.5.0</a>
  
    
      <a class="dropdown-item" href="../../../v1.0.0/docs/">v1.0.0</a>
  
    
      <a class="dropdown-item" href="../../../v1.1.0/docs/">v1.1.0</a>
  
    
      <a class="dropdown-item" href="../../../v1.1.1/docs/">v1.1.1</a>
  
</div>

        </li>
      
      
    </ul>
  </div>
  <div class="navbar-nav d-none d-lg-block">



<input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="../../offline-search-index.c2180cb2be93210a79a607bc1e10fc8d.json"
  data-offline-search-base-href="../../"
  data-offline-search-max-results="10"
>

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="../../docs/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Dataset Management Framework Documentation</h1>





    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-a2e0f2893b70992c6087c2b17584ff57">Getting started</a></li>


    
  
    
    
	
<li>2: <a href="#pg-d26475bf8fc8b8ed51bb729174e4f140">Datumaro Design</a></li>


    
  
    
    
	
<li>3: <a href="#pg-51280cd90e811e9a5b92d6efa07a3fc2">Python API</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.1: <a href="#pg-4589e108cd5668cad04e0aa56d93820a">Python API examples</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.1.1: <a href="#pg-470931050952784a99b033df0c69cc9e">Dataset handler</a></li>


    
  
    
    
	
<li>3.1.2: <a href="#pg-7b4c1de1f9948a604e7fc1d63b098186">Encrypt dataset</a></li>


    
  
    
    
	
<li>3.1.3: <a href="#pg-d22c8257996d6304d291c66c3c33124a">Filter</a></li>


    
  
    
    
	
<li>3.1.4: <a href="#pg-7ef556051ce6caeaa3f31ee1cc6ecff8">Generate</a></li>


    
  
    
    
	
<li>3.1.5: <a href="#pg-b0c9559c5ed42fcdd5bda4ed10c616ca">Tiling</a></li>


    
  
    
    
	
<li>3.1.6: <a href="#pg-0193213cb21ffce50d3050ebfa4a7ae3">Transform</a></li>


    
  
    
    
	
<li>3.1.7: <a href="#pg-9aac665420e943bc1aa24a8aca49f9eb">E2E example for Yolo-Ultralytics trainer</a></li>


    
  
    
    
	
<li>3.1.8: <a href="#pg-8e2d30ae95cfb5d1314854228dff860c">Validate</a></li>


    
  
    
    
	
<li>3.1.9: <a href="#pg-aed9ec50c99aa4d45f1e0650e9aab7b7">Visualizer</a></li>


    
  

    </ul>
    
  

    </ul>
    
  
    
    
	
<li>4: <a href="#pg-50e921a7f98d7d8805f5b0dd1d77c3ff">User Manual</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>4.1: <a href="#pg-2fd872d8324159163839d61ecf8df6e0">How to use Datumaro</a></li>


    
  
    
    
	
<li>4.2: <a href="#pg-e01f40253edcc386a1afe3472db8c825">Supported Formats</a></li>


    
  
    
    
	
<li>4.3: <a href="#pg-b6af0aff51a35789907ac069c481b8c7">Media formats</a></li>


    
  
    
    
	
<li>4.4: <a href="#pg-13498051bfc5d3b0beef06b7439a50a6">Command reference</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>4.4.1: <a href="#pg-70c651cad336e515180a9b8eed13f292">Checkout</a></li>


    
  
    
    
	
<li>4.4.2: <a href="#pg-6c14c8898a52d18d0040b216c7faf6a6">Commit</a></li>


    
  
    
    
	
<li>4.4.3: <a href="#pg-a343cd09a10c892413f1c9e19af35d61">Convert datasets</a></li>


    
  
    
    
	
<li>4.4.4: <a href="#pg-4cdc48f6e2e41c6dd35af61e5748ac77">Create project</a></li>


    
  
    
    
	
<li>4.4.5: <a href="#pg-93c9f45615f89ceac9312b63ffcf8b65">Describe downloadable datasets</a></li>


    
  
    
    
	
<li>4.4.6: <a href="#pg-3edc3b754a785c8818028837f5d7e754">Detect dataset format</a></li>


    
  
    
    
	
<li>4.4.7: <a href="#pg-cf615af9fbd176c3c8963db17cdccfec">Compare datasets</a></li>


    
  
    
    
	
<li>4.4.8: <a href="#pg-77963f24abb4e1f7e8cb372f0cf73ad7">Download datasets</a></li>


    
  
    
    
	
<li>4.4.9: <a href="#pg-5a841ebe671810e701d94cfd348da645">Run model inference explanation (explain)</a></li>


    
  
    
    
	
<li>4.4.10: <a href="#pg-bf2416754f5a95167671095e620607d7">Export Datasets</a></li>


    
  
    
    
	
<li>4.4.11: <a href="#pg-fb79096cff317cd3a11940138d12144a">Filter datasets</a></li>


    
  
    
    
	
<li>4.4.12: <a href="#pg-0c1db009ad311413c7036db1bd602bf0">Generate Datasets</a></li>


    
  
    
    
	
<li>4.4.13: <a href="#pg-08529e9683af8c1a879605b62306ea7a">Print dataset info</a></li>


    
  
    
    
	
<li>4.4.14: <a href="#pg-209bf2b1793403ac2d9c18c87a7dab54">Log</a></li>


    
  
    
    
	
<li>4.4.15: <a href="#pg-6758bfd1eb71e4d0b6c4bf4aca1806f1">Merge Datasets</a></li>


    
  
    
    
	
<li>4.4.16: <a href="#pg-db2ab356420634e305b5ea0550f9b9c3">Models</a></li>


    
  
    
    
	
<li>4.4.17: <a href="#pg-160c03d29dec976c331bb969c9551cf4">Patch Datasets</a></li>


    
  
    
    
	
<li>4.4.18: <a href="#pg-49c04c4e75f0995ee1c9c4c121d042c7">Projects</a></li>


    
  
    
    
	
<li>4.4.19: <a href="#pg-c2f8a93a24bacb198650741c90e7c052">Search datasets</a></li>


    
  
    
    
	
<li>4.4.20: <a href="#pg-dc182af461d71cbd7217b8679bde29bc">Sources</a></li>


    
  
    
    
	
<li>4.4.21: <a href="#pg-645d2da4c36696ec093ba5e3ce99c77c">Get Project Statistics</a></li>


    
  
    
    
	
<li>4.4.22: <a href="#pg-a818e6c810d9d8ef27c2b0f440145895">Status</a></li>


    
  
    
    
	
<li>4.4.23: <a href="#pg-86897105a5f038a99bfe0935866c69ce">Transform Dataset</a></li>


    
  
    
    
	
<li>4.4.24: <a href="#pg-10150a1a6326aa9e8f2020442e6da77d">Utilities</a></li>


    
  
    
    
	
<li>4.4.25: <a href="#pg-a6fd93528e84d29a5a0d58dbccb92724">Validate Dataset</a></li>


    
  

    </ul>
    
  
    
    
	
<li>4.5: <a href="#pg-5425ff20f66ad27cecd1cec97424d239">Extending</a></li>


    
  
    
    
	
<li>4.6: <a href="#pg-769eb55c675e353516911aa676486a8c">Links</a></li>


    
  
    
    
	
<li>4.7: <a href="#pg-f6582e1039317c10889db7a3a9231d9f">How to control telemetry data collection</a></li>


    
  

    </ul>
    
  
    
    
	
<li>5: <a href="#pg-c4f3b7b6687248fa052de696ab2cf167">Formats</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>5.1: <a href="#pg-7b335946c4e1c1cd7917e256f9ed089a">NYU Depth Dataset V2</a></li>


    
  
    
    
	
<li>5.2: <a href="#pg-1646a51944fb0a27e86b592702a3eda8">ADE20k (v2017)</a></li>


    
  
    
    
	
<li>5.3: <a href="#pg-22c9ec5acd736f4b76466752445697c5">ADE20k (v2020)</a></li>


    
  
    
    
	
<li>5.4: <a href="#pg-f20c26628d349ff890dd5cd005e9f851">Align CelebA</a></li>


    
  
    
    
	
<li>5.5: <a href="#pg-9c8aae20b55b28eeccea7db9dc9d165f">AVA action</a></li>


    
  
    
    
	
<li>5.6: <a href="#pg-a9ac2e8e3eb539b281d9d06f9d906506">BraTS</a></li>


    
  
    
    
	
<li>5.7: <a href="#pg-ffe3e5d96a7d39ef06e636ccb30640dc">BraTS Numpy</a></li>


    
  
    
    
	
<li>5.8: <a href="#pg-371aa98e0519c0c055b8ef101dec2080">CelebA</a></li>


    
  
    
    
	
<li>5.9: <a href="#pg-ddb50cccf6304e9bb85b1b9fb0369c48">CIFAR</a></li>


    
  
    
    
	
<li>5.10: <a href="#pg-b4837f6e880fb91ac1bc5f75998df382">Cityscapes</a></li>


    
  
    
    
	
<li>5.11: <a href="#pg-f3691abbbae7eae85ce83b256e5aec64">COCO</a></li>


    
  
    
    
	
<li>5.12: <a href="#pg-dc7c8d0a431dc29fa653d95ad0142fa6">Common Semantic Segmentation</a></li>


    
  
    
    
	
<li>5.13: <a href="#pg-70ad816d48fd3a880f1fd7c3d38c73fb">Common Super Resolution</a></li>


    
  
    
    
	
<li>5.14: <a href="#pg-b609bb1f95fb3092dcde65b871e94fed">Datumaro</a></li>


    
  
    
    
	
<li>5.15: <a href="#pg-d63660400495cc60b092b7673dc82013">DatumaroBinary</a></li>


    
  
    
    
	
<li>5.16: <a href="#pg-9c502db72874fd0b813f297ee04b2391">ICDAR</a></li>


    
  
    
    
	
<li>5.17: <a href="#pg-69397e43070456769c1b4fdb55f75baf">Image zip</a></li>


    
  
    
    
	
<li>5.18: <a href="#pg-91e6aa400d029f03bff463e9b96b334c">ImageNet</a></li>


    
  
    
    
	
<li>5.19: <a href="#pg-c23396cbb18b060ffca5492eb3b20fe0">Kinetics</a></li>


    
  
    
    
	
<li>5.20: <a href="#pg-342fda6e82df12e35a4cf02ae46d4bab">KITTI</a></li>


    
  
    
    
	
<li>5.21: <a href="#pg-3a73527e621d046bb88cc355b73eb8dd">LFW</a></li>


    
  
    
    
	
<li>5.22: <a href="#pg-1e4c6d683fee0e4d48d435e66064eab9">Mapillary Vistas</a></li>


    
  
    
    
	
<li>5.23: <a href="#pg-bbc15af9ed7559fac248c0c8bbffadd9">Market-1501</a></li>


    
  
    
    
	
<li>5.24: <a href="#pg-bf920c551f5225f4f58da3de45a4a820">MARS</a></li>


    
  
    
    
	
<li>5.25: <a href="#pg-a2db7ecd3bd406d8822366b9b33229dd">MNIST</a></li>


    
  
    
    
	
<li>5.26: <a href="#pg-333c850baac99b48bc21f68354e1eddc">MPII Human Pose Dataset</a></li>


    
  
    
    
	
<li>5.27: <a href="#pg-2a1b098a1d0fff03296325f67eaafc8b">MPII Human Pose Dataset (JSON)</a></li>


    
  
    
    
	
<li>5.28: <a href="#pg-63609210ea058dde30ab67b20cc936b7">MVTec AD</a></li>


    
  
    
    
	
<li>5.29: <a href="#pg-f97053c70a29d6713d3412af07bcdcca">Open Images</a></li>


    
  
    
    
	
<li>5.30: <a href="#pg-db1d30fa5536c19aa2aa75b33dbf92ea">Pascal VOC</a></li>


    
  
    
    
	
<li>5.31: <a href="#pg-0c9b196a180c68b9b42be11ddc52c8bb">Supervisely Point Cloud</a></li>


    
  
    
    
	
<li>5.32: <a href="#pg-ce33d4e30ead378e5921038c30e7a0bf">SYNTHIA</a></li>


    
  
    
    
	
<li>5.33: <a href="#pg-bc1c599a20f4d5c48cfd2ed514e3f166">Velodyne Points / KITTI Raw 3D</a></li>


    
  
    
    
	
<li>5.34: <a href="#pg-eb23d21da40c4ef53f89d57813e46708">Vgg Face2 CSV</a></li>


    
  
    
    
	
<li>5.35: <a href="#pg-e5fe2fdda92db64d1736d255d4d50ef4">Video</a></li>


    
  
    
    
	
<li>5.36: <a href="#pg-380867834e6811ae51a317687af11e27">VoTT CSV</a></li>


    
  
    
    
	
<li>5.37: <a href="#pg-8a75782b4046ca46b25aa3933564c2f1">VoTT JSON</a></li>


    
  
    
    
	
<li>5.38: <a href="#pg-a962132bc0e143f3a9b4c97def6ab2ba">WIDER Face</a></li>


    
  
    
    
	
<li>5.39: <a href="#pg-f638f1a110145e49bc81ee72961dd7ef">YOLO</a></li>


    
  
    
    
	
<li>5.40: <a href="#pg-b1944d9ac875eeb7ed131a1bd440f5f5">YOLO-Ultralytics</a></li>


    
  

    </ul>
    
  
    
    
	
<li>6: <a href="#pg-bb346cf0596c62e042775b393e7fd9b8">Plugins</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>6.1: <a href="#pg-900c5314d5f38425d40d967abd17bea1">OpenVINO™ Inference Interpreter</a></li>


    
  

    </ul>
    
  
    
    
	
<li>7: <a href="#pg-05b7a8e562e0a482b29460c121776963">Contribution Guide</a></li>


    
  
    
    
	
<li>8: <a href="#pg-bf73365d45cbeba80db44f1ed292b48e">Release notes</a></li>


    
  

    </ul>


<div class="content">
      <p>Welcome to the documentation for the Dataset Management Framework (Datumaro).</p>
<p>The Datumaro is a free framework and CLI tool for building, transforming,
and analyzing datasets.
It is developed and used by Intel to build, transform, and analyze annotations
and datasets in a large number of <a href="../../docs/user-manual/supported_formats/">supported formats</a>.</p>
<p>Our documentation provides information for AI researchers, developers,
and teams, who are working with datasets and annotations.</p>
<div class="text-center">
<pre><code class="language-mermaid" data-lang="mermaid">flowchart LR
    datasets[(VOC dataset&lt;br/&gt;+&lt;br/&gt;COCO datset&lt;br/&gt;+&lt;br/&gt;CVAT annotation)]
    datumaro{Datumaro}
    dataset[dataset]
    annotation[Annotation tool]
    training[Model training]
    publication[Publication, statistics etc]
    datasets--&gt;datumaro
    datumaro--&gt;dataset
    dataset--&gt;annotation &amp; training &amp; publication
</code></pre></div>
<!--lint disable maximum-line-length-->
<section id="docs">



 
<a id="td-block-0" class="td-offset-anchor"></a>
<section class="row td-box td-box--docs td-box--gradient td-box--height-auto">
	<div class="col">
		<div class="row ">
			
				<div class="col-lg-4 mb-5 mb-lg-0 text-center ">
  <div class="mb-4 h1">
    <i class="fas fa-sign-in-alt"></i>
  </div>
  <h4 class="h3"><a href="../../docs/getting_started/">Getting started</a></h4>
  <p class="mb-0"><p>Basic information and sections needed for a quick start.</p>
</p>
</div>
<div class="col-lg-4 mb-5 mb-lg-0 text-center ">
  <div class="mb-4 h1">
    <i class="fas fa-book"></i>
  </div>
  <h4 class="h3"><a href="../../docs/user-manual/">User Manual</a></h4>
  <p class="mb-0"><p>This section contains documents for Datumaro users.</p>
</p>
</div>
<div class="col-lg-4 mb-5 mb-lg-0 text-center ">
  <div class="mb-4 h1">
    <i class="fas fa-code"></i>
  </div>
  <h4 class="h3"><a href="../../api/api/developer_manual.html">Developer Manual</a></h4>
  <p class="mb-0"><p>Documentation for Datumaro developers.</p>
</p>
</div>

			
		</div>
	</div>
</section>

</section>
<!--lint enable maximum-line-length-->

</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a2e0f2893b70992c6087c2b17584ff57">1 - Getting started</h1>
    
	<p>To read about the design concept and features of Datumaro, go to the <a href="../../docs/design/">design section</a>.</p>
<h2 id="installation">Installation</h2>
<h3 id="dependencies">Dependencies</h3>
<ul>
<li>Python (3.7+)</li>
<li>Optional: OpenVINO, TensorFlow, PyTorch, MxNet, Caffe, Accuracy Checker, Git</li>
</ul>
<h3 id="installation-steps">Installation steps</h3>
<p>Optionally, set up a virtual environment:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python -m pip install virtualenv
python -m virtualenv venv
. venv/bin/activate
</code></pre></div><p>Install:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># From PyPI:</span>
pip install datumaro<span style="color:#ce5c00;font-weight:bold">[</span>default<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># From the GitHub repository:</span>
pip install <span style="color:#4e9a06">&#39;git+https://github.com/openvinotoolkit/datumaro[default]&#39;</span>
</code></pre></div><p>Read more about choosing between <code>datumaro</code> and <code>datumaro[default]</code>
<a href="#customizing-installation">here</a>.</p>
<h4 id="plugins">Plugins</h4>
<p>Datumaro has many plugins, which are responsible for dataset formats,
model launchers and other optional components. If a plugin has dependencies,
they can require additional installation. You can find the list of all the
plugin dependencies in the <a href="../../docs/user-manual/extending">plugins</a> section.</p>
<h4 id="customizing-installation">Customizing installation</h4>
<ul>
<li>
<p>Datumaro has the following installation options:</p>
<ul>
<li><code>pip install datumaro</code> - for core library functionality</li>
<li><code>pip install datumaro[default]</code> - for normal CLI experience</li>
</ul>
<p>In restricted installation environments, where some dependencies are
not available, or if you need only the core library functionality,
you can install Datumaro without extra plugins.</p>
<p>The CLI variant (<code>datumaro[default]</code>) requires Git to be installed and
available to work with Datumaro projects and dataset versioning features.
You can find installation instructions for your platform <a href="https://git-scm.com/downloads">here</a>.</p>
<p>In some cases, installing just the core library may be not enough,
because there can be limited options of installing graphical libraries
in the system (various Docker environments, servers etc). You can select
between using <code>opencv-python</code> and <code>opencv-python-headless</code> by setting the
<code>DATUMARO_HEADLESS</code> environment variable to <code>0</code> or <code>1</code> before installing
the package. It requires installation from sources (using <code>--no-binary</code>):</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#000">DATUMARO_HEADLESS</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span> pip install datumaro --no-binary<span style="color:#ce5c00;font-weight:bold">=</span>datumaro
</code></pre></div><p>This option can&rsquo;t be covered by extras due to Python packaging system
limitations.</p>
</li>
<li>
<p>When installing directly from the repository, you can change the
installation branch with <code>...@&lt;branch_name&gt;</code>. Also use <code>--force-reinstall</code>
parameter in this case. It can be useful for testing of unreleased
versions from GitHub pull requests.</p>
</li>
</ul>
<h2 id="usage">Usage</h2>
<p>There are several options available:</p>
<ul>
<li><a href="#standalone-tool">A standalone command-line tool</a></li>
<li><a href="#python-module">A python module</a></li>
</ul>
<h3 id="standalone-tool">Standalone tool</h3>
<p>Datuaro as a standalone tool allows to do various dataset operations from
the command line interface:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum --help
python -m datumaro --help
</code></pre></div><h3 id="python-module">Python module</h3>
<p>Datumaro can be used in custom scripts as a Python module. Used this way, it
allows to use its features from an existing codebase, enabling dataset
reading, exporting and iteration capabilities, simplifying integration of custom
formats and providing high performance operations:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;path/&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#8f5902;font-style:italic"># keep only annotated images</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">lambda</span> <span style="color:#000">item</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">item</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">annotations</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#8f5902;font-style:italic"># change dataset labels and corresponding annotations</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">transform</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;remap_labels&#39;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000">mapping</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span>
      <span style="color:#4e9a06">&#39;cat&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;dog&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic"># rename cat to dog</span>
      <span style="color:#4e9a06">&#39;truck&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;car&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic"># rename truck to car</span>
      <span style="color:#4e9a06">&#39;person&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic"># remove this label</span>
    <span style="color:#000;font-weight:bold">},</span>
    <span style="color:#000">default</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;delete&#39;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#8f5902;font-style:italic"># remove everything else</span>

<span style="color:#8f5902;font-style:italic"># iterate over the dataset elements</span>
<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">item</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">dataset</span><span style="color:#000;font-weight:bold">:</span>
    <span style="color:#204a87;font-weight:bold">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">item</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">item</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">annotations</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#8f5902;font-style:italic"># export the resulting dataset in COCO format</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;dst/dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;coco&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_images</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p><a href="../../api/api/datumaro.html">List of components</a> with the comfortable importing.</p>
<blockquote>
<p>Check our <a href="../../api/api/developer_manual.html">developer manual</a> for additional
information.</p>
</blockquote>
<h2 id="examples">Examples</h2>
<!--lint disable list-item-indent-->
<!--lint disable list-item-bullet-indent-->
<ul>
<li>
<p>Convert PASCAL VOC dataset to COCO format, keep only images with <code>cat</code> class
presented:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># Download VOC dataset:</span>
<span style="color:#8f5902;font-style:italic"># http://host.robots.ox.ac.uk/pascal/VOC/voc2012/VOCtrainval_11-May-2012.tar</span>
datum convert --input-format voc --input-path &lt;path/to/voc&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>              --output-format coco <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>              --filter <span style="color:#4e9a06">&#39;/item[annotation/label=&#34;cat&#34;]&#39;</span> <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>              -- --reindex <span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#8f5902;font-style:italic"># avoid annotation id conflicts</span>
</code></pre></div></li>
<li>
<p>Convert only non-<code>occluded</code> annotations from a
<a href="https://github.com/openvinotoolkit/cvat">CVAT</a> project to TFrecord:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export Datumaro dataset in CVAT UI, extract somewhere, go to the project dir</span>
datum filter -e <span style="color:#4e9a06">&#39;/item/annotation[occluded=&#34;False&#34;]&#39;</span> --mode items+anno
datum <span style="color:#204a87">export</span> --format tf_detection_api -- --save-images
</code></pre></div></li>
<li>
<p>Annotate MS COCO dataset, extract image subset, re-annotate it in
<a href="https://github.com/openvinotoolkit/cvat">CVAT</a>, update old dataset:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># Download COCO dataset http://cocodataset.org/#download</span>
<span style="color:#8f5902;font-style:italic"># Put images to coco/images/ and annotations to coco/annotations/</span>
datum create
datum import --format coco &lt;path/to/coco&gt;
datum <span style="color:#204a87">export</span> --filter <span style="color:#4e9a06">&#39;/image[images_I_dont_like]&#39;</span> --format cvat
<span style="color:#8f5902;font-style:italic"># import dataset and images to CVAT, re-annotate</span>
<span style="color:#8f5902;font-style:italic"># export Datumaro project, extract to &#39;reannotation-upd&#39;</span>
datum project update reannotation-upd
datum <span style="color:#204a87">export</span> --format coco
</code></pre></div></li>
<li>
<p>Annotate instance polygons in
<a href="https://github.com/openvinotoolkit/cvat">CVAT</a>, export as masks in COCO:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert --input-format cvat --input-path &lt;path/to/cvat.xml&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>              --output-format coco -- --segmentation-mode masks
</code></pre></div></li>
<li>
<p>Apply an OpenVINO detection model to some COCO-like dataset,
then compare annotations with ground truth and visualize in TensorBoard:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format coco &lt;path/to/coco&gt;
<span style="color:#8f5902;font-style:italic"># create model results interpretation script</span>
datum model add -n mymodel openvino <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --weights model.bin --description model.xml <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --interpretation-script parse_results.py
datum model run --model -n mymodel --output-dir mymodel_inference/
datum diff mymodel_inference/ --format tensorboard --output-dir diff
</code></pre></div></li>
<li>
<p>Change colors in PASCAL VOC-like <code>.png</code> masks:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format voc &lt;path/to/voc/dataset&gt;

<span style="color:#8f5902;font-style:italic"># Create a color map file with desired colors:</span>
<span style="color:#8f5902;font-style:italic">#</span>
<span style="color:#8f5902;font-style:italic"># label : color_rgb : parts : actions</span>
<span style="color:#8f5902;font-style:italic"># cat:0,0,255::</span>
<span style="color:#8f5902;font-style:italic"># dog:255,0,0::</span>
<span style="color:#8f5902;font-style:italic">#</span>
<span style="color:#8f5902;font-style:italic"># Save as mycolormap.txt</span>

datum <span style="color:#204a87">export</span> --format voc_segmentation -- --label-map mycolormap.txt
<span style="color:#8f5902;font-style:italic"># add &#34;--apply-colormap=0&#34; to save grayscale (indexed) masks</span>
<span style="color:#8f5902;font-style:italic"># check &#34;--help&#34; option for more info</span>
<span style="color:#8f5902;font-style:italic"># use &#34;datum --loglevel debug&#34; for extra conversion info</span>
</code></pre></div></li>
<li>
<p>Create a custom COCO-like dataset:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">numpy</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">np</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#000;font-weight:bold">([</span>
  <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;image1&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">subset</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;train&#39;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)),</span>
    <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
      <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Bbox</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">),</span>
    <span style="color:#000;font-weight:bold">]</span>
  <span style="color:#000;font-weight:bold">),</span>
  <span style="color:#8f5902;font-style:italic"># ...</span>
<span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;cat&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;dog&#39;</span><span style="color:#000;font-weight:bold">])</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;test_dataset/&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;coco&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div></li>
</ul>
<!--lint enable list-item-bullet-indent-->
<!--lint enable list-item-indent-->

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-d26475bf8fc8b8ed51bb729174e4f140">2 - Datumaro Design</h1>
    
	<!--lint disable list-item-indent-->
<h2 id="concept">Concept</h2>
<p>Datumaro is:</p>
<ul>
<li>a tool to build composite datasets and iterate over them</li>
<li>a tool to create and maintain datasets
<ul>
<li>Version control of annotations and images</li>
<li>Publication (with removal of sensitive information)</li>
<li>Editing</li>
<li>Joining and splitting</li>
<li>Exporting, format changing</li>
<li>Image preprocessing</li>
</ul>
</li>
<li>a dataset storage</li>
<li>a tool to debug datasets
<ul>
<li>A network can be used to generate
informative data subsets (e.g. with false-positives)
to be analyzed further</li>
</ul>
</li>
</ul>
<h3 id="requirements">Requirements</h3>
<ul>
<li>User interfaces
<ul>
<li>a library</li>
<li>a console tool with visualization means</li>
</ul>
</li>
<li>Targets: single datasets, composite datasets, single images / videos</li>
<li>Built-in support for well-known annotation formats and datasets:
CVAT, COCO, PASCAL VOC, Cityscapes, ImageNet</li>
<li>Extensibility with user-provided components</li>
<li>Lightweightness - it should be easy to start working with Datumaro
<ul>
<li>Minimal dependency on environment and configuration</li>
<li>It should be easier to use Datumaro than writing own code
for computation of statistics or dataset manipulations</li>
</ul>
</li>
</ul>
<h3 id="functionality-and-ideas">Functionality and ideas</h3>
<ul>
<li>Blur sensitive areas on dataset images</li>
<li>Dataset annotation filters, relabelling etc.</li>
<li>Dataset augmentation</li>
<li>Calculation of statistics:
<ul>
<li>Mean &amp; std, custom stats</li>
</ul>
</li>
<li>&ldquo;Edit&rdquo; command to modify annotations</li>
<li>Versioning (for images, annotations, subsets, sources etc., comparison)</li>
<li>Documentation generation</li>
<li>Provision of iterators for user code</li>
<li>Dataset downloading</li>
<li>Dataset generation</li>
<li>Dataset building (export in a specific format, indexation, statistics,
documentation)</li>
<li>Dataset exporting to other formats</li>
<li>Dataset debugging (run inference, generate dataset slices, compute statistics)</li>
<li>&ldquo;Explainable AI&rdquo; - highlight network attention areas (<a href="https://arxiv.org/abs/1901.04592">paper</a>)
<ul>
<li>Black-box approach
<ul>
<li>Classification, Detection, Segmentation, Captioning</li>
<li>White-box approach</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="research-topics">Research topics</h3>
<ul>
<li>exploration of network prediction uncertainty (aka Bayessian approach)
Use case: explanation of network &ldquo;quality&rdquo;, &ldquo;stability&rdquo;, &ldquo;certainty&rdquo;</li>
<li>adversarial attacks on networks</li>
<li>dataset minification / reduction
Use case: removal of redundant information to reach the same network quality
with lesser training time</li>
<li>dataset expansion and filtration of additions
Use case: add only important data</li>
<li>guidance for key frame selection for tracking (<a href="https://arxiv.org/abs/1903.11779">paper</a>)
Use case: more effective annotation, better predictions</li>
</ul>
<h2 id="rc-1-vision">RC 1 vision</h2>
<h3 id="cvat-integration">CVAT integration</h3>
<p>Datumaro needs to be integrated with <a href="https://github.com/openvinotoolkit/cvat">CVAT</a>,
extending CVAT UI capabilities regarding task and project operations.
It should be capable of downloading and processing data from CVAT.</p>
<!--lint disable fenced-code-flag-->
<pre><code>        User
          |
          v
 +------------------+
 |       CVAT       |
 +--------v---------+       +------------------+       +--------------+
 | Datumaro module  | ----&gt; | Datumaro project | &lt;---&gt; | Datumaro CLI | &lt;--- User
 +------------------+       +------------------+       +--------------+
</code></pre><!--lint enable fenced-code-flag-->
<h3 id="interfaces">Interfaces</h3>
<ul>
<li><input checked="" disabled="" type="checkbox"> Python API for user code
<ul>
<li><input checked="" disabled="" type="checkbox"> Installation as a package</li>
<li><input checked="" disabled="" type="checkbox"> Installation with <code>pip</code> by name</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> A command-line tool for dataset manipulations</li>
</ul>
<h3 id="features">Features</h3>
<ul>
<li>
<p>Dataset format support (reading, writing)</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Own format</li>
<li><input checked="" disabled="" type="checkbox"> CVAT</li>
<li><input checked="" disabled="" type="checkbox"> COCO</li>
<li><input checked="" disabled="" type="checkbox"> PASCAL VOC</li>
<li><input checked="" disabled="" type="checkbox"> YOLO</li>
<li><input checked="" disabled="" type="checkbox"> TF Detection API</li>
<li><input checked="" disabled="" type="checkbox"> Cityscapes</li>
<li><input checked="" disabled="" type="checkbox"> ImageNet</li>
</ul>
</li>
<li>
<p>Dataset visualization (<code>show</code>)</p>
<ul>
<li><input disabled="" type="checkbox"> Ability to visualize a dataset
<ul>
<li><input disabled="" type="checkbox"> with TensorBoard</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Calculation of statistics for datasets</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Pixel mean, std</li>
<li><input checked="" disabled="" type="checkbox"> Object counts (detection scenario)</li>
<li><input checked="" disabled="" type="checkbox"> Image-Class distribution (classification scenario)</li>
<li><input checked="" disabled="" type="checkbox"> Pixel-Class distribution (segmentation scenario)</li>
<li><input checked="" disabled="" type="checkbox"> Image similarity clusters</li>
<li><input disabled="" type="checkbox"> Custom statistics</li>
</ul>
</li>
<li>
<p>Dataset building</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Composite dataset building</li>
<li><input checked="" disabled="" type="checkbox"> Class remapping</li>
<li><input checked="" disabled="" type="checkbox"> Subset splitting</li>
<li><input checked="" disabled="" type="checkbox"> Dataset filtering (<code>extract</code>)</li>
<li><input checked="" disabled="" type="checkbox"> Dataset merging (<code>merge</code>)</li>
<li><input disabled="" type="checkbox"> Dataset item editing (<code>edit</code>)</li>
</ul>
</li>
<li>
<p>Dataset comparison (<code>diff</code>)</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Annotation-annotation comparison</li>
<li><input checked="" disabled="" type="checkbox"> Annotation-inference comparison</li>
<li><input checked="" disabled="" type="checkbox"> Annotation quality estimation (for CVAT)
<ul>
<li>Provide a simple method to check
annotation quality with a model and generate summary</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Dataset and model debugging</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Inference explanation (<code>explain</code>)</li>
<li><input checked="" disabled="" type="checkbox"> Black-box approach (<a href="https://arxiv.org/abs/1806.07421">RISE paper</a>)</li>
<li><input checked="" disabled="" type="checkbox"> Ability to run a model on a dataset and read the results</li>
</ul>
</li>
<li>
<p>CVAT-integration features</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Task export
<ul>
<li><input checked="" disabled="" type="checkbox"> Datumaro project export</li>
<li><input checked="" disabled="" type="checkbox"> Dataset export</li>
<li><input checked="" disabled="" type="checkbox"> Original raw data (images, a video file) can be downloaded (exported)
together with annotations or just have links
on CVAT server (in future, support S3, etc)
<ul>
<li><input checked="" disabled="" type="checkbox"> Be able to use local files instead of remote links
<ul>
<li><input disabled="" type="checkbox"> Specify cache directory</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> Use case &ldquo;annotate for model training&rdquo;
<ul>
<li>create a task</li>
<li>annotate</li>
<li>export the task</li>
<li>convert to a training format</li>
<li>train a DL model</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> Use case &ldquo;annotate - reannotate problematic images - merge&rdquo;</li>
<li><input checked="" disabled="" type="checkbox"> Use case &ldquo;annotate and estimate quality&rdquo;
<ul>
<li>create a task</li>
<li>annotate</li>
<li>estimate quality of annotations</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="optional-features">Optional features</h3>
<ul>
<li>
<p>Dataset publishing</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Versioning (for annotations, subsets, sources, etc.)</li>
<li><input disabled="" type="checkbox"> Blur sensitive areas on images</li>
<li><input disabled="" type="checkbox"> Tracking of legal information</li>
<li><input disabled="" type="checkbox"> Documentation generation</li>
</ul>
</li>
<li>
<p>Dataset building</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Dataset minification / Extraction of the most representative subset
<ul>
<li>Use case: generate low-precision calibration dataset</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Dataset and model debugging</p>
<ul>
<li><input disabled="" type="checkbox"> Training visualization</li>
<li><input checked="" disabled="" type="checkbox"> Inference explanation (<code>explain</code>)
<ul>
<li><input disabled="" type="checkbox"> White-box approach</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="properties">Properties</h3>
<ul>
<li>Lightweightness</li>
<li>Modularity</li>
<li>Extensibility</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-51280cd90e811e9a5b92d6efa07a3fc2">3 - Python API</h1>
    
	<h2 id="what-is-python-api">What is Python API</h2>
<p>Datuamro provides Python API, which allows you to use the Datumaro features directly in your code.</p>
<p>There are some python API examples with Jupyter Notebook.</p>
<h2 id="contents">Contents</h2>
<ul>
<li><a href="./python-api-examples">Python API examples</a>
<ul>
<li><a href="./python-api-examples/dataset-handler">Dataset Handler</a></li>
<li><a href="./python-api-examples/visualizer">Visualizer</a></li>
<li><a href="./python-api-examples/filter">Filter</a></li>
<li><a href="./python-api-examples/transform">Transform</a></li>
<li><a href="./python-api-examples/generate">Generate</a></li>
<li><a href="./python-api-examples/validate">Validate</a></li>
<li><a href="./python-api-examples/tiling">Tiling</a></li>
</ul>
</li>
</ul>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-4589e108cd5668cad04e0aa56d93820a">3.1 - Python API examples</h1>
    
	<p>You can learn how to interact with the Datumaro python APIs via Jupyter Notebook examples as follows.</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-470931050952784a99b033df0c69cc9e">3.1.1 - Dataset handler</h1>
    
	<p>Datumaro provides the dataset import and export functionalities.</p>
<p>When importing multiple datasets, Datumaro helps to manipulate and merge them into a single
dataset. Since the manipulations such as reidentification, label redefinition, or filtration are
mostly the topic of transformation, we here describe how to merge two heterogeneous datasets
through <code>IntersectMerge</code>.</p>
<p>Jupyter Notebook Examples:

<iframe
    id="notebook_iframe"
    src="../nb_htmls/01_merge_multiple_datasets_for_classification.html"
    style="height:100%;width:100%;border:none;overflow:hidden;"
    scrolling="no"
    onload="resizeIframe(this)"></iframe>

<script>
    function resizeIframe(obj) {
        obj.style.height = obj.contentWindow.document.documentElement.scrollHeight + 'px';
    }
</script>


<iframe
    id="notebook_iframe"
    src="../nb_htmls/02_merge_heterogeneous_datasets_for_detection.html"
    style="height:100%;width:100%;border:none;overflow:hidden;"
    scrolling="no"
    onload="resizeIframe(this)"></iframe>

<script>
    function resizeIframe(obj) {
        obj.style.height = obj.contentWindow.document.documentElement.scrollHeight + 'px';
    }
</script>
</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-7b4c1de1f9948a604e7fc1d63b098186">3.1.2 - Encrypt dataset</h1>
    
	<p>Jupyter Notebook Examples: <a href="https://github.com/openvinotoolkit/datumaro/blob/develop/notebooks/09_encrypt_dataset.ipynb">Jupyter Notebook source file</a></p>

<iframe
    id="notebook_iframe"
    src="../nb_htmls/09_encrypt_dataset.html"
    style="height:100%;width:100%;border:none;overflow:hidden;"
    scrolling="no"
    onload="resizeIframe(this)"></iframe>

<script>
    function resizeIframe(obj) {
        obj.style.height = obj.contentWindow.document.documentElement.scrollHeight + 'px';
    }
</script>


</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-d22c8257996d6304d291c66c3c33124a">3.1.3 - Filter</h1>
    
	<p>This API allows you to filter a dataset to satisfy some conditions.
Here, XML <a href="https://devhints.io/xpath">XPath</a> is used as a query format.</p>
<p>For instance, with a given XML file below, we can filter a dataset by the subset name through
<code>/item[subset=&quot;minival2014&quot;]</code>, by the media id through <code>/item[id=&quot;290768&quot;]</code>, by the image sizes
through <code>/item[image/width=image/height]</code>, and annotation information such as id (<code>id</code>), type
(<code>type</code>), label (<code>label_id</code>), bounding box (<code>x, y, w, h</code>), etc.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#204a87;font-weight:bold">&lt;item&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;id&gt;</span>290768<span style="color:#204a87;font-weight:bold">&lt;/id&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;subset&gt;</span>minival2014<span style="color:#204a87;font-weight:bold">&lt;/subset&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;image&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;width&gt;</span>612<span style="color:#204a87;font-weight:bold">&lt;/width&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;height&gt;</span>612<span style="color:#204a87;font-weight:bold">&lt;/height&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;depth&gt;</span>3<span style="color:#204a87;font-weight:bold">&lt;/depth&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;/image&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;annotation&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;id&gt;</span>80154<span style="color:#204a87;font-weight:bold">&lt;/id&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;type&gt;</span>bbox<span style="color:#204a87;font-weight:bold">&lt;/type&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;label_id&gt;</span>39<span style="color:#204a87;font-weight:bold">&lt;/label_id&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;x&gt;</span>264.59<span style="color:#204a87;font-weight:bold">&lt;/x&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;y&gt;</span>150.25<span style="color:#204a87;font-weight:bold">&lt;/y&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;w&gt;</span>11.19<span style="color:#204a87;font-weight:bold">&lt;/w&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;h&gt;</span>42.31<span style="color:#204a87;font-weight:bold">&lt;/h&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;area&gt;</span>473.87<span style="color:#204a87;font-weight:bold">&lt;/area&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;/annotation&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;annotation&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;id&gt;</span>669839<span style="color:#204a87;font-weight:bold">&lt;/id&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;type&gt;</span>bbox<span style="color:#204a87;font-weight:bold">&lt;/type&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;label_id&gt;</span>41<span style="color:#204a87;font-weight:bold">&lt;/label_id&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;x&gt;</span>163.58<span style="color:#204a87;font-weight:bold">&lt;/x&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;y&gt;</span>191.75<span style="color:#204a87;font-weight:bold">&lt;/y&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;w&gt;</span>76.98<span style="color:#204a87;font-weight:bold">&lt;/w&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;h&gt;</span>73.63<span style="color:#204a87;font-weight:bold">&lt;/h&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;area&gt;</span>5668.77<span style="color:#204a87;font-weight:bold">&lt;/area&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;/annotation&gt;</span>
  ...
<span style="color:#204a87;font-weight:bold">&lt;/item&gt;</span>
</code></pre></div><p>For the annotation-based filtration, we need to set the argument <code>filter_annotations</code> to <code>True</code>.
We provide the argument <code>remove_empty</code> to remove all media with an empty annotation. We note that
datasets are updated in-place by default.</p>
<p>Jupyter Notebook Example:

<iframe
    id="notebook_iframe"
    src="../nb_htmls/04_filter.html"
    style="height:100%;width:100%;border:none;overflow:hidden;"
    scrolling="no"
    onload="resizeIframe(this)"></iframe>

<script>
    function resizeIframe(obj) {
        obj.style.height = obj.contentWindow.document.documentElement.scrollHeight + 'px';
    }
</script>
</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-7ef556051ce6caeaa3f31ee1cc6ecff8">3.1.4 - Generate</h1>
    
	<p>Need to update the description.</p>
<p>Jupyter Notebook Examples:
Need to update the description.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-b0c9559c5ed42fcdd5bda4ed10c616ca">3.1.5 - Tiling</h1>
    
	<h2 id="description">Description</h2>
<p>This API allows you to transform a dataset into a tiled one. This transform is known to be useful for detecting small objects in high-resolution input images <a href="#ref1">[1]</a>. In general, we resize the input image to be small enough for the network to afford in terms of memory and computational cost. This practice makes small objects much smaller that the neural network cannot distinguish them. The tiling transform increases the size of a small object&rsquo;s area relative to the network&rsquo;s receptive area to make it distinguishable. Therefore, this transform allows you to easily construct a dataset to train a model to detect small objects in high-resolution images.</p>
<h2 id="references">References</h2>
<ol>
    <li id="ref1">
        F., Ozge Unel, Burak O. Ozkalayci, and Cevahir Cigla. "The power of tiling for small object detection." Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition Workshops. 2019.
    </li>
</ol>
<h2 id="jupyter-notebook-example">Jupyter Notebook Example</h2>

<iframe
    id="notebook_iframe"
    src="../nb_htmls/06_tiling.html"
    style="height:100%;width:100%;border:none;overflow:hidden;"
    scrolling="no"
    onload="resizeIframe(this)"></iframe>

<script>
    function resizeIframe(obj) {
        obj.style.height = obj.contentWindow.document.documentElement.scrollHeight + 'px';
    }
</script>


</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0193213cb21ffce50d3050ebfa4a7ae3">3.1.6 - Transform</h1>
    
	<p>Need to update the description.</p>
<p>Jupyter Notebook Examples:
Need to update the description.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-9aac665420e943bc1aa24a8aca49f9eb">3.1.7 - E2E example for Yolo-Ultralytics trainer</h1>
    
	<p>Jupyter Notebook Examples: <a href="https://github.com/openvinotoolkit/datumaro/blob/develop/notebooks/08_e2e_example_yolo_ultralytics_trainer.ipynb">Jupyter Notebook source file</a></p>

<iframe
    id="notebook_iframe"
    src="../nb_htmls/08_e2e_example_yolo_ultralytics_trainer.html"
    style="height:100%;width:100%;border:none;overflow:hidden;"
    scrolling="no"
    onload="resizeIframe(this)"></iframe>

<script>
    function resizeIframe(obj) {
        obj.style.height = obj.contentWindow.document.documentElement.scrollHeight + 'px';
    }
</script>


</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-8e2d30ae95cfb5d1314854228dff860c">3.1.8 - Validate</h1>
    
	<p>Need to update the description.</p>
<p>Jupyter Notebook Examples:
Need to update the description.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-aed9ec50c99aa4d45f1e0650e9aab7b7">3.1.9 - Visualizer</h1>
    
	<p>This API allows you to visualize a dataset with media ids.</p>
<p>Although Datumaro supports various kinds of vision tasks, e.g., classification, object detection,
semantic segmentation, key point estimation, visual captioning, etc., we provide a task-agnostic
visualization tool. That is, regardless of annotation types, <code>vis_gallery</code> describes the multiple
annotation-overlapped images from a list of multiple media ids. We can control the transparency of
annotations over images by adjusting <code>alpha</code>.</p>
<p>Jupyter Notebook Example:

<iframe
    id="notebook_iframe"
    src="../nb_htmls/03_visualize.html"
    style="height:100%;width:100%;border:none;overflow:hidden;"
    scrolling="no"
    onload="resizeIframe(this)"></iframe>

<script>
    function resizeIframe(obj) {
        obj.style.height = obj.contentWindow.document.documentElement.scrollHeight + 'px';
    }
</script>
</p>

</div>



    
	
  

    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-50e921a7f98d7d8805f5b0dd1d77c3ff">4 - User Manual</h1>
    
	<h2 id="contents">Contents</h2>
<ul>
<li><a href="./how_to_use_datumaro">How to use Datumaro</a>
<ul>
<li><a href="./how_to_use_datumaro/#glossary">Glossary</a></li>
<li><a href="./how_to_use_datumaro/#command-line-workflow">Command-line workflow</a></li>
<li><a href="./how_to_use_datumaro/#data-model">Project data model</a></li>
<li><a href="./how_to_use_datumaro/#project-layout">Project layout</a></li>
<li><a href="./how_to_use_datumaro/#examples">Examples</a></li>
</ul>
</li>
<li><a href="./supported_formats">Supported dataset formats</a></li>
<li><a href="./supported_formats/#annotation-types">Supported annotation types</a></li>
<li><a href="./media_formats">Supported media formats</a></li>
<li><a href="./command-reference">Command reference</a>
<ul>
<li><a href="./command-reference/sources/#source-add">Add</a></li>
<li><a href="./command-reference/checkout">Checkout</a></li>
<li><a href="./command-reference/commit">Commit</a></li>
<li><a href="./command-reference/convert">Convert</a></li>
<li><a href="./command-reference/create">Create</a></li>
<li><a href="./command-reference/describe-downloads">Describe downloads</a></li>
<li><a href="./command-reference/detect-format">Detect format</a></li>
<li><a href="./command-reference/diff">Diff</a></li>
<li><a href="./command-reference/download">Download</a></li>
<li><a href="./command-reference/explain">Explain</a></li>
<li><a href="./command-reference/export">Export</a></li>
<li><a href="./command-reference/filter">Filter</a></li>
<li><a href="./command-reference/sources/#source-import">Import</a></li>
<li><a href="./command-reference/info">Info</a></li>
<li><a href="./command-reference/log">Log</a></li>
<li><a href="./command-reference/merge">Merge</a></li>
<li><a href="./command-reference/patch">Patch</a></li>
<li><a href="./command-reference/sources/#source-remove">Remove</a></li>
<li><a href="./command-reference/stats">Stats</a></li>
<li><a href="./command-reference/status">Status</a></li>
<li><a href="./command-reference/transform">Transform</a></li>
<li><a href="./command-reference/validate">Validate</a></li>
<li>Models:
<ul>
<li><a href="./command-reference/models/#model-add">Add</a></li>
<li><a href="./command-reference/models/#model-remove">Remove</a></li>
<li><a href="./command-reference/models/#model-run">Run</a></li>
</ul>
</li>
<li>Projects:
<ul>
<li><a href="./command-reference/projects/#project-info">Info</a></li>
<li><a href="./command-reference/projects/#project-migrate">Migrate</a></li>
</ul>
</li>
<li>Sources:
<ul>
<li><a href="./command-reference/sources/#source-add">Add</a></li>
<li><a href="./command-reference/sources/#source-import">Import</a></li>
<li><a href="./command-reference/sources/#source-remove">Remove</a></li>
</ul>
</li>
<li>Utilities:
<ul>
<li><a href="./command-reference/util/#split-video">Split Video</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="./extending">Extending</a>
<ul>
<li><a href="./extending/#builtin-plugins">Builtin plugins</a></li>
<li><a href="./extending/#dataset-formats">Dataset Formats</a></li>
<li><a href="./extending/#dataset-conversions">Dataset Conversions (&ldquo;Transforms&rdquo;)</a></li>
<li><a href="./extending/#model-launchers">Model launchers</a></li>
</ul>
</li>
<li><a href="#links">Links</a></li>
</ul>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-2fd872d8324159163839d61ecf8df6e0">4.1 - How to use Datumaro</h1>
    
	<p>As a standalone tool or a Python module:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum --help

python -m datumaro --help
python datumaro/ --help
python datum.py --help
</code></pre></div><p>As a Python library:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>
<span style="color:#ce5c00;font-weight:bold">...</span>
<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">path</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#ce5c00;font-weight:bold">...</span>
</code></pre></div><h3 id="glossary">Glossary</h3>
<ul>
<li>
<p>Basic concepts:</p>
<ul>
<li>Dataset - A collection of dataset items, which consist of media and
associated annotations.</li>
<li>Dataset item - A basic single element of the dataset. Also known as
&ldquo;sample&rdquo;, &ldquo;entry&rdquo;. In different datasets it can be an image, a video
frame, a whole video, a 3d point cloud etc. Typically, has corresponding
annotations.</li>
<li>(Datumaro) Project - A combination of multiple datasets, plugins,
models and metadata.</li>
</ul>
</li>
<li>
<p>Project versioning concepts:</p>
<ul>
<li>Data source - A link to a dataset or a copy of a dataset inside a project.
Basically, a URL + dataset format name.</li>
<li>Project revision - A commit or a reference from Git (branch, tag,
HEAD~3 etc.). A revision is referenced by data hash. The <code>HEAD</code>
revision is the currently selected revision of the project.</li>
<li>Revision tree - A project build tree and plugins at
a specified revision.</li>
<li>Working tree - The revision tree in the working directory of a project.</li>
<li>data source revision - a state of a data source at a specific stage.
A revision is referenced by the data hash.</li>
<li>Object - The data of a revision tree or a data source revision.
An object is referenced by the data hash.</li>
</ul>
</li>
<li>
<p>Dataset path concepts: <a id="revpath"></a></p>
<ul>
<li>
<p>Dataset revpath - A path to a dataset in a special format. They are
supposed to specify paths to files, directories or data source revisions
in a uniform way in the CLI.</p>
<ul>
<li>
<p>dataset path - a path to a dataset in the following format:
<code>&lt;dataset path&gt;:&lt;format&gt;</code></p>
<ul>
<li><code>format</code> is optional. If not specified, will try to detect automatically</li>
</ul>
</li>
<li>
<p><strong>rev</strong>ision path - a path to a data source revision in a project.
The syntax is:
<code>&lt;project path&gt;@&lt;revision&gt;:&lt;target name&gt;</code>, any part can be omitted.</p>
<ul>
<li>Default project is the current project (<code>-p</code>/<code>--project</code> CLI arg.)
Local revpaths imply that the current project is used and this part
should be omitted.</li>
<li>Default revision is the working tree of the project</li>
<li>Default build target is <code>project</code></li>
</ul>
<p>If a path refers to <code>project</code> (i.e. target name is not set, or
this target is exactly specified), the target dataset is the result of
<a href="../../api/api/developer_manual.html#merging">joining</a> all the project data
sources. Otherwise, if the path refers to a data source revision, the
corresponding stage from the revision build tree will be used.</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Dataset building concepts:</p>
<ul>
<li>Stage - A revision of a dataset - the original dataset or its modification
after transformation, filtration or something else. A build tree node.
A stage is referred by a name.</li>
<li>Build tree - A directed graph (tree) with root nodes at data sources
and a single top node called <code>project</code>, which represents
a <a href="../../api/api/developer_manual.html#merging">joined</a> dataset.
Each data source has a starting <code>root</code> node, which corresponds to the
original dataset. The internal graph nodes are stages.</li>
<li>Build target - A data source or a stage name. Data source names correspond
to the last stages of data sources.</li>
<li>Pipeline - A subgraph of a stage, which includes all the ancestors.</li>
</ul>
</li>
<li>
<p>Other:</p>
<ul>
<li>Transform - A transformation operation over dataset elements. Examples
are image renaming, image flipping, image and subset renaming,
label remapping etc. Corresponds to the <a href="../../docs/user-manual/command-reference/transform"><code>transform</code> command</a>.</li>
</ul>
</li>
</ul>
<h3 id="command-line-workflow">Command-line workflow</h3>
<p>In Datumaro, most command-line commands operate on projects, but there are
also few commands operating on datasets directly. There are 2 basic ways
to use Datumaro from the command-line:</p>
<ul>
<li>
<p>Use the <a href="../../docs/user-manual/command-reference/convert"><code>convert</code></a>
, <a href="../../docs/user-manual/command-reference/diff"><code>diff</code></a>
, <a href="../../docs/user-manual/command-reference/merge"><code>merge</code></a>
commands directly on existing datasets</p>
</li>
<li>
<p>Create a Datumaro project and operate on it:</p>
<ul>
<li>Create an empty project with <a href="../../docs/user-manual/command-reference/create"><code>create</code></a></li>
<li>Import existing datasets with <a href="../../docs/user-manual/command-reference/sources#source-import"><code>import</code></a></li>
<li>Modify the project with <a href="../../docs/user-manual/command-reference/transform"><code>transform</code></a> and <a href="../../docs/user-manual/command-reference/filter"><code>filter</code></a></li>
<li>Create new revisions of the project with
<a href="../../docs/user-manual/command-reference/commit"><code>commit</code></a>, navigate over
them using <a href="../../docs/user-manual/command-reference/checkout"><code>checkout</code></a>,
compare with <a href="../../docs/user-manual/command-reference/diff"><code>diff</code></a>, compute
statistics with <a href="../../docs/user-manual/command-reference/stats"><code>stats</code></a></li>
<li>Export the resulting dataset with <a href="../../docs/user-manual/command-reference/export"><code>export</code></a></li>
<li>Check project config with <a href="../../docs/user-manual/command-reference/projects/#print-project-info"><code>project info</code></a></li>
</ul>
</li>
</ul>
<p>Basically, a project is a combination of datasets, models and environment.</p>
<p>A project can contain an arbitrary number of datasets (<a href="../../docs/user-manual/how_to_use_datumaro#data-sources">data sources</a>).
A project acts as a manager for them and allows to manipulate them
separately or as a whole, in which case it combines dataset items
from all the sources into one composite dataset. You can manage separate
datasets in a project by commands in the <a href="../../docs/user-manual/command-reference/sources"><code>datum source</code></a>
command line context.</p>
<p>Note that <strong>modifying operations</strong> (<code>transform</code>, <code>filter</code>, <code>patch</code>)
<strong>are applied in-place</strong> to the datasets by default.</p>
<p>If you want to interact with models, you need to add them to the project
first using the <a href="../../docs/user-manual/command-reference/models/#register-model"><code>model add</code></a> command.</p>
<p>A typical way to obtain Datumaro projects is to export tasks in
<a href="https://github.com/openvinotoolkit/cvat">CVAT</a> UI.</p>
<p><a id="data-model"></a></p>
<h3 id="project-data-model">Project data model</h3>
<p><img src="../../images/project_model.svg" alt="project model"></p>
<p>Datumaro tries to combine a &ldquo;Git for datasets&rdquo; and a build system like
make or CMake for datasets in a single solution. Currently, <code>Project</code>
represents a Version Control System for datasets, which is based on Git and DVC
projects. Each project <code>Revision</code> describes a build tree of a dataset
with all the related metadata. A build tree consists of a number of data
sources and transformation stages. Each data source has its own set of build
steps (stages). Datumaro supposes copying of datasets and working in-place by
default. Modifying operations are recorded in the project, so any of the
dataset revisions can be reproduced when needed. Multiple dataset versions can
be stored in different branches with the common data shared.</p>
<p>Let&rsquo;s consider an example of a build tree:
<img src="../../images/build_tree.svg" alt="build tree">
There are 2 data sources in the example project. The resulting dataset
is obtained by simple merging (joining) the results of the input datasets.
&ldquo;Source 1&rdquo; and &ldquo;Source 2&rdquo; are the names of data sources in the project. Each
source has several stages with their own names. The first stage (called &ldquo;root&rdquo;)
represents the original contents of a data source - the data at the
user-provided URL. The following stages represent operations, which needs to
be done with the data source to prepare the resulting dataset.</p>
<p>Roughly, such build tree can be created by the following commands (arguments
are omitted for simplicity):</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create

<span style="color:#8f5902;font-style:italic"># describe the first source</span>
datum import &lt;...&gt; -n source1
datum filter &lt;...&gt; source1
datum transform &lt;...&gt; source1
datum transform &lt;...&gt; source1

<span style="color:#8f5902;font-style:italic"># describe the second source</span>
datum import &lt;...&gt; -n source2
datum model add &lt;...&gt;
datum transform &lt;...&gt; source2
datum transform &lt;...&gt; source2
</code></pre></div><p>Now, the resulting dataset can be built with:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum <span style="color:#204a87">export</span> &lt;...&gt;
</code></pre></div><h3 id="project-layout">Project layout</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">project/
├── .dvc/
├── .dvcignore
├── .git/
├── .gitignore
├── .datumaro/
│   ├── cache/ <span style="color:#8f5902;font-style:italic"># object cache</span>
│   │   └── &lt;<span style="color:#0000cf;font-weight:bold">2</span> leading symbols of obj hash&gt;/
│   │       └── &lt;remaining symbols of obj hash&gt;/
│   │           └── &lt;object data&gt;
│   │
│   ├── models/ <span style="color:#8f5902;font-style:italic"># project-specific models</span>
│   │
│   ├── plugins/ <span style="color:#8f5902;font-style:italic"># project-specific plugins</span>
│   │   ├── plugin1/ <span style="color:#8f5902;font-style:italic"># composite plugin, a directory</span>
│   │   <span style="color:#000;font-weight:bold">|</span>   ├── __init__.py
│   │   <span style="color:#000;font-weight:bold">|</span>   └── file2.py
│   │   ├── plugin2.py <span style="color:#8f5902;font-style:italic"># simple plugin, a file</span>
│   │   └── ...
│   │
│   ├── tmp/ <span style="color:#8f5902;font-style:italic"># temp files</span>
│   └── tree/ <span style="color:#8f5902;font-style:italic"># working tree metadata</span>
│       ├── config.yml
│       └── sources/
│           ├── &lt;<span style="color:#204a87">source</span> name 1&gt;.dvc
│           ├── &lt;<span style="color:#204a87">source</span> name 2&gt;.dvc
│           └── ...
│
├── &lt;<span style="color:#204a87">source</span> name 1&gt;/ <span style="color:#8f5902;font-style:italic"># working directory for the source 1</span>
│   └── &lt;<span style="color:#204a87">source</span> data&gt;
└── &lt;<span style="color:#204a87">source</span> name 2&gt;/ <span style="color:#8f5902;font-style:italic"># working directory for the source 2</span>
    └── &lt;<span style="color:#204a87">source</span> data&gt;
</code></pre></div><p><a id="data-sources"></a></p>
<h3 id="datasets-and-data-sources">Datasets and Data Sources</h3>
<p>A project can contain an arbitrary number of Data Sources. Each Data Source
describes a dataset in a specific format. A project acts as a manager for
the data sources and allows to manipulate them separately or as a whole, in
which case it combines dataset items from all the sources into one composite
dataset. You can manage separate sources in a project by commands in
the <a href="../../docs/user-manual/command-reference/sources"><code>datum source</code></a> command
line context.</p>
<p>Datasets come in a wide variety of formats. Each dataset
format defines its own data structure and rules on how to
interpret the data. For example, the following data structure
is used in COCO format:</p>
<pre><code>/dataset/
- /images/&lt;id&gt;.jpg
- /annotations/
</code></pre><p>Datumaro supports complete datasets, having both image data and
annotations, or incomplete ones, having annotations only.
Incomplete datasets can be used to prepare images and annotations
independently of each other, or to analyze or modify just the lightweight
annotations without the need to download the whole dataset.</p>
<p>Check <a href="../../docs/user-manual/supported_formats">supported formats</a> for more info
about format specifications, supported import and export options and other
details. The list of formats can be extended by custom plugins,
check <a href="../../docs/user-manual/extending">extending tips</a> for information on this
topic.</p>
<h3 id="use-cases">Use cases</h3>
<p>Let&rsquo;s consider few examples describing what Datumaro does for you behind the
scene.</p>
<p>The first example explains how working trees, working directories and the
cache interact. Suppose, there is a dataset which we want to modify and
export in some other format. To do it with Datumaro, we need to create a
project and register the dataset as a data source:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import &lt;...&gt; -n source1
</code></pre></div><p>The dataset will be copied to the working directory inside the project. It
will be added to the project working tree.</p>
<p>After the dataset is added, we want to transform it and filter out some
irrelevant samples, so we run the following commands:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform &lt;...&gt; source1
datum filter &lt;...&gt; source1
</code></pre></div><p>The commands modify the data source inside the working directory, inplace.
The operations done are recorded in the working tree.</p>
<p>Now, we want to make a new version of the dataset and make a snapshot in the
project cache. So we <code>commit</code> the working tree:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum commit &lt;...&gt;
</code></pre></div><p><img src="../../images/behavior_diag1.svg" alt="cache interaction diagram 1"></p>
<p>At this time, the data source is copied into the project cache and a new
project revision is created. The dataset operation history is saved, so
the dataset can be reproduced even if it is removed from the cache and the
working directory. Note, however, that the original dataset hash was not
computed, so Datumaro won&rsquo;t be able to compare dataset hash on re-downloading.
If it is desired, consider making a <code>commit</code> with an unmodified data source.</p>
<p>After this, we do some other modifications to the dataset and make a new
commit. Note that the dataset is not cached, until a <code>commit</code> is done.</p>
<p>When the dataset is ready and all the required operations are done, we
can <code>export</code> it to the required format. We can export the resulting dataset,
or any previous stage.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum <span style="color:#204a87">export</span> &lt;...&gt; source1
datum <span style="color:#204a87">export</span> &lt;...&gt; source1.stage3
</code></pre></div><p>Let&rsquo;s extend the example. Imagine we have a project with 2 data sources.
Roughly, it corresponds to the following set of commands:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import &lt;...&gt; -n source1
datum import &lt;...&gt; -n source2
datum transform &lt;...&gt; source1 <span style="color:#8f5902;font-style:italic"># used 3 times</span>
datum transform &lt;...&gt; source2 <span style="color:#8f5902;font-style:italic"># used 5 times</span>
</code></pre></div><p>Then, for some reasons, the project cache was cleaned from <code>source1</code> revisions.
We also don&rsquo;t have anything in the project working directories - suppose,
the user removed them to save disk space.</p>
<p>Let&rsquo;s see what happens, if we call the <code>diff</code> command with 2 different
revisions now.</p>
<p><img src="../../images/behavior_diag2.svg" alt="cache interaction diagram 2"></p>
<p>Datumaro needs to reproduce 2 dataset revisions requested so that they could
be read and compared. Let&rsquo;s see how the first dataset is reproduced
step-by-step:</p>
<ol>
<li><code>source1.stage2</code> will be looked for in the project cache. It won&rsquo;t be
found, since the cache was cleaned.</li>
<li>Then, Datumaro will look for previous source revisions in the cache
and won&rsquo;t find any.</li>
<li>The project can be marked read-only, if we are not working with the
&ldquo;current&rdquo; project (which is specified by the <code>-p/--project</code> command
parameter). In the example, the command is <code>datum diff rev1:... rev2:...</code>,
which means there is a project in the current directory, so the project
we are working with is not read-only. If a command target was specified as
<code>datum diff &lt;project&gt;@&lt;rev&gt;:&lt;source&gt;</code>, the project would be loaded
as read-only. If a project is read-only, we can&rsquo;t do anything more to
reproduce the dataset and can only exit with an error (3a). The reason for
such behavior is that the dataset downloading can be quite expensive (in
terms of time, disk space etc.). It is supposed, that such side-effects
should be controlled manually.</li>
<li>If the project is not read-only (3b), Datumaro will try to download
the original dataset and reproduce the resulting dataset. The data hash
will be computed and hashes will be compared (if the data source had hash
computed on addition). On success, the data will be put into the cache.</li>
<li>The downloaded dataset will be read and the remaining operations from the
source history will be re-applied.</li>
<li>The resulting dataset might be cached in some cases.</li>
<li>The resulting dataset is returned.</li>
</ol>
<p>The <code>source2</code> will be looked for the same way. In our case, it will be found
in the cache and returned. Once both datasets are restored and read, they
are compared.</p>
<p>Consider other situation. Let&rsquo;s try to <code>export</code> the <code>source1</code>. Suppose
we have a clear project cache and the <code>source1</code> has a copy in the working
directory.</p>
<p><img src="../../images/behavior_diag3.svg" alt="cache interaction diagram 3"></p>
<p>Again, Datumaro needs to reproduce a dataset revision (stage) requested.</p>
<ol>
<li>It looks for the dataset in the working directory and finds some data. If
there is no source working directory, Datumaro will try to reproduce the
source using the approach described above (1b).</li>
<li>The data hash is computed and compared with the one saved in the history.
If the hashes match, the dataset is read and returned (4).
Note: we can&rsquo;t use the cached hash stored in the working tree info -
it can be outdated, so we need to compute it again.</li>
<li>Otherwise, Datumaro tries to detect the stage by the data hash.
If the current stage is not cached, the tree is the working tree and the
working directory is not empty, the working copy is hashed and matched
against the source stage list. If there is a matching stage, it will be
read and the missing stages will be added. The result might be cached in
some cases.
If there is no matching stage in the source history, the situation can
be contradictory. Currently, an error is raised (3b).</li>
<li>The resulting dataset is returned.</li>
</ol>
<p>After the requested dataset is obtained, it is exported in the requested
format.</p>
<p>To sum up, Datumaro tries to restore a dataset from the project cache or
reproduce it from sources. It can be done as long as the source operations
are recorded and any step data is available. Note that cache objects share
common files, so if there are only annotation differences between datasets,
or data sources contain the same images, there will only be a single copy
of the related media files. This helps to keep storage use reasonable and
avoid unnecessary data copies.</p>
<p><a id="cli-examples"></a></p>
<h3 id="examples">Examples</h3>
<p>Example: create a project, add dataset, modify, restore an old version</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import &lt;path/to/dataset&gt; -f coco -n source1
datum commit -m <span style="color:#4e9a06">&#34;Added a dataset&#34;</span>
datum transform -t shapes_to_boxes
datum filter -e <span style="color:#4e9a06">&#39;/item/annotation[label=&#34;cat&#34; or label=&#34;dog&#34;]&#39;</span> -m i+a
datum commit -m <span style="color:#4e9a06">&#34;Transformed&#34;</span>
datum checkout HEAD~1 -- source1 <span style="color:#8f5902;font-style:italic"># restore a previous revision</span>
datum status <span style="color:#8f5902;font-style:italic"># prints &#34;modified source1&#34;</span>
datum checkout source1 <span style="color:#8f5902;font-style:italic"># restore the last revision</span>
datum <span style="color:#204a87">export</span> -f voc -- --save-images
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e01f40253edcc386a1afe3472db8c825">4.2 - Supported Formats</h1>
    
	<p>List of supported formats:</p>
<ul>
<li>ADE20k (v2017) (import-only)
<ul>
<li><a href="https://www.kaggle.com/soumikrakshit/ade20k">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/ade20k2017_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/ade20k2017">Format documentation</a></li>
</ul>
</li>
<li>ADE20k (v2020) (import-only)
<ul>
<li><a href="https://groups.csail.mit.edu/vision/datasets/ADE20K/">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/ade20k2020_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/ade20k2020">Format documentation</a></li>
</ul>
</li>
<li>Align CelebA (<code>classification</code>, <code>landmarks</code>) (import-only)
<ul>
<li><a href="https://mmlab.ie.cuhk.edu.hk/projects/CelebA.html">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/align_celeba_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/align_celeba">Format documentation</a></li>
</ul>
</li>
<li>BraTS (<code>segmentation</code>) (import-only)
<ul>
<li><a href="https://www.med.upenn.edu/sbia/brats2018/data.html">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/brats_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/brats">Format documentation</a></li>
</ul>
</li>
<li>BraTS Numpy (<code>detection</code>, <code>segmentation</code>) (import-only)
<ul>
<li><a href="https://www.med.upenn.edu/sbia/brats2018/data.html">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/brats_numpy_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/brats_numpy">Format documentation</a></li>
</ul>
</li>
<li>CamVid (<code>segmentation</code>)
<ul>
<li><a href="http://mi.eng.cam.ac.uk/research/projects/VideoRec/CamVid/">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/camvid_dataset">Dataset example</a></li>
</ul>
</li>
<li>CelebA (<code>classification</code>, <code>detection</code>, <code>landmarks</code>) (import-only)
<ul>
<li><a href="https://mmlab.ie.cuhk.edu.hk/projects/CelebA.html">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/celeba_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/celeba">Format documentation</a></li>
</ul>
</li>
<li>CIFAR-10/100 (<code>classification</code> (python version))
<ul>
<li><a href="https://www.cs.toronto.edu/~kriz/cifar.html">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/cifar10_dataset">Dataset example CIFAR-10</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/cifar100_dataset">Dataset example CIFAR-100</a></li>
<li><a href="../../docs/formats/cifar">Format documentation</a></li>
</ul>
</li>
<li>Cityscapes (<code>segmentation</code>)
<ul>
<li><a href="https://www.cityscapes-dataset.com/dataset-overview/">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/cityscapes_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/cityscapes">Format documentation</a></li>
</ul>
</li>
<li>Common Semantic Segmentation (<code>segmentation</code>)
<ul>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/common_semantic_segmentation_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/common_semantic_segmentation">Format documentation</a></li>
</ul>
</li>
<li>Common Super Resolution
<ul>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/common_super_resolution_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/common_super_resolution">Format documentation</a></li>
</ul>
</li>
<li>CVAT (<code>for images</code>, <code>for video</code> (import-only))
<ul>
<li><a href="https://opencv.github.io/cvat/docs/manual/advanced/xml_format">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/cvat_dataset">Dataset example</a></li>
</ul>
</li>
<li>ICDAR13/15 (<code>word_recognition</code>, <code>text_localization</code>, <code>text_segmentation</code>)
<ul>
<li><a href="https://rrc.cvc.uab.es/?ch=2">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/icdar_dataset">Dataset example</a></li>
</ul>
</li>
<li>ImageNet (<code>classification</code>, <code>detection</code>)
<ul>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/imagenet_dataset">Dataset example</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/imagenet_txt_dataset">Dataset example (txt for classification)</a></li>
<li>Detection format is the same as in PASCAL VOC</li>
<li><a href="../../docs/formats/imagenet">Format documentation</a></li>
</ul>
</li>
<li>KITTI (<code>segmentation</code>, <code>detection</code>)
<ul>
<li><a href="http://www.cvlibs.net/datasets/kitti/index.php">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/kitti_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/kitti">Format documentation</a></li>
</ul>
</li>
<li>KITTI 3D (<code>raw</code>/<code>tracklets</code>/<code>velodyne points</code>)
<ul>
<li><a href="http://www.cvlibs.net/datasets/kitti/raw_data.php">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/kitti_dataset/kitti_raw">Dataset example</a></li>
<li><a href="../../docs/formats/kitti_raw">Format documentation</a></li>
</ul>
</li>
<li>Kinetics 400/600/700
<ul>
<li><a href="https://www.deepmind.com/open-source/kinetics">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/kinetics_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/kinetics">Format documentation</a></li>
</ul>
</li>
<li>LabelMe (<code>labels</code>, <code>boxes</code>, <code>masks</code>)
<ul>
<li><a href="http://labelme.csail.mit.edu/Release3.0">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/labelme_dataset">Dataset example</a></li>
</ul>
</li>
<li>LFW (<code>classification</code>, <code>person re-identification</code>, <code>landmarks</code>)
<ul>
<li><a href="http://vis-www.cs.umass.edu/lfw/">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/lfw_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/lfw">Format documentation</a></li>
</ul>
</li>
<li>Mapillary Vistas (import-only)
<ul>
<li><a href="https://www.mapillary.com/dataset/vistas">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/mapillary_vistas_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/mapillary_vistas">Format documentation</a></li>
</ul>
</li>
<li>Market-1501 (<code>person re-identification</code>)
<ul>
<li><a href="https://www.aitribune.com/dataset/2018051063">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/market1501_dataset">Dataset example</a></li>
</ul>
</li>
<li>MARS (import-only)
<ul>
<li><a href="https://zheng-lab.cecs.anu.edu.au/Project/project_mars.html">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/mars_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/mars">Format documentation</a></li>
</ul>
</li>
<li>MNIST (<code>classification</code>)
<ul>
<li><a href="http://yann.lecun.com/exdb/mnist/">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/mnist_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/mnist">Format documentation</a></li>
</ul>
</li>
<li>MNIST in CSV (<code>classification</code>)
<ul>
<li><a href="https://pjreddie.com/projects/mnist-in-csv/">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/mnist_csv_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/mnist">Format documentation</a></li>
</ul>
</li>
<li>MOT sequences
<ul>
<li><a href="https://arxiv.org/pdf/1906.04567.pdf">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/mot_dataset">Dataset example</a></li>
</ul>
</li>
<li>MOTS (png)
<ul>
<li><a href="https://www.vision.rwth-aachen.de/page/mots">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/mots_dataset">Dataset example</a></li>
</ul>
</li>
<li>MPII Human Pose Dataset (<code>detection</code>, <code>pose estimation</code>) (import-only)
<ul>
<li><a href="http://human-pose.mpi-inf.mpg.de">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/mpii_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/mpii">Format documentation</a></li>
</ul>
</li>
<li>MPII Human Pose Dataset (JSON) (<code>detection</code>, <code>pose estimation</code>) (import-only)
<ul>
<li><a href="http://human-pose.mpi-inf.mpg.de">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/mpii_json_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/mpii_json">Format documentation</a></li>
</ul>
</li>
<li>MS COCO (<code>image_info</code>, <code>instances</code>, <code>person_keypoints</code>, <code>captions</code>, <code>labels</code>,<code>panoptic</code>, <code>stuff</code>)
<ul>
<li><a href="http://cocodataset.org/#format-data">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/coco_dataset">Dataset example</a></li>
<li><code>labels</code> are our extension - like <code>instances</code> with only <code>category_id</code></li>
<li><a href="../../docs/formats/coco">Format documentation</a></li>
</ul>
</li>
<li>NYU Depth Dataset V2 (<code>depth estimation</code>) (import-only)
<ul>
<li><a href="https://cs.nyu.edu/~silberman/datasets/nyu_depth_v2.html">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/nyu_depth_v2_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/nyu_depth_v2">Format documentation</a></li>
</ul>
</li>
<li>Open Images (<code>classification</code>, <code>detection</code>, <code>segmentation</code>)
<ul>
<li><a href="https://storage.googleapis.com/openimages/web/download.html">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/open_images_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/open_images">Format documentation</a></li>
</ul>
</li>
<li>PASCAL VOC (<code>classification</code>, <code>detection</code>, <code>segmentation</code> (class, instances),
<code>action_classification</code>, <code>person_layout</code>)
<ul>
<li><a href="http://host.robots.ox.ac.uk/pascal/VOC/voc2012/htmldoc/index.html">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/voc_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/pascal_voc">Format documentation</a></li>
</ul>
</li>
<li>Supervisely (<code>pointcloud</code>)
<ul>
<li><a href="https://docs.supervise.ly/data-organization/00_ann_format_navi">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/sly_pointcloud_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/sly_pointcloud">Format documentation</a></li>
</ul>
</li>
<li>SYNTHIA (<code>segmentation</code>) (import-only)
<ul>
<li><a href="https://synthia-dataset.net/">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/synthia_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/synthia">Format documentation</a></li>
</ul>
</li>
<li>TF Detection API (<code>bboxes</code>, <code>masks</code>)
<ul>
<li>Format specifications: <a href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/using_your_own_dataset.md">bboxes</a>,
<a href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/instance_segmentation.md">masks</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/tf_detection_api_dataset">Dataset example</a></li>
</ul>
</li>
<li>VGGFace2 (<code>landmarks</code>, <code>bboxes</code>)
<ul>
<li><a href="https://github.com/ox-vgg/vgg_face2">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/vgg_face2_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/vgg_face2">Format documentation</a></li>
</ul>
</li>
<li>VoTT CSV (<code>detection</code>) (import-only)
<ul>
<li><a href="https://github.com/microsoft/VoTT">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/vott_csv_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/vott_csv">Format documentation</a></li>
</ul>
</li>
<li>VoTT JSON (<code>detection</code>) (import-only)
<ul>
<li><a href="https://github.com/microsoft/VoTT">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/vott_json_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/vott_json">Format documentation</a></li>
</ul>
</li>
<li>WIDER Face (<code>bboxes</code>)
<ul>
<li><a href="http://shuoyang1213.me/WIDERFACE/">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/widerface_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/wider_face">Format documentation</a></li>
</ul>
</li>
<li>YOLO (<code>bboxes</code>)
<ul>
<li><a href="https://github.com/AlexeyAB/darknet#how-to-train-pascal-voc-data">Format specification</a></li>
<li><a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/yolo_dataset">Dataset example</a></li>
<li><a href="../../docs/formats/yolo">Format documentation</a></li>
</ul>
</li>
<li>YOLO-Ultralytics (<code>bboxes</code>)
<ul>
<li><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/datasets/coco.yaml">Format specification</a></li>
<li><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/datasets/coco.yaml">Dataset example</a></li>
<li><a href="../../docs/formats/yolo">Format documentation</a></li>
</ul>
</li>
</ul>
<p><a id="annotation-types"></a></p>
<h3 id="supported-annotation-types">Supported annotation types</h3>
<ul>
<li>Labels</li>
<li>Bounding boxes</li>
<li>Polygons</li>
<li>Polylines</li>
<li>(Segmentation) Masks</li>
<li>(Key-)Points</li>
<li>Captions</li>
<li>3D cuboids</li>
<li>Super Resolution Annotation</li>
<li>Depth Annotation</li>
</ul>
<p>Datumaro does not separate datasets by tasks like classification, detection
etc. Instead, datasets can have any annotations. When a dataset is exported
in a specific format, only relevant annotations are exported.</p>
<p><a id="dataset-meta-file"></a></p>
<h3 id="dataset-meta-info-file">Dataset meta info file</h3>
<p>It is possible to use classes that are not original to the format.
To do this, use <code>dataset_meta.json</code>.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
<span style="color:#204a87;font-weight:bold">&#34;label_map&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;0&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;background&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;1&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;car&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;2&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;person&#34;</span><span style="color:#000;font-weight:bold">},</span>
<span style="color:#204a87;font-weight:bold">&#34;segmentation_colors&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">255</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">255</span><span style="color:#000;font-weight:bold">]],</span>
<span style="color:#204a87;font-weight:bold">&#34;background_label&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;0&#34;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><ul>
<li><code>label_map</code> is a dictionary where the class ID is the key and
the class name is the value.</li>
<li><code>segmentation_colors</code> is a list of channel-wise values for each class.
This is only necessary for the segmentation task.</li>
<li><code>background_label</code> is a background label ID in the dataset.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-b6af0aff51a35789907ac069c481b8c7">4.3 - Media formats</h1>
    
	<p>Datumaro supports the following media types:</p>
<ul>
<li>2D RGB(A) images</li>
<li>KITTI Point Clouds</li>
</ul>
<p>To create an unlabelled dataset from an arbitrary directory with images use
<code>image_dir</code> and <code>image_zip</code> formats:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o &lt;project/dir&gt;
datum import -p &lt;project/dir&gt; -f image_dir &lt;directory/path/&gt;
</code></pre></div><p>or, if you work with Datumaro API:</p>
<ul>
<li>
<p>for using with a project:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.project</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Project</span>

<span style="color:#000">project</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Project</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">init</span><span style="color:#000;font-weight:bold">()</span>
<span style="color:#000">project</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_source</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;source1&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;image_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">url</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;directory/path/&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">project</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">working_tree</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">make_dataset</span><span style="color:#000;font-weight:bold">()</span>
</code></pre></div></li>
<li>
<p>for using as a dataset:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;directory/path/&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;image_dir&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div></li>
</ul>
<p>This will search for images in the directory recursively and add
them as dataset entries with names like <code>&lt;subdir1&gt;/&lt;subsubdir1&gt;/&lt;image_name1&gt;</code>.
The list of formats matches the list of supported image formats in OpenCV:</p>
<pre><code>.jpg, .jpeg, .jpe, .jp2, .png, .bmp, .dib, .tif, .tiff, .tga, .webp, .pfm,
.sr, .ras, .exr, .hdr, .pic, .pbm, .pgm, .ppm, .pxm, .pnm
</code></pre><p>Once there is a <code>Dataset</code> instance, its items can be split into subsets,
renamed, filtered, joined with annotations, exported in various formats etc.</p>
<p>To import frames from a video, you can split the video into frames with
the <a href="../../docs/user-manual/command-reference/util#split-video"><code>split_video</code> command</a>
and then use the <code>image_dir</code> format described above. In more complex cases,
consider using <a href="https://ffmpeg.org/">FFmpeg</a> and other tools for
video processing.</p>
<p>Alternatively, you can use the <code>video_frames</code> format directly:</p>
<blockquote>
<p>Note, however, that it can produce different results if the system
environment changes. If you want to obtain reproducible results, consider
splitting the video into frames by any method.</p>
</blockquote>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o &lt;project/dir&gt;
datum import -p &lt;project/dir&gt; -f video_frames &lt;video/path.avi&gt;
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;video.mp4&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;video_frames&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>Datumaro supports the following video formats:</p>
<pre><code>.3gp, .3g2, .asf, .wmv, .avi, .divx, .evo, .f4v, .flv, .mkv, .mk3d,
.mp4, .mpg, .mpeg, .m2p, .ps, .ts, .m2ts, .mxf, .ogg, .ogv, .ogx,
.mov, .qt, .rmvb, .vob, .webm
</code></pre>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-13498051bfc5d3b0beef06b7439a50a6">4.4 - Command reference</h1>
    
	<div class="text-center large-scheme-two">
<pre><code class="language-mermaid" data-lang="mermaid">%%{init { 'theme':'neutral' }}%%
flowchart LR
  d((&quot;#0009; datum #0009;&quot;)):::mainclass
  m(model):::nofillclass
  p(project):::nofillclass
  s(source):::nofillclass

  d===m
    m===m_add[add]:::hideclass
    m===m_info[info]:::hideclass
    m===m_remove[remove]:::hideclass
    m===m_run[run]:::hideclass
  d===p
    p===p_info[info]:::hideclass
    p===p_migrate[migrate]:::hideclass
  d===s
    s===s_add[add]:::hideclass
    s===s_info[info]:::hideclass
    s===s_remove[remove]:::hideclass
  d====_add[add]:::filloneclass
  d====_create[create]:::filloneclass
  d====_describe_downloads[describe-downloads]:::filloneclass
  d====_detect_format[detect-format]:::filloneclass
  d====_download[download]:::filloneclass
  d====_export[export]:::filloneclass
  d====_import[import]:::filloneclass
  d====_info[info]:::filloneclass
  d====_remove[remove]:::filloneclass
  d====_generate[generate]:::filloneclass
  d====_filter[filter]:::filltwoclass
  d====_transform[transform]:::filltwoclass
  d====_diff[diff]:::fillthreeclass
  d====_explain[explain]:::fillthreeclass
  d====_merge[merge]:::fillthreeclass
  d====_patch[patch]:::fillthreeclass
  d====_stats[stats]:::fillthreeclass
  d====_validate[validate]:::fillthreeclass
  d====_checkout[checkout]:::fillfourclass
  d====_commit[commit]:::fillfourclass
  d====_log[log]:::fillfourclass
  d====_status[status]:::fillfourclass

  classDef nofillclass fill-opacity:0;
  classDef hideclass fill-opacity:0,stroke-opacity:0;
  classDef filloneclass fill:#CCCCFF,stroke-opacity:0;
  classDef filltwoclass fill:#FFFF99,stroke-opacity:0;
  classDef fillthreeclass fill:#CCFFFF,stroke-opacity:0;
  classDef fillfourclass fill:#CCFFCC,stroke-opacity:0;
</code></pre></div>
<p>The command line is split into the separate <em>commands</em> and command <em>contexts</em>.
Contexts group multiple commands related to a specific topic, e.g.
project operations, data source operations etc. Almost all the commands
operate on projects, so the <code>project</code> context and commands without a context
are mostly the same. By default, commands look for a project in the current
directory. If the project you&rsquo;re working on is located somewhere else, you
can pass the <code>-p/--project &lt;path&gt;</code> argument to the command.</p>
<blockquote>
<p><strong>Note</strong>: command behavior is subject to change, so this text might be
outdated,
<strong>always check the <code>--help</code> output of the specific command</strong></p>
</blockquote>
<!-- markdownlint-disable-line MD028 -->
<blockquote>
<p><strong>Note</strong>: command parameters must be passed prior to the positional arguments.</p>
</blockquote>
<p>Datumaro functionality is available with the <code>datum</code> command.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--version<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--loglevel LOGLEVEL<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>command<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#204a87">command</span> args<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>--loglevel</code> (string) - Logging level, one of
<code>debug</code>, <code>info</code>, <code>warning</code>, <code>error</code>, <code>critical</code> (default: <code>info</code>)</li>
<li><code>--version</code> - Print the version number and exit.</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-70c651cad336e515180a9b8eed13f292">4.4.1 - Checkout</h1>
    
	<p>This command allows to restore a specific project revision in the project
tree or to restore separate revisions of sources. A revision can be a commit
hash, branch, tag, or any <a href="https://git-scm.com/book/en/v2/Git-Tools-Revision-Selection">relative reference in the Git format</a>.</p>
<p>This command has multiple forms:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">1<span style="color:#ce5c00;font-weight:bold">)</span> datum checkout &lt;revision&gt;
2<span style="color:#ce5c00;font-weight:bold">)</span> datum checkout <span style="color:#ce5c00;font-weight:bold">[</span>--<span style="color:#ce5c00;font-weight:bold">]</span> &lt;source1&gt; ...
3<span style="color:#ce5c00;font-weight:bold">)</span> datum checkout &lt;revision&gt; <span style="color:#ce5c00;font-weight:bold">[</span>--<span style="color:#ce5c00;font-weight:bold">]</span> &lt;source1&gt; &lt;source2&gt; ...
</code></pre></div><p>1 - Restores a revision and all the corresponding sources in the
working directory. If there are conflicts between modified files in the
working directory and the target revision, an error is raised, unless
<code>--force</code> is used.</p>
<p>2, 3 - Restores only selected sources from the specified revision.
The current revision is used, when not set.</p>
<p>&ldquo;&ndash;&rdquo; can be used to separate source names and revisions:</p>
<ul>
<li><code>datum checkout name</code> - will look for revision &ldquo;name&rdquo;</li>
<li><code>datum checkout -- name</code> - will look for source &ldquo;name&rdquo; in the current
revision</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum checkout <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-f<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>rev<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>sources <span style="color:#ce5c00;font-weight:bold">[</span>sources ...<span style="color:#ce5c00;font-weight:bold">]]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>--force</code> - Allows to overwrite unsaved changes in case of conflicts</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Examples:</p>
<ul>
<li>
<p>Restore the previous revision:
<code>datum checkout HEAD~1</code>
<br></p>
</li>
<li>
<p>Restore the saved version of a source in the working tree
<code>datum checkout -- source-1</code>
<br></p>
</li>
<li>
<p>Restore a previous version of a source
<code>datum checkout 33fbfbe my-source</code>
<br></p>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6c14c8898a52d18d0040b216c7faf6a6">4.4.2 - Commit</h1>
    
	<p>This command allows to fix the current state of a project and
create a new revision from the working tree.</p>
<p>By default, this command checks sources in the working tree for
changes. If there are unknown changes found, an error will be raised,
unless <code>--allow-foreign</code> is used. If such changes are committed,
the source will only be available for reproduction from the project
cache, because Datumaro will not know how to repeat them.</p>
<p>The command will add the sources into the project cache. If you only
need to record revision metadata, you can use the <code>--no-cache</code> parameter.
This can be useful if you want to save disk space and/or have a backup copy
of datasets used in the project.</p>
<p>If there are no changes found, the command will stop. To allow empty
commits, use <code>--allow-empty</code>.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum commit <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -m MESSAGE <span style="color:#ce5c00;font-weight:bold">[</span>--allow-empty<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--allow-foreign<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>--no-cache<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>--allow-empty</code> - Allow commits with no changes</li>
<li><code>--allow-foreign</code> - Allow commits with changes made not by Datumaro</li>
<li><code>--no-cache</code> - Don&rsquo;t put committed datasets into cache, save only metadata</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f coco &lt;path/to/coco/&gt;
datum commit -m <span style="color:#4e9a06">&#34;Added COCO&#34;</span>
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a343cd09a10c892413f1c9e19af35d61">4.4.3 - Convert datasets</h1>
    
	<p>This command allows to convert a dataset from one format to another.
The command is a usability alias for <a href="../create"><code>create</code></a>,
<a href="../sources/#sources-add"><code>add</code></a> and <a href="../export"><code>export</code></a> and just provides
a simpler way to obtain the same results in simple cases. A list of supported
formats can be found in the <code>--help</code> output of this command.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-i SOURCE<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-if INPUT_FORMAT<span style="color:#ce5c00;font-weight:bold">]</span> -f OUTPUT_FORMAT
  <span style="color:#ce5c00;font-weight:bold">[</span>-o DST_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-e FILTER<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--filter-mode FILTER_MODE<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-- EXTRA_EXPORT_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>-i, --input-path</code> (string) - Input dataset path. The current directory is
used by default.</li>
<li><code>-if, --input-format</code> (string) - Input dataset format. Will try to detect,
if not specified.</li>
<li><code>-f, --output-format</code> (string) - Output format</li>
<li><code>-o, --output-dir</code> (string) - Output directory. By default, a subdirectory
in the current directory is used.</li>
<li><code>--overwrite</code> - Allows overwriting existing files in the output directory,
when it is not empty.</li>
<li><code>-e, --filter</code> (string) - XML XPath filter expression for dataset items</li>
<li><code>--filter-mode</code> (string) - The filtering mode. Default is the <code>i</code> mode.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
<li><code>-- &lt;extra export args&gt;</code> - Additional arguments for the format writer
(use <code>-- -h</code> for help). Must be specified after the main command arguments.</li>
</ul>
<p>Example: convert a VOC-like dataset to a COCO-like one:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert --input-format voc --input-path &lt;path/to/voc/&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>              --output-format coco <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>              -- --save-images
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-4cdc48f6e2e41c6dd35af61e5748ac77">4.4.4 - Create project</h1>
    
	<p>The command creates an empty project. A project is required for the most of
Datumaro functionality.</p>
<p>By default, the project is created in the current directory. To specify
another output directory, pass the <code>-o/--output-dir</code> parameter. If output
already directory contains a Datumaro project, an error is raised, unless
<code>--overwrite</code> is used.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-o DST_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>-o, --output-dir</code> (string) - Allows to specify an output directory.
The current directory is used by default.</li>
<li><code>--overwrite</code> - Allows to overwrite existing project files in the output
directory. Any other files are not touched.</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Examples:</p>
<p>Example: create an empty project in the <code>my_dataset</code> directory</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o my_dataset/
</code></pre></div><p>Example: create a new empty project in the current directory, remove the
existing one</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
...
datum create --overwrite
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-93c9f45615f89ceac9312b63ffcf8b65">4.4.5 - Describe downloadable datasets</h1>
    
	<p>This command reports reports various information about datasets that can be
downloaded with the <code>download</code> command. The information is reported either as
human-readable text (the default) or as a JSON object. The format can be selected
with the <code>--report-format</code> option.</p>
<p>When the JSON output format is selected, the output document has the following schema:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;&lt;dataset name&gt;&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">&#34;default_output_format&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&lt;Datumaro format name&gt;&#34;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&lt;human-readable description&gt;&#34;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;download_size&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#a40000">&lt;total</span> <span style="color:#a40000">size</span> <span style="color:#a40000">of</span> <span style="color:#a40000">the</span> <span style="color:#a40000">downloaded</span> <span style="color:#a40000">files</span> <span style="color:#a40000">in</span> <span style="color:#a40000">bytes&gt;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;home_url&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&lt;URL of a web page describing the dataset&gt;&#34;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;human_name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&lt;human-readable dataset name&gt;&#34;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;num_classes&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#a40000">&lt;number</span> <span style="color:#a40000">of</span> <span style="color:#a40000">classes</span> <span style="color:#a40000">in</span> <span style="color:#a40000">the</span> <span style="color:#a40000">dataset&gt;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;subsets&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;&lt;subset name&gt;&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#204a87;font-weight:bold">&#34;num_items&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#a40000">&lt;number</span> <span style="color:#a40000">of</span> <span style="color:#a40000">items</span> <span style="color:#a40000">in</span> <span style="color:#a40000">the</span> <span style="color:#a40000">subset&gt;</span>
            <span style="color:#000;font-weight:bold">},</span>
            <span style="color:#a40000">...</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#204a87;font-weight:bold">&#34;version&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&lt;version number&gt;&#34;</span>
    <span style="color:#000;font-weight:bold">},</span>
    <span style="color:#a40000">...</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><code>home_url</code> may be <code>null</code> if there is no suitable web page for the dataset.</p>
<p><code>num_classes</code> may be <code>null</code> if the dataset does not involve classification.</p>
<p><code>version</code> currently contains the version number supplied by TFDS.
In future versions of Datumaro, datasets might come from other sources;
the way version numbers will be set for those is to be determined.</p>
<p>New object members may be added in future versions of Datumaro.</p>
<p>Usage:</p>
<pre><code>datum describe-downloads [-h] [--report-format {text,json}]
                         [--report-file REPORT_FILE]
</code></pre><p>Parameters:</p>
<ul>
<li><code>-h</code>, <code>--help</code> - Print the help message and exit.</li>
<li><code>--report-format</code> (<code>text</code> or <code>json</code>) - Format in which to report the information.
By default, <code>text</code> is used.</li>
<li><code>--report-file</code> (string) - File to which to write the report. By default,
the report is written to the standard output stream.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-3edc3b754a785c8818028837f5d7e754">4.4.6 - Detect dataset format</h1>
    
	<p>This command attempts to detect the format of a dataset in a directory.
Currently, only local directories are supported.</p>
<p>The detection result may be one of:</p>
<ul>
<li>a single format being detected;</li>
<li>no formats being detected (if the dataset doesn&rsquo;t match any known format);</li>
<li>multiple formats being detected (if the dataset is ambiguous).</li>
</ul>
<p>The command outputs this result in a human-readable form and
optionally as a machine-readable JSON report (see <code>--json-report</code>).</p>
<p>The format of the machine-readable report is as follows:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;detected_formats&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
        <span style="color:#4e9a06">&#34;detected-format-name-1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;detected-format-name-2&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#a40000">...</span>
    <span style="color:#000;font-weight:bold">],</span>
    <span style="color:#204a87;font-weight:bold">&#34;rejected_formats&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">&#34;rejected-format-name-1&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;reason&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#a40000">&lt;reason-code&gt;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;message&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;line 1\nline 2\n...\nline N&#34;</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#204a87;font-weight:bold">&#34;rejected-format-name-2&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#a40000">...</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#a40000">...</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>The <code>&lt;reason-code&gt;</code> can be one of:</p>
<ul>
<li>
<p><code>&quot;detection_unsupported&quot;</code>: the corresponding format does not support
detection.</p>
</li>
<li>
<p><code>&quot;insufficient_confidence&quot;</code>: the dataset matched the corresponding format,
but it matched at least one other format better.</p>
</li>
<li>
<p><code>&quot;unmet_requirements&quot;</code>: the dataset didn&rsquo;t meet at least one requirement
of the corresponding format.</p>
</li>
</ul>
<p>Other reason codes may be defined in the future.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum detect-format <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--show-rejections<span style="color:#ce5c00;font-weight:bold">]</span>
                    <span style="color:#ce5c00;font-weight:bold">[</span>--json-report JSON_REPORT<span style="color:#ce5c00;font-weight:bold">]</span>
                    url
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;url&gt;</code> - Path to the dataset to analyse.</li>
<li><code>-h</code>, <code>--help</code> - Print the help message and exit.</li>
<li><code>-p, --project</code> (string) - Directory of the project to use as the context
(default: current directory). The project might contain local plugins with
custom formats, which will be used for detection.</li>
<li><code>--show-rejections</code> - Describe why each supported format that wasn&rsquo;t
detected was rejected. This only affects the human-readable output; the
machine-readable report always includes rejection information.</li>
<li><code>--json-report</code> (string) - Path to which to save a JSON report describing
detected and rejected formats. By default, no report is saved.</li>
</ul>
<p>Example: detect the format of a dataset in a given directory,
showing rejection information:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum detect-format --show-rejections path/to/dataset
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-cf615af9fbd176c3c8963db17cdccfec">4.4.7 - Compare datasets</h1>
    
	<p>The command compares two datasets and saves the results in the
specified directory. The current project is considered to be
&ldquo;ground truth&rdquo;.</p>
<p>Datasets can be compared using different methods:</p>
<ul>
<li><code>equality</code> - Annotations are compared to be equal</li>
<li><code>distance</code> - A distance metric is used</li>
</ul>
<p>This command has multiple forms:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">1<span style="color:#ce5c00;font-weight:bold">)</span> datum diff &lt;revpath&gt;
2<span style="color:#ce5c00;font-weight:bold">)</span> datum diff &lt;revpath&gt; &lt;revpath&gt;
</code></pre></div><p>1 - Compares the current project&rsquo;s main target (<code>project</code>)
in the working tree with the specified dataset.</p>
<p>2 - Compares two specified datasets.</p>
<p>&lt;revpath&gt; - <a href="../../docs/user-manual/how_to_use_datumaro/#revpath">a dataset path or a revision path</a>.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum diff <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-o DST_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-m METHOD<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>--iou-thresh IOU_THRESH<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-f FORMAT<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-iia IGNORE_ITEM_ATTR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-ia IGNORE_ATTR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-if IGNORE_FIELD<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>--match-images<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--all<span style="color:#ce5c00;font-weight:bold">]</span>
  first_target <span style="color:#ce5c00;font-weight:bold">[</span>second_target<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li>
<p><code>&lt;target&gt;</code> (string) - Target <a href="../../docs/user-manual/how_to_use_datumaro/#revpath">dataset revpaths</a></p>
</li>
<li>
<p><code>-m, --method</code> (string) - Comparison method.</p>
</li>
<li>
<p><code>-o, --output-dir</code> (string) - Output directory. By default, a new directory
is created in the current directory.</p>
</li>
<li>
<p><code>--overwrite</code> - Allows to overwrite existing files in the output directory,
when it is specified and is not empty.</p>
</li>
<li>
<p><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</p>
</li>
<li>
<p><code>-h, --help</code> - Print the help message and exit.</p>
</li>
<li>
<p>Distance comparison options:</p>
<ul>
<li><code>--iou-thresh</code> (number) - The IoU threshold for spatial annotations
(default is 0.5).</li>
<li><code>-f, --format</code> (string) - Output format, one of <code>simple</code>
(text files and images) and <code>tensorboard</code> (a TB log directory)</li>
</ul>
</li>
<li>
<p>Equality comparison options:</p>
<ul>
<li><code>-iia, --ignore-item-attr</code> (string) - Ignore an item attribute (repeatable)</li>
<li><code>-ia, --ignore-attr</code> (string) - Ignore an annotation attribute (repeatable)</li>
<li><code>-if, --ignore-field</code> (string) - Ignore an annotation field (repeatable)
Default is <code>id</code> and <code>group</code></li>
<li><code>--match-images</code> - Match dataset items by image pixels instead of ids</li>
<li><code>--all</code> - Include matches in the output. By default, only differences are
printed.</li>
</ul>
</li>
</ul>
<!-- markdownlint-disable-line MD028 -->Examples:
<ul>
<li>
<p>Compare two projects by distance, match boxes if IoU &gt; 0.7,
save results to TensorBoard:
<code>datum diff other/project -o diff/ -f tensorboard --iou-thresh 0.7</code></p>
</li>
<li>
<p>Compare two projects for equality, exclude annotation groups
and the <code>is_crowd</code> attribute from comparison:
<code>datum diff other/project/ -if group -ia is_crowd</code></p>
</li>
<li>
<p>Compare two datasets, specify formats:
<code>datum diff path/to/dataset1:voc path/to/dataset2:coco</code></p>
</li>
<li>
<p>Compare the current working tree and a dataset:
<code>datum diff path/to/dataset2:coco</code></p>
</li>
<li>
<p>Compare a source from a previous revision and a dataset:
<code>datum diff HEAD~2:source-2 path/to/dataset2:yolo</code></p>
</li>
<li>
<p>Compare a dataset with model inference</p>
</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import &lt;...&gt;
datum model add mymodel &lt;...&gt;
datum transform &lt;...&gt; -o inference
datum diff inference -o diff
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-77963f24abb4e1f7e8cb372f0cf73ad7">4.4.8 - Download datasets</h1>
    
	<p>This command downloads a publicly available dataset and saves it to a local
directory.
In terms of syntax, this command is similar to <a href="../convert"><code>convert</code></a>,
but instead of taking a local directory as the source, it takes a dataset ID.
A list of supported datasets and output formats can be found in the <code>--help</code>
output of this command.</p>
<p>Currently, the only source of datasets is the TensorFlow Datasets library.
Therefore, to use this command you must install TensorFlow &amp; TFDS, which you can
do as follows:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">pip install datumaro<span style="color:#ce5c00;font-weight:bold">[</span>tf,tfds<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>To use a proxy for downloading, configure it with the conventional
<a href="https://everything.curl.dev/usingcurl/proxies/env">curl environment variables</a>.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum download <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -i DATASET_ID <span style="color:#ce5c00;font-weight:bold">[</span>-f OUTPUT_FORMAT<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-o DST_DIR<span style="color:#ce5c00;font-weight:bold">]</span>
               <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-s SUBSET<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-- EXTRA_EXPORT_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>-h</code>, <code>--help</code> - Print the help message and exit.</li>
<li><code>-i</code>, <code>--dataset-id</code> (string) - ID of the dataset to download.</li>
<li><code>-f</code>, <code>--output-format</code> (string) - Output format. By default, the format
of the original dataset is used.</li>
<li><code>-o, --output-dir</code> (string) - Output directory. By default, a subdirectory
in the current directory is used.</li>
<li><code>--overwrite</code> - Allows overwriting existing files in the output directory,
when it is not empty.</li>
<li><code>--subset</code> (string) - Which subset of the dataset to save. By default, all
subsets are saved. Note that due to limitations of TFDS, all subsets are
downloaded even if this option is specified.</li>
<li><code>-- &lt;extra export args&gt;</code> - Additional arguments for the format writer
(use <code>-- -h</code> for help). Must be specified after the main command arguments.</li>
</ul>
<p>Example: download the MNIST dataset, saving it in the ImageNet text format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum download -i tfds:mnist -f imagenet_txt -- --save-images
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-5a841ebe671810e701d94cfd348da645">4.4.9 - Run model inference explanation (explain)</h1>
    
	<p>Runs an explainable AI algorithm for a model.</p>
<p>This tool is supposed to help an AI developer to debug a model and a dataset.
Basically, it executes model inference and tries to find relation between
inputs and outputs of the trained model, i.e. determine decision boundaries
and belief intervals for the classifier.</p>
<p>Currently, the only available algorithm is RISE (<a href="https://arxiv.org/pdf/1806.07421.pdf">article</a>),
which runs model a single time and then re-runs a model multiple times on
each image to produce a heatmap of activations for each output of the
first inference. Each time a part of the input image is masked. As a result,
we obtain a number heatmaps, which show, how specific image pixels affected
the inference result. This algorithm doesn&rsquo;t require any special information
about the model, but it requires the model to return all the outputs and
confidences. The original algorithm supports only classification scenario,
but Datumaro extends it for detection models.</p>
<p>The following use cases available:</p>
<ul>
<li>RISE for classification</li>
<li>RISE for object detection</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum explain <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -m MODEL <span style="color:#ce5c00;font-weight:bold">[</span>-o SAVE_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>target<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">{</span>rise<span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">[</span>RISE_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li>
<p><code>&lt;target&gt;</code> (string) - Target
<a href="../../docs/user-manual/how_to_use_datumaro/#revpath">dataset revpath</a>.By default,
uses the whole current project. An image path can be specified instead.
&lt;image path&gt; - a path to the file.
&lt;revpath&gt; - <a href="../../docs/user-manual/how_to_use_datumaro/#revpath">a dataset path or a revision path</a>.</p>
</li>
<li>
<p><code>&lt;method&gt;</code> (string) - The algorithm to use. Currently, only <code>rise</code>
is supported.</p>
</li>
<li>
<p><code>-m, --model</code> (string) - The model to use for inference</p>
</li>
<li>
<p><code>-o, --output-dir</code> (string) - Directory to save results to
(default: display only)</p>
</li>
<li>
<p><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</p>
</li>
<li>
<p><code>-h, --help</code> - Print the help message and exit.</p>
</li>
<li>
<p>RISE options:</p>
<ul>
<li><code>-s, --max-samples</code> (number) - Number of algorithm model runs per image
(default: mask size ^ 2).</li>
<li><code>--mw, --mask-width</code> (number) - Mask width in pixels (default: 7)</li>
<li><code>--mh, --mask-height</code> (number) - Mask height in pixels (default: 7)</li>
<li><code>--prob</code> (number) - Mask pixel inclusion probability, controls
mask density (default: 0.5)</li>
<li><code>--iou, --iou-thresh</code> (number) - IoU match threshold for detections
(default: 0.9)</li>
<li><code>--nms, --nms-iou-thresh</code> (number) - IoU match threshold for detections
for non-maxima suppression (default: no NMS)</li>
<li><code>--conf, --det-conf-thresh</code> (number) - Confidence threshold for
detections (default: include all)</li>
<li><code>-b, --batch-size</code> (number) - Batch size for inference (default: 1)</li>
<li><code>--display</code> - Visualize results during computations</li>
</ul>
</li>
</ul>
<p>Examples:</p>
<ul>
<li>
<p>Run RISE on an image, display results:
<code>datum explain path/to/image.jpg -m mymodel rise --max-samples 50</code></p>
</li>
<li>
<p>Run RISE on a source revision:
<code>datum explain HEAD~1:source-1 -m model rise</code></p>
</li>
<li>
<p>Run inference explanation on a single image with online visualization</p>
</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create &lt;...&gt;
datum model add mymodel &lt;...&gt;
datum explain -t image.png -m mymodel <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    rise --max-samples <span style="color:#0000cf;font-weight:bold">1000</span> --display
</code></pre></div><blockquote>
<p>Note: this algorithm requires the model to return
<em>all</em> (or a <em>reasonable</em> amount) the outputs and confidences unfiltered,
i.e. all the <code>Label</code> annotations for classification models and
all the <code>Bbox</code>es for detection models.
You can find examples of the expected model outputs in <a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_RISE.py"><code>tests/test_RISE.py</code></a></p>
</blockquote>
<p>For OpenVINO models the output processing script would look like this:</p>
<p>Classification scenario:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.util.annotation_util</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">softmax</span>

<span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">process_outputs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">inputs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">outputs</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#8f5902;font-style:italic"># inputs = model input, array or images, shape = (N, C, H, W)</span>
    <span style="color:#8f5902;font-style:italic"># outputs = model output, logits, shape = (N, n_classes)</span>
    <span style="color:#8f5902;font-style:italic"># results = conversion result, [ [ Annotation, ... ], ... ]</span>
    <span style="color:#000">results</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[]</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">output</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">outputs</span><span style="color:#000;font-weight:bold">:</span>
        <span style="color:#000">confs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">softmax</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">output</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">])</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">label</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">conf</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#204a87">enumerate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">confs</span><span style="color:#000;font-weight:bold">):</span>
            <span style="color:#000">results</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Label</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">label</span><span style="color:#000;font-weight:bold">)),</span> <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;score&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87">float</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">conf</span><span style="color:#000;font-weight:bold">)})</span>

    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">results</span>
</code></pre></div><p>Object Detection scenario:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#8f5902;font-style:italic"># return a significant number of output boxes to make multiple runs</span>
<span style="color:#8f5902;font-style:italic"># statistically correct and meaningful</span>
<span style="color:#000">max_det</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1000</span>

<span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">process_outputs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">inputs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">outputs</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#8f5902;font-style:italic"># inputs = model input, array or images, shape = (N, C, H, W)</span>
    <span style="color:#8f5902;font-style:italic"># outputs = model output, shape = (N, 1, K, 7)</span>
    <span style="color:#8f5902;font-style:italic"># results = conversion result, [ [ Annotation, ... ], ... ]</span>
    <span style="color:#000">results</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[]</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#204a87">input</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">output</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#204a87">zip</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">inputs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">outputs</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#000">input_height</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input_width</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">input</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">shape</span><span style="color:#000;font-weight:bold">[:</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">]</span>
        <span style="color:#000">detections</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">output</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]</span>
        <span style="color:#000">image_results</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[]</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">det</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">detections</span><span style="color:#000;font-weight:bold">:</span>
            <span style="color:#000">label</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">])</span>
            <span style="color:#000">conf</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">float</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">])</span>
            <span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">max</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">input_width</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">max</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">input_height</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#000">w</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">min</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">input_width</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">input_width</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#000">h</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">min</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">6</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">input_height</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">input_height</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#000">image_results</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Bbox</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">w</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">h</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">label</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;score&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">conf</span><span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">))</span>

            <span style="color:#000">results</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">image_results</span><span style="color:#000;font-weight:bold">[:</span><span style="color:#000">max_det</span><span style="color:#000;font-weight:bold">])</span>

    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">results</span>
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-bf2416754f5a95167671095e620607d7">4.4.10 - Export Datasets</h1>
    
	<p>This command exports a project or a source as a dataset in some format.</p>
<p>Check <a href="../../docs/user-manual/supported_formats">supported formats</a> for more info
about format specifications, supported options and other details.
The list of formats can be extended by custom plugins, check
<a href="../../docs/user-manual/extending">extending tips</a> for information on this topic.</p>
<p>Available formats are listed in the command help output.</p>
<p>Dataset format writers support additional export options. To pass
such options, use the <code>--</code> separator after the main command arguments.
The usage information can be printed with <code>datum import -f &lt;format&gt; -- --help</code>.</p>
<p>Common export options:</p>
<ul>
<li>Most formats (where applicable) support the <code>--save-images</code> option, which
allows to export dataset images along with annotations. The option is
disabled be default.</li>
<li>If <code>--save-images</code> is used, the <code>image-ext</code> option can be passed to
specify the output image file extension (<code>.jpg</code>, <code>.png</code> etc.). By default,
tries to Datumaro keep the original image extension. This option
allows to convert all the images from one format into another.</li>
</ul>
<p>This command allows to use the <code>-f/--filter</code> parameter to select dataset
elements needed for exporting. Read the <a href="../../docs/user-manual/command-reference/filter/"><code>filter</code></a>
command description for more info about this functionality.</p>
<p>The command can only be applied to a project build target, a stage
or the combined <code>project</code> target, in which case all the targets will
be affected.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum <span style="color:#204a87">export</span> <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-e FILTER<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--filter-mode FILTER_MODE<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-o DST_DIR<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> -f FORMAT <span style="color:#ce5c00;font-weight:bold">[</span>target<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-- EXTRA_FORMAT_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;target&gt;</code> (string) - A project build target to be exported.
By default, all project targets are affected.</li>
<li><code>-f, --format</code> (string) - Output format.</li>
<li><code>-e, --filter</code> (string) - XML XPath filter expression for dataset items</li>
<li><code>--filter-mode</code> (string) - The filtering mode. Default is the <code>i</code> mode.</li>
<li><code>-o, --output-dir</code> (string) - Output directory. By default, a subdirectory
in the current directory is used.</li>
<li><code>--overwrite</code> - Allows overwriting existing files in the output directory,
when it is not empty.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
<li><code>-- &lt;extra format args&gt;</code> - Additional arguments for the format writer
(use <code>-- -h</code> for help). Must be specified after the main command arguments.</li>
</ul>
<p>Example: save a project as a VOC-like dataset, include images, convert
images to <code>PNG</code> from other formats.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum <span style="color:#204a87">export</span> <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -p test_project <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -o test_project-export <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -f voc <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -- --save-images --image-ext<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;.png&#39;</span>
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-fb79096cff317cd3a11940138d12144a">4.4.11 - Filter datasets</h1>
    
	<p>This command allows to extract a sub-dataset from a dataset. The new dataset
includes only items satisfying some condition. The XML <a href="https://devhints.io/xpath">XPath</a>
is used as a query format.</p>
<p>The command can be applied to a dataset or a project build target,
a stage or the combined <code>project</code> target, in which case all the project
targets will be affected. A build tree stage will be recorded
if <code>--stage</code> is enabled, and the resulting dataset(-s) will be
saved if <code>--apply</code> is enabled.</p>
<p>By default, datasets are updated in-place. The <code>-o/--output-dir</code>
option can be used to specify another output directory. When
updating in-place, use the <code>--overwrite</code> parameter (in-place
updates fail by default to prevent data loss), unless a project
target is modified.</p>
<p>The current project (<code>-p/--project</code>) is also used as a context for
plugins, so it can be useful for dataset paths having custom formats.
When not specified, the current project&rsquo;s working tree is used.</p>
<p>There are several filtering modes available (the <code>-m/--mode</code> parameter).
Supported modes:</p>
<ul>
<li><code>i</code>, <code>items</code></li>
<li><code>a</code>, <code>annotations</code></li>
<li><code>i+a</code>, <code>a+i</code>, <code>items+annotations</code>, <code>annotations+items</code></li>
</ul>
<p>When filtering annotations, use the <code>items+annotations</code>
mode to point that annotation-less dataset items should be
removed, otherwise they will be kept in the resulting dataset.
To select an annotation, write an XPath that returns <code>annotation</code>
elements (see examples).</p>
<p>Item representations can be printed with the <code>--dry-run</code> parameter:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#204a87;font-weight:bold">&lt;item&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;id&gt;</span>290768<span style="color:#204a87;font-weight:bold">&lt;/id&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;subset&gt;</span>minival2014<span style="color:#204a87;font-weight:bold">&lt;/subset&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;image&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;width&gt;</span>612<span style="color:#204a87;font-weight:bold">&lt;/width&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;height&gt;</span>612<span style="color:#204a87;font-weight:bold">&lt;/height&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;depth&gt;</span>3<span style="color:#204a87;font-weight:bold">&lt;/depth&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;/image&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;annotation&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;id&gt;</span>80154<span style="color:#204a87;font-weight:bold">&lt;/id&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;type&gt;</span>bbox<span style="color:#204a87;font-weight:bold">&lt;/type&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;label_id&gt;</span>39<span style="color:#204a87;font-weight:bold">&lt;/label_id&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;x&gt;</span>264.59<span style="color:#204a87;font-weight:bold">&lt;/x&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;y&gt;</span>150.25<span style="color:#204a87;font-weight:bold">&lt;/y&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;w&gt;</span>11.19<span style="color:#204a87;font-weight:bold">&lt;/w&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;h&gt;</span>42.31<span style="color:#204a87;font-weight:bold">&lt;/h&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;area&gt;</span>473.87<span style="color:#204a87;font-weight:bold">&lt;/area&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;/annotation&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;annotation&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;id&gt;</span>669839<span style="color:#204a87;font-weight:bold">&lt;/id&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;type&gt;</span>bbox<span style="color:#204a87;font-weight:bold">&lt;/type&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;label_id&gt;</span>41<span style="color:#204a87;font-weight:bold">&lt;/label_id&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;x&gt;</span>163.58<span style="color:#204a87;font-weight:bold">&lt;/x&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;y&gt;</span>191.75<span style="color:#204a87;font-weight:bold">&lt;/y&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;w&gt;</span>76.98<span style="color:#204a87;font-weight:bold">&lt;/w&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;h&gt;</span>73.63<span style="color:#204a87;font-weight:bold">&lt;/h&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;area&gt;</span>5668.77<span style="color:#204a87;font-weight:bold">&lt;/area&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;/annotation&gt;</span>
  ...
<span style="color:#204a87;font-weight:bold">&lt;/item&gt;</span>
</code></pre></div><p>The command can only be applied to a project build target, a stage or the
combined <code>project</code> target, in which case all the targets will be affected.
A build tree stage will be added if <code>--stage</code> is enabled, and the resulting
dataset(-s) will be saved if <code>--apply</code> is enabled.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum filter <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-e FILTER<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-m MODE<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--dry-run<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--stage STAGE<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>--apply APPLY<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-o DST_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>target<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;target&gt;</code> (string) - Target
<a href="../../docs/user-manual/how_to_use_datumaro/#revpath">dataset revpath</a>.
By default, filters all targets of the current project.</li>
<li><code>-e, --filter</code> (string) - XML XPath filter expression for dataset items</li>
<li><code>-m, --mode</code> (string) - The filtering mode. Default is the <code>i</code> mode.</li>
<li><code>--dry-run</code> - Print XML representations of the filtered dataset and exit.</li>
<li><code>--stage</code> (bool) - Include this action as a project build step.
If true, this operation will be saved in the project
build tree, allowing to reproduce the resulting dataset later.
Applicable only to main project targets (i.e. data sources
and the <code>project</code> target, but not intermediate stages). Enabled by default.</li>
<li><code>--apply</code> (bool) - Run this command immediately. If disabled, only the
build tree stage will be written. Enabled by default.</li>
<li><code>-o, --output-dir</code> (string) - Output directory. Can be omitted for
main project targets (i.e. data sources and the <code>project</code> target, but not
intermediate stages) and dataset targets. If not specified, the results
will be saved inplace.</li>
<li><code>--overwrite</code> - Allows to overwrite existing files in the output directory,
when it is specified and is not empty.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Example: extract a dataset with images with <code>width</code> &lt; <code>height</code></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum filter <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -p test_project <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -e <span style="color:#4e9a06">&#39;/item[image/width &lt; image/height]&#39;</span>
</code></pre></div><p>Example: extract a dataset with images of the <code>train</code> subset</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum filter <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -p test_project <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -e <span style="color:#4e9a06">&#39;/item[subset=&#34;train&#34;]&#39;</span>
</code></pre></div><p>Example: extract a dataset with only large annotations of the <code>cat</code> class and
any non-<code>persons</code></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum filter <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -p test_project <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --mode annotations <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -e <span style="color:#4e9a06">&#39;/item/annotation[(label=&#34;cat&#34; and area &gt; 99.5) or label!=&#34;person&#34;]&#39;</span>
</code></pre></div><p>Example: extract a dataset with non-occluded annotations, remove empty images.
Use data only from the &ldquo;s1&rdquo; source of the project.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format voc -i &lt;path/to/dataset1/&gt; --name s1
datum import --format voc -i &lt;path/to/dataset2/&gt; --name s2
datum filter s1 <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -m i+a -e <span style="color:#4e9a06">&#39;/item/annotation[occluded=&#34;False&#34;]&#39;</span>
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0c1db009ad311413c7036db1bd602bf0">4.4.12 - Generate Datasets</h1>
    
	<p>Creates a synthetic dataset with elements of the specified type and shape,
and saves it in the provided directory.</p>
<p>Currently, can only generate fractal images, useful for network compression.
To create 3-channel images, you should provide the number of images, height and width.
The images are colorized with a model, which will be downloaded automatically.
Uses the algorithm from the article: <a href="https://arxiv.org/abs/2103.13023">https://arxiv.org/abs/2103.13023</a></p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum generate <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -o OUTPUT_DIR -k COUNT --shape SHAPE <span style="color:#ce5c00;font-weight:bold">[</span>SHAPE ...<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-t <span style="color:#ce5c00;font-weight:bold">{</span>image<span style="color:#ce5c00;font-weight:bold">}]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--model-dir MODEL_PATH<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>-o, --output-dir</code> (string) - Output directory</li>
<li><code>-k, --count</code> (integer) - Number of images to be generated</li>
<li><code>--shape</code> (integer, repeatable) - Dimensions of data to be generated (H, W)</li>
<li><code>-t, --type</code> (one of: <code>image</code>) - Specify the type of data to generate (default: <code>image</code>)</li>
<li><code>--model-dir</code> (path) - Path to load the colorization model from.
If no model is found, the model will be downloaded (default: current dir)</li>
<li><code>--overwrite</code> - Allows overwriting existing files in the output directory,
when it is not empty.</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Examples:
Generate 300 3-channel fractal images with H=224, W=256 and store in the <code>images/</code> dir:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum generate -o images/ --count <span style="color:#0000cf;font-weight:bold">300</span> --shape <span style="color:#0000cf;font-weight:bold">224</span> <span style="color:#0000cf;font-weight:bold">256</span>
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-08529e9683af8c1a879605b62306ea7a">4.4.13 - Print dataset info</h1>
    
	<p>This command outputs high level dataset information such as sample count,
categories and subsets.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum info <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--all<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>revpath<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;target&gt;</code> (string) - Target <a href="../../docs/user-manual/how_to_use_datumaro/#revpath">dataset revpath</a>.
By default, prints info about the joined <code>project</code> dataset.</li>
<li><code>--all</code> - Print all the information: do not fold long lists of labels etc.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Examples:</p>
<ul>
<li>
<p>Print info about a project dataset:
<code>datum info -p test_project/</code></p>
</li>
<li>
<p>Print info about a COCO-like dataset:
<code>datum info path/to/dataset:coco</code></p>
</li>
</ul>
<p>Sample output:</p>
<pre><code>length: 5000
categories: label
  label:
    count: 80
    labels: person, bicycle, car, motorcycle (and 76 more)
subsets: minival2014
  'minival2014':
    length: 5000
    categories: label
      label:
        count: 80
        labels: person, bicycle, car, motorcycle (and 76 more)
</code></pre>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-209bf2b1793403ac2d9c18c87a7dab54">4.4.14 - Log</h1>
    
	<p>This command prints the history of the current project revision.</p>
<p>Prints lines in the following format:
<code>&lt;short commit hash&gt; &lt;commit message&gt;</code></p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum log <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-n MAX_COUNT<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>-n, --max-count</code> (number, default: 10) - The maximum number of
previous revisions in the output</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Example output:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">affbh33 Added COCO dataset
eeffa35 Added VOC dataset
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6758bfd1eb71e4d0b6c4bf4aca1806f1">4.4.15 - Merge Datasets</h1>
    
	<p>Consider the following task: there is a set of images (the original dataset)
we want to annotate. Suppose we did this manually and/or automated it
using models, and now we have few sets of annotations for the same images.
We want to merge them and produce a single set of high-precision annotations.</p>
<p>Another use case: there are few datasets with different sets of images
and labels, which we need to combine in a single dataset. If the labels
were the same, we could just join the datasets. But in this case we need
to merge labels and adjust the annotations in the resulting dataset.</p>
<p>In Datumaro, it can be done with the <code>merge</code> command. This command merges 2
or more datasets and checks annotations for errors.</p>
<blockquote>
<p>In simple cases, when dataset images do not intersect and new
labels are not added, the recommended way of merging is using
<a href="../../docs/user-manual/command-reference/patch/">the <code>patch</code> command</a>.
It will offer better performance and provide the same results.</p>
</blockquote>
<p>Datasets are merged by items, and item annotations are merged by finding the
unique ones across datasets. Annotations are matched between matching dataset
items by distance. Spatial annotations are compared by the applicable distance
measure (IoU, OKS, PDJ etc.), labels and annotation attributes are selected
by voting. Each set of matching annotations produces a single annotation in
the resulting dataset. The <code>score</code> (a number in the range [0; 1]) attribute
indicates the agreement between different sources in the produced annotation.
The working time of the function can be estimated as
<code>O( (summary dataset length) * (dataset count) ^ 2 * (item annotations) ^ 2 )</code></p>
<p>This command also allows to merge datasets with different, or partially
overlapping sets of labels (which is impossible by simple joining).</p>
<p>During the process, some merge conflicts can appear. For example,
it can be mismatching dataset images having the same ids, label voting
can be unsuccessful if quorum is not reached (the <code>--quorum</code> parameter),
bboxes may be too close (the <code>-iou</code> parameter) etc. Found merge
conflicts, missing items or annotations, and other errors are saved into
an output <code>.json</code> file.</p>
<p>In Datumaro, annotations can be grouped. It can be useful to represent
different parts of a single object - for example, it can be different parts
of a human body, parts of a vehicle etc. This command allows to check
annotation groups for completeness with the <code>-g/--groups</code> option. If used,
this parameter must specify a list of labels for annotations that must be
in the same group. It can be particularly useful to check if separate
keypoints are grouped and all the necessary object components in the same
group.</p>
<p>This command has multiple forms:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">1<span style="color:#ce5c00;font-weight:bold">)</span> datum merge &lt;revpath&gt;
2<span style="color:#ce5c00;font-weight:bold">)</span> datum merge &lt;revpath&gt; &lt;revpath&gt; ...
</code></pre></div><p>&lt;revpath&gt; - either <a href="../../docs/user-manual/how_to_use_datumaro/#revpath">a dataset path or a revision path</a>.</p>
<p>1 - Merges the current project&rsquo;s main target (&ldquo;project&rdquo;)
in the working tree with the specified dataset.</p>
<p>2 - Merges the specified datasets.
Note that the current project is not included in the list of merged
sources automatically.</p>
<p>The command supports passing extra exporting options for the output
dataset. The format can be specified with the <code>-f/--format</code> option.
Extra options should be passed after the main arguments
and after the <code>--</code> separator. Particularly, this is useful to include
images in the output dataset with <code>--save-images</code>.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum merge <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-iou IOU_THRESH<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-oconf OUTPUT_CONF_THRESH<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>--quorum QUORUM<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-g GROUPS<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-o DST_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-f FORMAT<span style="color:#ce5c00;font-weight:bold">]</span>
  target <span style="color:#ce5c00;font-weight:bold">[</span>target ...<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-- EXTRA_FORMAT_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;target&gt;</code> (string) - Target <a href="../../docs/user-manual/how_to_use_datumaro/#revpath">dataset revpaths</a>
(repeatable)</li>
<li><code>-iou</code>, <code>--iou-thresh</code> (number) - IoU matching threshold for spatial
annotations (both maximum inter-cluster and pairwise). Default is 0.25.</li>
<li><code>--quorum</code> (number) - Minimum count of votes for a label or attribute
to be counted. Default is 0.</li>
<li><code>-g, --groups</code> (string) - A comma-separated list of label names in
annotation groups to check. The <code>?</code> postfix can be added to a label to
make it optional in the group (repeatable)</li>
<li><code>-oconf</code>, <code>--output-conf-thresh</code> (number) - Confidence threshold for output
annotations to be included in the resulting dataset. Default is 0.</li>
<li><code>-o, --output-dir</code> (string) - Output directory. By default, a new directory
is created in the current directory.</li>
<li><code>--overwrite</code> - Allows to overwrite existing files in the output directory,
when it is specified and is not empty.</li>
<li><code>-f, --format</code> (string) - Output format. The default format is <code>datumaro</code>.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
<li><code>-- &lt;extra format args&gt;</code> - Additional arguments for the format writer
(use <code>-- -h</code> for help). Must be specified after the main command arguments.</li>
</ul>
<p>Examples:</p>
<p>Merge 4 (partially-)intersecting projects,</p>
<ul>
<li>consider voting successful when there are no less than 3 same votes</li>
<li>consider shapes intersecting when IoU &gt;= 0.6</li>
<li>check annotation groups to have <code>person</code>, <code>hand</code>, <code>head</code> and <code>foot</code>
(<code>?</code> is used for optional parts)</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum merge project1/ project2/ project3/ project4/ <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --quorum <span style="color:#0000cf;font-weight:bold">3</span> <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -iou 0.6 <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --groups <span style="color:#4e9a06">&#39;person,hand?,head,foot?&#39;</span>
</code></pre></div><p>Merge images and annotations from 2 datasets in COCO format:
<code>datum merge dataset1/:image_dir dataset2/:coco dataset3/:coco</code></p>
<p>Check groups of the merged dataset for consistency:
look for groups consisting of <code>person</code>, <code>hand</code> <code>head</code>, <code>foot</code>
<code>datum merge project1/ project2/ -g 'person,hand?,head,foot?'</code></p>
<p>Merge two datasets, specify formats:
<code>datum merge path/to/dataset1:voc path/to/dataset2:coco</code></p>
<p>Merge the current working tree and a dataset:
<code>datum merge path/to/dataset2:coco</code></p>
<p>Merge a source from a previous revision and a dataset:
<code>datum merge HEAD~2:source-2 path/to/dataset2:yolo</code></p>
<p>Merge datasets and save in different format:
<code>datum merge -f voc dataset1/:yolo path2/:coco -- --save-images</code></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-db2ab356420634e305b5ea0550f9b9c3">4.4.16 - Models</h1>
    
	<p><a id="model-add"></a></p>
<h3 id="register-model">Register model</h3>
<p>Datumaro can execute deep learning models in various frameworks. Check
<a href="../../docs/user-manual/extending/#builtin-plugins">the plugins section</a>
for more info.</p>
<p>Supported frameworks:</p>
<ul>
<li>OpenVINO</li>
<li>Custom models via custom <code>launchers</code></li>
</ul>
<p>Models need to be added to the Datumaro project first. It can be done with
the <code>datum model add</code> command.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum model add <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-n NAME<span style="color:#ce5c00;font-weight:bold">]</span> -l LAUNCHER <span style="color:#ce5c00;font-weight:bold">[</span>--copy<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--no-check<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-- EXTRA_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>-l, --launcher</code> (string) - Model launcher name</li>
<li><code>--copy</code> - Copy model data into project. By default, only the link is saved.</li>
<li><code>--no-check</code> - Don&rsquo;t check the model can be loaded</li>
<li><code>-n</code>, <code>--name</code> (string) - Name of the new model (default: generate
automatically)</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
<li><code>&lt;extra args&gt;</code> - Additional arguments for the model launcher
(use <code>-- -h</code> for help). Must be specified after the main command arguments.</li>
</ul>
<p>Example: register an OpenVINO model</p>
<p>A model consists of a graph description and weights. There is also a script
used to convert model outputs to internal data structures.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum model add <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -n &lt;model_name&gt; -l openvino -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -d &lt;path_to_xml&gt; -w &lt;path_to_bin&gt; -i &lt;path_to_interpretation_script&gt;
</code></pre></div><p>Interpretation script for an OpenVINO detection model (<code>convert.py</code>):
You can find OpenVINO model interpreter samples in
<code>datumaro/plugins/openvino/samples</code> (<a href="../../docs/plugins/openvino_plugin">instruction</a>).</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">max_det</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">10</span>
<span style="color:#000">conf_thresh</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0.1</span>

<span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">process_outputs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">inputs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">outputs</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#8f5902;font-style:italic"># inputs = model input, array or images, shape = (N, C, H, W)</span>
    <span style="color:#8f5902;font-style:italic"># outputs = model output, shape = (N, 1, K, 7)</span>
    <span style="color:#8f5902;font-style:italic"># results = conversion result, [ [ Annotation, ... ], ... ]</span>
    <span style="color:#000">results</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[]</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#204a87">input</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">output</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#204a87">zip</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">inputs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">outputs</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#000">input_height</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input_width</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">input</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">shape</span><span style="color:#000;font-weight:bold">[:</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">]</span>
        <span style="color:#000">detections</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">output</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]</span>
        <span style="color:#000">image_results</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[]</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">det</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">detections</span><span style="color:#000;font-weight:bold">:</span>
            <span style="color:#000">label</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">])</span>
            <span style="color:#000">conf</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">float</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">])</span>
            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">conf</span> <span style="color:#ce5c00;font-weight:bold">&lt;=</span> <span style="color:#000">conf_thresh</span><span style="color:#000;font-weight:bold">:</span>
                <span style="color:#204a87;font-weight:bold">continue</span>

            <span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">max</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">input_width</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">max</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">input_height</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#000">w</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">min</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">input_width</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">input_width</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#000">h</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">min</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">6</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">input_height</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">input_height</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#000">image_results</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Bbox</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">w</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">h</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">label</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;score&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">conf</span><span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">))</span>

            <span style="color:#000">results</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">image_results</span><span style="color:#000;font-weight:bold">[:</span><span style="color:#000">max_det</span><span style="color:#000;font-weight:bold">])</span>

    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">results</span>

<span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">get_categories</span><span style="color:#000;font-weight:bold">():</span>
    <span style="color:#8f5902;font-style:italic"># Optionally, provide output categories - label map etc.</span>
    <span style="color:#8f5902;font-style:italic"># Example:</span>
    <span style="color:#000">label_categories</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">LabelCategories</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000">label_categories</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">add</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;person&#39;</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000">label_categories</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">add</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;car&#39;</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">AnnotationType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">label</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">label_categories</span> <span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><a id="model-remove"></a></p>
<h3 id="remove-models">Remove Models</h3>
<p>To remove a model from a project, use the <code>datum model remove</code> command.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum model remove <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> name
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;name&gt;</code> (string) - The name of the model to be removed</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum model add &lt;...&gt; -n model1
datum remove model1
</code></pre></div><p><a id="model-run"></a></p>
<h3 id="run-model">Run Model</h3>
<p>This command applies model to dataset images and produces a new dataset.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum model run
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;target&gt;</code> (string) - A project build target to be used.
By default, uses the combined <code>project</code> target.</li>
<li><code>-m, --model</code> (string) - Model name</li>
<li><code>-o, --output-dir</code> (string) - Output directory. By default, results will
be stored in an auto-generated directory in the current directory.</li>
<li><code>--overwrite</code> - Allows to overwrite existing files in the output directory,
when it is specified and is not empty.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Example: launch inference on a dataset</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import &lt;...&gt;
datum model add mymodel &lt;...&gt;
datum model run -m mymodel -o inference
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-160c03d29dec976c331bb969c9551cf4">4.4.17 - Patch Datasets</h1>
    
	<p>Updates items of the first dataset with items from the second one.</p>
<p>By default, datasets are updated in-place. The <code>-o/--output-dir</code>
option can be used to specify another output directory. When
updating in-place, use the <code>--overwrite</code> parameter along with the
<code>--save-images</code> export option (in-place updates fail by default
to prevent data loss).</p>
<p>Unlike the regular project <a href="../../api/api/developer_manual.html#merging">data source joining</a>,
the datasets are not required to have the same labels. The labels from
the &ldquo;patch&rdquo; dataset are projected onto the labels of the patched dataset,
so only the annotations with the matching labels are used, i.e.
all the annotations having unknown labels are ignored. Currently,
this command doesn&rsquo;t allow to update the label information in the
patched dataset.</p>
<p>The command supports passing extra exporting options for the output
dataset. The extra options should be passed after the main arguments
and after the <code>--</code> separator. Particularly, this is useful to include
images in the output dataset with <code>--save-images</code>.</p>
<p>This command can be applied to the current project targets or
arbitrary datasets outside a project. Note that if the target dataset
is read-only (e.g. if it is a project, stage or a cache entry),
the output directory must be provided.</p>
<p>Usage:</p>
<pre><code>datum patch [-h] [-o DST_DIR] [--overwrite] [-p PROJECT_DIR]
  target patch
  [-- EXPORT_ARGS]
</code></pre><p>&lt;revpath&gt; - either <a href="../../docs/user-manual/how_to_use_datumaro/#revpath">a dataset path or a revision path</a>.</p>
<p>The current project (<code>-p/--project</code>) is also used as a context for
plugins, so it can be useful for dataset paths having custom formats.
When not specified, the current project&rsquo;s working tree is used.</p>
<p>Parameters:</p>
<ul>
<li><code>&lt;target dataset&gt;</code> (string) - Target <a href="../../docs/user-manual/how_to_use_datumaro/#revpath">dataset revpath</a></li>
<li><code>&lt;patch dataset&gt;</code> (string) - Patch <a href="../../docs/user-manual/how_to_use_datumaro/#revpath">dataset revpath</a></li>
<li><code>-o, --output-dir</code> (string) - Output directory. By default, saves in-place</li>
<li><code>--overwrite</code> - Allows to overwrite existing files in the output directory,
when it is not empty.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
<li><code>-- &lt;export args&gt;</code> - Additional arguments for the format writer
(use <code>-- -h</code> for help). Must be specified after the main command arguments.</li>
</ul>
<p>Examples:</p>
<ul>
<li>Update a VOC-like dataset with COCO-like annotations:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum patch --overwrite dataset1/:voc dataset2/:coco -- --save-images
</code></pre></div><ul>
<li>Generate a patched dataset, based on a project:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum patch -o patched_proj1/ proj1/ proj2/
</code></pre></div><ul>
<li>Update the &ldquo;source1&rdquo; source in the current project with a dataset:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum patch -p proj/ --overwrite source1 path/to/dataset2:coco
</code></pre></div><ul>
<li>Generate a patched source from a previous revision and a dataset:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum patch -o new_src2/ HEAD~2:source-2 path/to/dataset2:yolo
</code></pre></div><ul>
<li>Update a dataset in a custom format, described in a project plugin:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum patch -p proj/ --overwrite dataset/:my_format dataset2/:coco
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-49c04c4e75f0995ee1c9c4c121d042c7">4.4.18 - Projects</h1>
    
	<p><a id="project-migrate"></a></p>
<h3 id="migrate-project">Migrate project</h3>
<p>Updates the project from an old version to the current one and saves the
resulting project in the output directory. Projects cannot be updated
inplace.</p>
<p>The command tries to map the old source configuration to the new one.
This can fail in some cases, so the command will exit with an error,
unless <code>-f/--force</code> is specified. With this flag, the command will
skip these errors an continue its work.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum project migrate <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -o DST_DIR <span style="color:#ce5c00;font-weight:bold">[</span>-f<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>-o, --output-dir</code> (string) - Output directory for the updated project</li>
<li><code>-f, --force</code> - Ignore source import errors (default: False)</li>
<li><code>--overwrite</code> - Overwrite existing files in the save directory.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Examples:</p>
<ul>
<li>Migrate a project from v1 to v2, save the new project in other dir:
<code>datum project migrate -o &lt;output/dir&gt;</code></li>
</ul>
<p><a id="project-info"></a></p>
<h3 id="print-project-info">Print project info</h3>
<p>Prints project configuration info such as available plugins, registered models,
imported sources and build tree.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum project info <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>revision<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;revision&gt;</code> (string) - Target project revision. By default,
uses the working tree.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Examples:</p>
<ul>
<li>
<p>Print project info for the current working tree:
<code>datum project info</code></p>
</li>
<li>
<p>Print project info for the previous revision:
<code>datum project info HEAD~1</code></p>
</li>
</ul>
<p>Sample output:</p>
<details>
<pre><code>Project:
  location: /test_proj

Plugins:
  extractors: ade20k2017, ade20k2020, camvid, cifar, cityscapes, coco, coco_captions, coco_image_info, coco_instances, coco_labels, coco_panoptic, coco_person_keypoints, coco_stuff, cvat, datumaro, icdar_text_localization, icdar_text_segmentation, icdar_word_recognition, image_dir, image_zip, imagenet, imagenet_txt, kitti, kitti_detection, kitti_raw, kitti_segmentation, label_me, lfw, market1501, mnist, mnist_csv, mot_seq, mots, mots_png, open_images, sly_pointcloud, tf_detection_api, vgg_face2, voc, voc_action, voc_classification, voc_detection, voc_layout, voc_segmentation, wider_face, yolo, yolo_ultralytics

  converters: camvid, mot_seq_gt, coco_captions, coco, coco_image_info, coco_instances, coco_labels, coco_panoptic, coco_person_keypoints, coco_stuff, kitti, kitti_detection, kitti_segmentation, icdar_text_localization, icdar_text_segmentation, icdar_word_recognition, lfw, datumaro, open_images, image_zip, cifar, yolo, voc_action, voc_classification, voc, voc_detection, voc_layout, voc_segmentation, tf_detection_api, label_me, mnist, cityscapes, mnist_csv, kitti_raw, wider_face, vgg_face2, sly_pointcloud, mots_png, image_dir, imagenet_txt, market1501, imagenet, cvat, yolo_ultralytics

  launchers:

Models:

Sources:
  'source-2':
    format: voc
    url: /datasets/pascal/VOC2012
    location: /test_proj/source-2/
    options: {}
    hash: 3eb282cdd7339d05b75bd932a1fd3201
    stages:
      'root':
        type: source
        hash: 3eb282cdd7339d05b75bd932a1fd3201
  'source-3':
    format: imagenet
    url: /datasets/imagenet/ILSVRC2012_img_val/train
    location: /test_proj/source-3/
    options: {}
    hash: e47804a3ec1a54c9b145e5f1007ec72f
    stages:
      'root':
        type: source
        hash: e47804a3ec1a54c9b145e5f1007ec72f
</code></pre></details>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c2f8a93a24bacb198650741c90e7c052">4.4.19 - Search datasets</h1>
    
	<p>This command search similar data results for query on dataset. The result includes top-k similar data among target dataset and the visualization of result is saved as png file. This tool is supposed to help users to figure out dataset property.</p>
<p>Currently, hash of each data is computed based on the CLIP (<a href="https://arxiv.org/abs/2103.00020">article</a>), which could support both image and text modality. Supported model format is Openvino IR and those are uploaded in <a href="https://storage.openvinotoolkit.org/repositories/datumaro/models/">openvinotoolkit storage</a>. When you call <code>Searcher</code> class, hash of whole dataset is started to compute. Through CLIP, we extracted feature of data, converted to binary value and pack the elements into bits. Each hash information is saved as <code>HashKey</code> in annotations.</p>
<p>To search similar data in dataset, you need to set query first. Query could be image, text, list of images and list of texts. The query does not need to be an image that exists in the dataset. You can put in any data that you want to search similar dataset. And you need to set top-k that how much you want to find similar data. For single query, we computed hamming distance of hash between whole dataset and query. And we sorted those distance and select top-k data which have short distance. For list query, we repeated computing distance for each query and select top-k data based on distance among all dataset.</p>
<p>The command can be applied to a dataset. And if you want to use multiple dataset as database, you could use merged dataset. The current project (<code>-p/--project</code>) is also used a context for plugins, so it can be useful for dataset paths having custom formats. When not specified, the current project&rsquo;s working tree is used. To save visualized result (<code>-s/--save</code>) is turned on as default. This visualized result is based on <a href="https://openvinotoolkit.github.io/datumaro/docs/python-api/python-api-examples/visualizer/">Visualizer</a>.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum search <span style="color:#ce5c00;font-weight:bold">[</span>-q &lt;path/to/image.jpg&gt; or &lt;text_query&gt;<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-topk TOPK<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>-q, --query</code> (string) - Image path or text to use as query.</li>
<li><code>-topk</code> (int) - Number how much you want to find similar data.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on (default: current directory).</li>
<li><code>-s, --save</code> (bool) - Save visualized result of similar dataset.</li>
</ul>
<p>Examples:</p>
<ul>
<li>Use image query</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create &lt;...&gt;
datum search -q path/to/image.jpg -topk <span style="color:#0000cf;font-weight:bold">10</span>
</code></pre></div><ul>
<li>Use text query</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create &lt;...&gt;
datum search -q elephant -topk <span style="color:#0000cf;font-weight:bold">10</span>
</code></pre></div><ul>
<li>Use list of images query</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create &lt;...&gt;
datum search -q path/to/image1.jpg path/to/image2.jpg path/to/image3.jpg -topk <span style="color:#0000cf;font-weight:bold">50</span>
</code></pre></div><ul>
<li>Use list of texts query</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create &lt;...&gt;
datum search -q motorcycle bus train -topk <span style="color:#0000cf;font-weight:bold">50</span>
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-dc182af461d71cbd7217b8679bde29bc">4.4.20 - Sources</h1>
    
	<p>These commands are specific for Data Sources. Read more about them <a href="../../docs/user-manual/how_to_use_datumaro#data-sources">here</a>.</p>
<p><a id="source-import"></a></p>
<h3 id="import-dataset">Import Dataset</h3>
<p>Datasets can be added to a Datumaro project with the <code>import</code> command,
which adds a dataset link into the project and downloads (or copies)
the dataset. If you need to add a dataset already copied into the project,
use the <a href="#source-add"><code>add</code></a> command.</p>
<p>Dataset format readers can provide some additional import options. To pass
such options, use the <code>--</code> separator after the main command arguments.
The usage information can be printed with <code>datum import -f &lt;format&gt; -- --help</code>.</p>
<p>The list of currently available formats is listed in the command help output.</p>
<p>A dataset is imported by its URL. Currently, only local filesystem
paths are supported. The URL can be a file or a directory path
to a dataset. When the dataset is read, it is read as a whole.
However, many formats can have multiple subsets like <code>train</code>, <code>val</code>, <code>test</code>
etc. If you want to limit reading only to a specific subset, use
the <code>-r/--path</code> parameter. It can also be useful when subset files have
non-standard placement or names.</p>
<p>When a dataset is imported, the following things are done:</p>
<ul>
<li>URL is saved in the project config</li>
<li>data in copied into the project</li>
</ul>
<p>Each data source has a name assigned, which can be used in other commands. To
set a specific name, use the <code>-n/--name</code> parameter.</p>
<p>The dataset is added into the working tree of the project. A new commit
is <em>not</em> done automatically.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-n NAME<span style="color:#ce5c00;font-weight:bold">]</span> -f FORMAT <span style="color:#ce5c00;font-weight:bold">[</span>-r PATH<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--no-check<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> url <span style="color:#ce5c00;font-weight:bold">[</span>-- EXTRA_FORMAT_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;url&gt;</code> (string) - A file of directory path to the dataset.</li>
<li><code>-f, --format</code> (string) - Dataset format</li>
<li><code>-r, --path</code> (string) - A path relative to the source URL the data source.
Useful to specify a path to a subset, subtask, or a specific file in URL.</li>
<li><code>--no-check</code> - Don&rsquo;t try to read the source after importing</li>
<li><code>-n</code>, <code>--name</code> (string) - Name of the new source (default: generate
automatically)</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
<li><code>-- &lt;extra format args&gt;</code> - Additional arguments for the format reader
(use <code>-- -h</code> for help). Must be specified after the main command arguments.</li>
</ul>
<p>Example: create a project from images and annotations in different formats,
export as TFrecord for TF Detection API for model training</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># &#39;default&#39; is the name of the subset below</span>
datum create
datum import -f coco_instances -r annotations/instances_default.json path/to/coco
datum import -f cvat &lt;path/to/cvat/default.xml&gt;
datum import -f voc_detection -r custom_subset_dir/default.txt &lt;path/to/voc&gt;
datum import -f datumaro &lt;path/to/datumaro/default.json&gt;
datum import -f image_dir &lt;path/to/images/dir&gt;
datum <span style="color:#204a87">export</span> -f tf_detection_api -- --save-images
</code></pre></div><p><a id="source-add"></a></p>
<h3 id="add-dataset">Add Dataset</h3>
<p>Existing datasets can be added to a Datumaro project with the <code>add</code> command.
The command adds a project-local directory as a data source in the project.
Unlike the <a href="#source-import"><code>import</code></a>
command, it does not copy datasets and only works with local directories.
The source name is defined by the directory name.</p>
<p>Dataset format readers can provide some additional import options. To pass
such options, use the <code>--</code> separator after the main command arguments.
The usage information can be printed with <code>datum add -f &lt;format&gt; -- --help</code>.</p>
<p>The list of currently available formats is listed in the command help output.</p>
<p>A dataset is imported as a directory. When the dataset is read, it is read
as a whole. However, many formats can have multiple subsets like <code>train</code>,
<code>val</code>, <code>test</code> etc. If you want to limit reading only to a specific subset,
use the <code>-r/--path</code> parameter. It can also be useful when subset files have
non-standard placement or names.</p>
<p>The dataset is added into the working tree of the project. A new commit
is <em>not</em> done automatically.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum add <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -f FORMAT <span style="color:#ce5c00;font-weight:bold">[</span>-r PATH<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--no-check<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> path <span style="color:#ce5c00;font-weight:bold">[</span>-- EXTRA_FORMAT_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;url&gt;</code> (string) - A file of directory path to the dataset.</li>
<li><code>-f, --format</code> (string) - Dataset format</li>
<li><code>-r, --path</code> (string) - A path relative to the source URL the data source.
Useful to specify a path to a subset, subtask, or a specific file in URL.</li>
<li><code>--no-check</code> - Don&rsquo;t try to read the source after importing</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
<li><code>-- &lt;extra format args&gt;</code> - Additional arguments for the format reader
(use <code>-- -h</code> for help). Must be specified after the main command arguments.</li>
</ul>
<p>Example: create a project from images and annotations in different formats,
export in YOLO for model training</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum add -f coco -r annotations/instances_train.json dataset1/
datum add -f cvat dataset2/train.xml
datum <span style="color:#204a87">export</span> -f yolo -- --save-images
</code></pre></div><p>Example: add an existing dataset into a project, avoid data copying</p>
<p>To add a dataset, we need to have it inside the project directory:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">proj/
├─ .datumaro/
├─ .dvc/
├─ my_coco/
│  └─ images/
│     ├─ image1.jpg
│     └─ ...
│  └─ annotations/
│     └─ coco_annotation.json
├─ .dvcignore
└─ .gitignore
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o proj/
mv ~/my_coco/ proj/my_coco/ <span style="color:#8f5902;font-style:italic"># move the dataset into the project directory</span>
datum add -p proj/ -f coco proj/my_coco/
</code></pre></div><p><a id="source-remove"></a></p>
<h3 id="remove-datasets">Remove Datasets</h3>
<p>To remove a data source from a project, use the <code>remove</code> command.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum remove <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--force<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--keep-data<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> name <span style="color:#ce5c00;font-weight:bold">[</span>name ...<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;name&gt;</code> (string) - The name of the source to be removed (repeatable)</li>
<li><code>-f, --force</code> - Do not fail and stop on errors during removal</li>
<li><code>--keep-data</code> - Do not remove source data from the working directory, remove
only project metainfo.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f voc -n src1 &lt;path/to/dataset/&gt;
datum remove src1
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-645d2da4c36696ec093ba5e3ce99c77c">4.4.21 - Get Project Statistics</h1>
    
	<p>This command computes various project statistics, such as:</p>
<ul>
<li>image mean and std. dev.</li>
<li>class and attribute balance</li>
<li>mask pixel balance</li>
<li>segment area distribution</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum stats <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>target<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;target&gt;</code> (string) - Target
<a href="../../docs/user-manual/how_to_use_datumaro/#revpath">source revpath</a>.
By default, computes statistics of the merged dataset.</li>
<li><code>-s, --subset</code> (string) - Compute stats only for a specific subset</li>
<li><code>--image-stats</code> (bool) - Compute image mean and std (default: True)</li>
<li><code>--ann-stats</code> (bool) - Compute annotation statistics (default: True)</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum stats -p test_project
</code></pre></div><p>Sample output:</p>
<details>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;annotations&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">&#34;labels&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;attributes&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#204a87;font-weight:bold">&#34;gender&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">358</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;distribution&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
                        <span style="color:#204a87;font-weight:bold">&#34;female&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                            <span style="color:#0000cf;font-weight:bold">149</span><span style="color:#000;font-weight:bold">,</span>
                            <span style="color:#0000cf;font-weight:bold">0.41620111731843573</span>
                        <span style="color:#000;font-weight:bold">],</span>
                        <span style="color:#204a87;font-weight:bold">&#34;male&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                            <span style="color:#0000cf;font-weight:bold">209</span><span style="color:#000;font-weight:bold">,</span>
                            <span style="color:#0000cf;font-weight:bold">0.5837988826815642</span>
                        <span style="color:#000;font-weight:bold">]</span>
                    <span style="color:#000;font-weight:bold">},</span>
                    <span style="color:#204a87;font-weight:bold">&#34;values count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;values present&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                        <span style="color:#4e9a06">&#34;female&#34;</span><span style="color:#000;font-weight:bold">,</span>
                        <span style="color:#4e9a06">&#34;male&#34;</span>
                    <span style="color:#000;font-weight:bold">]</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#204a87;font-weight:bold">&#34;view&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">340</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;distribution&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
                        <span style="color:#204a87;font-weight:bold">&#34;__undefined__&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                            <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">,</span>
                            <span style="color:#0000cf;font-weight:bold">0.011764705882352941</span>
                        <span style="color:#000;font-weight:bold">],</span>
                        <span style="color:#204a87;font-weight:bold">&#34;front&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                            <span style="color:#0000cf;font-weight:bold">54</span><span style="color:#000;font-weight:bold">,</span>
                            <span style="color:#0000cf;font-weight:bold">0.1588235294117647</span>
                        <span style="color:#000;font-weight:bold">],</span>
                        <span style="color:#204a87;font-weight:bold">&#34;left&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                            <span style="color:#0000cf;font-weight:bold">14</span><span style="color:#000;font-weight:bold">,</span>
                            <span style="color:#0000cf;font-weight:bold">0.041176470588235294</span>
                        <span style="color:#000;font-weight:bold">],</span>
                        <span style="color:#204a87;font-weight:bold">&#34;rear&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                            <span style="color:#0000cf;font-weight:bold">235</span><span style="color:#000;font-weight:bold">,</span>
                            <span style="color:#0000cf;font-weight:bold">0.6911764705882353</span>
                        <span style="color:#000;font-weight:bold">],</span>
                        <span style="color:#204a87;font-weight:bold">&#34;right&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                            <span style="color:#0000cf;font-weight:bold">33</span><span style="color:#000;font-weight:bold">,</span>
                            <span style="color:#0000cf;font-weight:bold">0.09705882352941177</span>
                        <span style="color:#000;font-weight:bold">]</span>
                    <span style="color:#000;font-weight:bold">},</span>
                    <span style="color:#204a87;font-weight:bold">&#34;values count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;values present&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                        <span style="color:#4e9a06">&#34;__undefined__&#34;</span><span style="color:#000;font-weight:bold">,</span>
                        <span style="color:#4e9a06">&#34;front&#34;</span><span style="color:#000;font-weight:bold">,</span>
                        <span style="color:#4e9a06">&#34;left&#34;</span><span style="color:#000;font-weight:bold">,</span>
                        <span style="color:#4e9a06">&#34;rear&#34;</span><span style="color:#000;font-weight:bold">,</span>
                        <span style="color:#4e9a06">&#34;right&#34;</span>
                    <span style="color:#000;font-weight:bold">]</span>
                <span style="color:#000;font-weight:bold">}</span>
            <span style="color:#000;font-weight:bold">},</span>
            <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">2038</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;distribution&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#204a87;font-weight:bold">&#34;car&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">340</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.16683022571148184</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;cyclist&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">194</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.09519136408243375</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;head&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">354</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.17369970559371933</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;ignore&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.04906771344455348</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;left_hand&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">238</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.11678115799803729</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;person&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">358</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.17566241413150147</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;right_hand&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">77</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.037782139352306184</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;road_arrows&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">326</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.15996074582924436</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;traffic_sign&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">51</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.025024533856722278</span>
                <span style="color:#000;font-weight:bold">]</span>
            <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#204a87;font-weight:bold">&#34;segments&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;area distribution&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1318</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">11425.1</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.9627465303140978</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">22850.2</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">11425.1</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.0007304601899196494</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">34275.3</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">22850.2</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">45700.4</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">34275.3</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">57125.5</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">45700.4</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">68550.6</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">57125.5</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">79975.7</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">68550.6</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">91400.8</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">79975.7</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">102825.90000000001</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">91400.8</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">50</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">114251.0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">102825.90000000001</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.036523009495982466</span>
                <span style="color:#000;font-weight:bold">}</span>
            <span style="color:#000;font-weight:bold">],</span>
            <span style="color:#204a87;font-weight:bold">&#34;avg. area&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">5411.624543462382</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;pixel distribution&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#204a87;font-weight:bold">&#34;car&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">13655</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.0018431496518735067</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;cyclist&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">939005</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.12674674030446592</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;head&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;ignore&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">5501200</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.7425510702956085</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;left_hand&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;person&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">954654</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.12885903974805205</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;right_hand&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;road_arrows&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;traffic_sign&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">]</span>
            <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">},</span>
    <span style="color:#204a87;font-weight:bold">&#34;annotations by type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">&#34;bbox&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">548</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#204a87;font-weight:bold">&#34;caption&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#204a87;font-weight:bold">&#34;label&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#204a87;font-weight:bold">&#34;mask&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#204a87;font-weight:bold">&#34;points&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">669</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#204a87;font-weight:bold">&#34;polygon&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">821</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#204a87;font-weight:bold">&#34;polyline&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span>
        <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">},</span>
    <span style="color:#204a87;font-weight:bold">&#34;annotations count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">2038</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;unannotated images&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
        <span style="color:#4e9a06">&#34;img00051&#34;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#4e9a06">&#34;img00052&#34;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#4e9a06">&#34;img00053&#34;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#4e9a06">&#34;img00054&#34;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#4e9a06">&#34;img00055&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000;font-weight:bold">],</span>
    <span style="color:#204a87;font-weight:bold">&#34;unannotated images count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span>

    <span style="color:#204a87;font-weight:bold">&#34;dataset&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">&#34;images count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;unique images count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">97</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;repeated images count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;repeated images&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
            <span style="color:#000;font-weight:bold">[[</span><span style="color:#4e9a06">&#34;img00057&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;default&#34;</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;img00058&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;default&#34;</span><span style="color:#000;font-weight:bold">]],</span>
            <span style="color:#000;font-weight:bold">[[</span><span style="color:#4e9a06">&#34;img00059&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;default&#34;</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;img00060&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;default&#34;</span><span style="color:#000;font-weight:bold">]],</span>
            <span style="color:#000;font-weight:bold">[[</span><span style="color:#4e9a06">&#34;img00061&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;default&#34;</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;img00062&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;default&#34;</span><span style="color:#000;font-weight:bold">]],</span>
        <span style="color:#000;font-weight:bold">],</span>
    <span style="color:#000;font-weight:bold">},</span>
    <span style="color:#204a87;font-weight:bold">&#34;subsets&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">&#34;default&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;images count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;image mean&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                <span style="color:#0000cf;font-weight:bold">107.06903686941979</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#0000cf;font-weight:bold">79.12831698580979</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#0000cf;font-weight:bold">52.95829558185416</span>
            <span style="color:#000;font-weight:bold">],</span>
            <span style="color:#204a87;font-weight:bold">&#34;image std&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                <span style="color:#0000cf;font-weight:bold">49.40237673503467</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#0000cf;font-weight:bold">43.29600731496902</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#0000cf;font-weight:bold">35.47373007603151</span>
            <span style="color:#000;font-weight:bold">],</span>

        <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">},</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div></details>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a818e6c810d9d8ef27c2b0f440145895">4.4.22 - Status</h1>
    
	<p>This command prints the summary of the source changes between
the working tree of a project and its HEAD revision.</p>
<p>Prints lines in the following format:
<code>&lt;status&gt; &lt;source name&gt;</code></p>
<p>The list of possible <code>status</code> values:</p>
<ul>
<li><code>modified</code> - the source data exists and it is changed</li>
<li><code>foreign_modified</code> - the source data exists and it is changed,
but Datumaro does not know about the way the differences were made.
If changes are committed, they will only be available for reproduction
from the project cache.</li>
<li><code>added</code> - the source was added in the working tree</li>
<li><code>removed</code> - the source was removed from the working tree. This status won&rsquo;t
be reported if just the source <em>data</em> is removed in the working tree.
In such situation the status will be <code>missing</code>.</li>
<li><code>missing</code> - the source data is removed from the working directory.
The source still can be restored from the project cache or reproduced.</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum status <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Example output:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">added source-1
modified source-2
foreign_modified source-3
removed source-4
missing source-5
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-86897105a5f038a99bfe0935866c69ce">4.4.23 - Transform Dataset</h1>
    
	<p>Often datasets need to be modified during preparation for model training and
experimenting. In trivial cases it can be done manually - e.g. image renaming
or label renaming. However, in more complex cases even simple modifications
can require too much efforts, distracting the user from the real work.
Datumaro provides the <code>datum transform</code> command to help in such cases.</p>
<p>This command allows to modify dataset images or annotations all at once.</p>
<blockquote>
<p>This command is designed for batch dataset processing, so if you only
need to modify few elements of a dataset, you might want to use
other approaches for better performance. A possible solution can be
a simple script, which uses <a href="../../api/api/developer_manual.html">Datumaro API</a>.</p>
</blockquote>
<p>The command can be applied to a dataset or a project build target,
a stage or the combined <code>project</code> target, in which case all the project
targets will be affected. A build tree stage will be recorded
if <code>--stage</code> is enabled, and the resulting dataset(-s) will be
saved if <code>--apply</code> is enabled.</p>
<p>By default, datasets are updated in-place. The <code>-o/--output-dir</code>
option can be used to specify another output directory. When
updating in-place, use the <code>--overwrite</code> parameter (in-place
updates fail by default to prevent data loss), unless a project
target is modified.</p>
<p>The current project (<code>-p/--project</code>) is also used as a context for
plugins, so it can be useful for dataset paths having custom formats.
When not specified, the current project&rsquo;s working tree is used.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -t TRANSFORM <span style="color:#ce5c00;font-weight:bold">[</span>-o DST_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--stage STAGE<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--apply APPLY<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>target<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-- EXTRA_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;target&gt;</code> (string) - Target
<a href="../../docs/user-manual/how_to_use_datumaro/#revpath">dataset revpath</a>.
By default, transforms all targets of the current project.</li>
<li><code>-t, --transform</code> (string) - Transform method name</li>
<li><code>--stage</code> (bool) - Include this action as a project build step.
If true, this operation will be saved in the project
build tree, allowing to reproduce the resulting dataset later.
Applicable only to main project targets (i.e. data sources
and the <code>project</code> target, but not intermediate stages). Enabled by default.</li>
<li><code>--apply</code> (bool) - Run this command immediately. If disabled, only the
build tree stage will be written. Enabled by default.</li>
<li><code>-o, --output-dir</code> (string) - Output directory. Can be omitted for
main project targets (i.e. data sources and the <code>project</code> target, but not
intermediate stages) and dataset targets. If not specified, the results
will be saved inplace.</li>
<li><code>--overwrite</code> - Allows to overwrite existing files in the output directory,
when it is specified and is not empty.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
<li><code>&lt;extra args&gt;</code> - The list of extra transformation parameters. Should be
passed after the <code>--</code> separator after the main command arguments. See
transform descriptions for info about extra parameters. Use the <code>--help</code>
option to print parameter info.</li>
</ul>
<p>Examples:</p>
<ul>
<li>Split a VOC-like dataset randomly:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t random_split --overwrite path/to/dataset:voc
</code></pre></div><ul>
<li>
<p>Rename images in a project data source by a regex from <code>frame_XXX</code> to <code>XXX</code>:</p>
<p><strong>NOTE:</strong> Please use double quotes (<code>&quot;</code>) for regex representation. Check <a href="https://stackoverflow.com/questions/51080215/differences-between-single-and-double-quotes-in-cmd">Reason to use double quotes</a>.</p>
</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create &lt;...&gt;
datum import &lt;...&gt; -n source-1
datum transform -t rename source-1 -- -e <span style="color:#4e9a06">&#34;|^frame_||&#34;</span>
</code></pre></div><p><a id="builtin-transforms"></a></p>
<h4 id="built-in-transforms">Built-in transforms</h4>
<p>Basic dataset item manipulations:</p>
<ul>
<li><a href="#rename-transform"><code>rename</code></a> - Renames dataset items by regular expression</li>
<li><a href="#id_from_image_name-transform"><code>id_from_image_name</code></a> - Renames dataset
items to their image filenames</li>
<li><a href="#reindex-transform"><code>reindex</code></a> - Renames dataset items with numbers</li>
<li><a href="#ndr-transform"><code>ndr</code></a> - Removes duplicated images from dataset</li>
<li><a href="#relevancy_sampler-transform"><code>relevancy_sampler</code></a> - Leaves only the most
important images
(requires model inference results)</li>
<li><a href="#random_sampler-transform"><code>random_sampler</code></a> - Leaves no more than k items
from the dataset randomly</li>
<li><a href="#label_random_sampler-transform"><code>label_random_sampler</code></a> - Leaves at least
k images with annotations per class</li>
<li><a href="#resize-transform"><code>resize</code></a> - Resizes images and annotations in the dataset</li>
<li><a href="#remove_images-transform"><code>remove_images</code></a> - Removes specific images</li>
<li><a href="#remove_annotations-transform"><code>remove_annotations</code></a> - Removes annotations</li>
<li><a href="#remove_attributes-transform"><code>remove_attributes</code></a> - Removes attributes</li>
</ul>
<p>Subset manipulations:</p>
<ul>
<li><a href="#random_split-transform"><code>random_split</code></a> - Splits dataset into subsets
randomly</li>
<li><a href="#split-transform"><code>split</code></a> - Splits dataset into subsets for classification,
detection, segmentation or re-identification</li>
<li><a href="#map_subsets-transform"><code>map_subsets</code></a> - Renames and removes subsets</li>
</ul>
<p>Annotation manipulations:</p>
<ul>
<li><a href="#remap_labels-transform"><code>remap_labels</code></a> - Renames, adds or removes
labels in dataset</li>
<li><a href="#project_labels-transform"><code>project_labels</code></a> - Sets dataset labels to
the requested sequence</li>
<li><a href="#shapes_to_boxes-transform"><code>shapes_to_boxes</code></a> - Replaces spatial
annotations with bounding boxes</li>
<li><a href="#boxes_to_masks-transform"><code>boxes_to_masks</code></a> - Converts bounding boxes
to instance masks</li>
<li><a href="#polygons_to_masks-transform"><code>polygons_to_masks</code></a> - Converts polygons
to instance masks</li>
<li><a href="#masks_to_polygons-transform"><code>masks_to_polygons</code></a> - Converts instance
masks to polygons</li>
<li><a href="#anns_to_labels-transform"><code>anns_to_labels</code></a> - Replaces annotations having
labels with label annotations</li>
<li><a href="#merge_instance_segments-transform"><code>merge_instance_segments</code></a> - Merges
grouped spatial annotations into a mask</li>
<li><a href="#crop_covered_segments-transform"><code>crop_covered_segments</code></a> - Removes
occluded segments of covered masks</li>
<li><a href="#bbox_value_decrement-transform"><code>bbox_value_decrement</code></a> - Subtracts
1 from bbox coordinates</li>
</ul>
<p><a id="rename-transform"></a></p>
<h5 id="rename"><code>rename</code></h5>
<p>Renames items in the dataset. Supports regular expressions.
The first character in the expression is a delimiter for
the pattern and replacement parts. Replacement part can also
contain <code>str.format</code> replacement fields with the <code>item</code>
(of type <code>DatasetItem</code>) object available.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">rename <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-e REGEX<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-e</code>, <code>--regex</code> (string) - Regex for renaming in the form
<code>&lt;sep&gt;&lt;search&gt;&lt;sep&gt;&lt;replacement&gt;&lt;sep&gt;</code></li>
</ul>
<p>Examples:
Replace &lsquo;pattern&rsquo; with &lsquo;replacement&rsquo;:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t rename -- -e <span style="color:#4e9a06">&#34;|pattern|replacement|&#34;</span>
</code></pre></div><p>Remove the <code>frame_</code> prefix from item ids:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t rename -- -e <span style="color:#4e9a06">&#34;|^frame_|\1|&#34;</span>
</code></pre></div><p>Collect images from subdirectories into the base image directory using regex:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t rename -- -e <span style="color:#4e9a06">&#34;|^((.+[/\\])*)?(.+)</span>$<span style="color:#4e9a06">|\2|&#34;</span>
</code></pre></div><p>Add subset prefix to images:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t rename -- -e <span style="color:#4e9a06">&#34;|(.*)|{item.subset}_\1|&#34;</span>
</code></pre></div><p><a id="id_from_image_name-transform"></a></p>
<h5 id="id_from_image_name"><code>id_from_image_name</code></h5>
<p>Renames items in the dataset using image file name (without extension).</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">id_from_image_name <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
</ul>
<p><a id="reindex-transform"></a></p>
<h5 id="reindex"><code>reindex</code></h5>
<p>Replaces dataset item IDs with sequential indices.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">reindex <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-s START<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-s</code>, <code>--start</code> (int) - Start value for item ids (default: 1)</li>
</ul>
<p><a id="ndr-transform"></a></p>
<h5 id="ndr"><code>ndr</code></h5>
<p>Removes near-duplicated images in subset.</p>
<p>Remove duplicated images from a dataset. Keep at most <code>-k/--num_cut</code>
resulting images.</p>
<p>Available oversampling policies (the <code>-e</code> parameter):</p>
<ul>
<li><code>random</code> - sample from removed data randomly</li>
<li><code>similarity</code> - sample from removed data with ascending similarity score</li>
</ul>
<p>Available undersampling policies (the <code>-u</code> parameter):</p>
<ul>
<li><code>uniform</code> - sample data with uniform distribution</li>
<li><code>inverse</code> - sample data with reciprocal of the number of number of
items with the same similarity</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ndr <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-w WORKING_SUBSET<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-d DUPLICATED_SUBSET<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-a <span style="color:#ce5c00;font-weight:bold">{</span>gradient<span style="color:#ce5c00;font-weight:bold">}]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-k NUM_CUT<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-e <span style="color:#ce5c00;font-weight:bold">{</span>random,similarity<span style="color:#ce5c00;font-weight:bold">}]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-u <span style="color:#ce5c00;font-weight:bold">{</span>uniform,inverse<span style="color:#ce5c00;font-weight:bold">}]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-s SEED<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-w</code>, <code>--working_subset</code> (str) - Name of the subset to operate
(default: <code>None</code>)</li>
<li><code>-d</code>, <code>--duplicated_subset</code> (str) - Name of the subset for the removed
data after NDR runs (default: duplicated)</li>
<li><code>-a</code>, <code>--algorithm</code> (one of: <code>gradient</code>) - Name of the algorithm to
use (default: <code>gradient</code>)</li>
<li><code>-k</code>, <code>--num_cut</code> (int) - Maximum output dataset size</li>
<li><code>-e</code>, <code>--over_sample</code> (one of: <code>random</code>, <code>similarity</code>) - The policy to use
when <code>num_cut</code> is bigger than result length (default: <code>random</code>)</li>
<li><code>-u</code>, <code>--under_sample</code> (one of: <code>uniform</code>, <code>inverse</code>) - The policy to use
when <code>num_cut</code> is smaller than result length (default: <code>uniform</code>)</li>
<li><code>-s</code>, <code>--seed</code> (int) - Random seed</li>
</ul>
<p>Example: apply NDR, return no more than 100 images</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t ndr -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --working_subset train
  --algorithm gradient
  --num_cut <span style="color:#0000cf;font-weight:bold">100</span>
  --over_sample random
  --under_sample uniform
</code></pre></div><p><a id="relevancy_sampler-transform"></a></p>
<h5 id="relevancy_sampler"><code>relevancy_sampler</code></h5>
<p>Sampler that analyzes model inference results on the dataset
and picks the most relevant samples for training.</p>
<p>Creates a dataset from the <code>-k/--count</code> hardest items for a model.
The whole dataset or a single subset will be split into the <code>sampled</code>
and <code>unsampled</code> subsets based on the model confidence. The dataset
<strong>must</strong> contain model confidence values in the <code>scores</code> attributes
of annotations.</p>
<p>There are five methods of sampling (the <code>-m/--method</code> option):</p>
<ul>
<li><code>topk</code> - Return the k items with the highest uncertainty data</li>
<li><code>lowk</code> - Return the k items with the lowest uncertainty data</li>
<li><code>randk</code> - Return random k items</li>
<li><code>mixk</code> - Return a half using topk, and the other half using lowk method</li>
<li><code>randtopk</code> - Select 3*k items randomly, and return the topk among them</li>
</ul>
<p>Notes:</p>
<ul>
<li>Each image&rsquo;s inference result must contain the probability for
all classes (in the <code>scores</code> attribute).</li>
<li>Requesting a sample larger than the number of all images will return
all images.</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">relevancy_sampler <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -k COUNT <span style="color:#ce5c00;font-weight:bold">[</span>-a <span style="color:#ce5c00;font-weight:bold">{</span>entropy<span style="color:#ce5c00;font-weight:bold">}]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-i INPUT_SUBSET<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-o SAMPLED_SUBSET<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-u UNSAMPLED_SUBSET<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-m <span style="color:#ce5c00;font-weight:bold">{</span>topk,lowk,randk,mixk,randtopk<span style="color:#ce5c00;font-weight:bold">}]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-d OUTPUT_FILE<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-k</code>, <code>--count</code> (int) - Number of items to sample</li>
<li><code>-a</code>, <code>--algorithm</code> (one of: <code>entropy</code>) - Sampling
algorithm (default: <code>entropy</code>)</li>
<li><code>-i</code>, <code>--input_subset</code> (str) - Subset name to select sample
from (default: <code>None</code>)</li>
<li><code>-o</code>, <code>--sampled_subset</code> (str) - Subset name to put sampled data
to (default: <code>sample</code>)</li>
<li><code>-u</code>, <code>--unsampled_subset</code> (str) - Subset name to put the
rest data to (default: <code>unsampled</code>)</li>
<li><code>-m</code>, <code>--sampling_method</code> (one of: <code>topk</code>, <code>lowk</code>, <code>randk</code>, <code>mixk</code>,
<code>randtopk</code>) - Sampling method (default: <code>topk</code>)</li>
<li><code>-d</code>, <code>--output_file</code> (path) - A <code>.csv</code> file path to dump sampling results</li>
</ul>
<p>Examples:
Select the most relevant data subset of 20 images
based on model certainty, put the result into <code>sample</code> subset
and put all the rest into <code>unsampled</code> subset, use <code>train</code> subset
as input. The dataset <strong>must</strong> contain model confidence values in the <code>scores</code>
attributes of annotations.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t relevancy_sampler -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --algorithm entropy <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --subset_name train <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --sample_name sample <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --unsampled_name unsampled <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --sampling_method topk -k <span style="color:#0000cf;font-weight:bold">20</span>
</code></pre></div><p><a id="random_sampler-transform"></a></p>
<h5 id="random_sampler"><code>random_sampler</code></h5>
<p>Sampler that keeps no more than required number of items in the dataset.</p>
<p>Notes:</p>
<ul>
<li>Items are selected uniformly (tries to keep original item distribution
by subsets)</li>
<li>Requesting a sample larger than the number of all images will return
all images</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">random_sampler <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -k COUNT <span style="color:#ce5c00;font-weight:bold">[</span>-s SUBSET<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--seed SEED<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-k</code>, <code>--count</code> (int) - Maximum number of items to sample</li>
<li><code>-s</code>, <code>--subset</code> (str) - Limit changes to this subset
(default: affect all dataset)</li>
<li><code>--seed</code> (int) - Initial value for random number generator</li>
</ul>
<p>Examples:
Select subset of 20 images randomly</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t random_sampler -- -k <span style="color:#0000cf;font-weight:bold">20</span>
</code></pre></div><p>Select subset of 20 images, modify only <code>train</code> subset</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t random_sampler -- -k <span style="color:#0000cf;font-weight:bold">20</span> -s train
</code></pre></div><p><a id="label_random_sampler-transform"></a></p>
<h5 id="random_label_sampler"><code>random_label_sampler</code></h5>
<p>Sampler that keeps at least the required number of annotations of
each class in the dataset for each subset separately.</p>
<p>Consider using the &ldquo;stats&rdquo; command to get class distribution in the dataset.</p>
<p>Notes:</p>
<ul>
<li>Items can contain annotations of several selected classes
(e.g. 3 bounding boxes per image). The number of annotations in the
resulting dataset varies between <code>max(class counts)</code> and <code>sum(class counts)</code></li>
<li>If the input dataset does not has enough class annotations, the result
will contain only what is available</li>
<li>Items are selected uniformly</li>
<li>For reasons above, the resulting class distribution in the dataset may
not be the same as requested</li>
<li>The resulting dataset will only keep annotations for classes with
specified <code>count</code> &gt; 0</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">label_random_sampler <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -k COUNT <span style="color:#ce5c00;font-weight:bold">[</span>-l LABEL_COUNTS<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--seed SEED<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-k</code>, <code>--count</code> (int) - Minimum number of annotations of each class</li>
<li><code>-l</code>, <code>--label</code> (str; repeatable) - Minimum number of annotations of
a specific class. Overrides the <code>-k/--count</code> setting for the class.
The format is <code>&lt;label_name&gt;:&lt;count&gt;</code></li>
<li><code>--seed</code> (int) - Initial value for random number generator</li>
</ul>
<p>Examples:
Select a dataset with at least 10 images of each class:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t label_random_sampler -- -k <span style="color:#0000cf;font-weight:bold">10</span>
</code></pre></div><p>Select a dataset with at least 20 <code>cat</code> images, 5 <code>dog</code>, 0 <code>car</code> and 10 of each
unmentioned class:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t label_random_sampler -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -l cat:20 <span style="color:#4e9a06">\ </span><span style="color:#8f5902;font-style:italic"># keep 20 images with cats</span>
  -l dog:5 <span style="color:#4e9a06">\ </span><span style="color:#8f5902;font-style:italic"># keep 5 images with dogs</span>
  -l car:0 <span style="color:#4e9a06">\ </span><span style="color:#8f5902;font-style:italic"># remove car annotations</span>
  -k <span style="color:#0000cf;font-weight:bold">10</span> <span style="color:#8f5902;font-style:italic"># for remaining classes</span>
</code></pre></div><p><a id="resize-transform"></a></p>
<h5 id="resize"><code>resize</code></h5>
<p>Resizes images and annotations in the dataset to the specified size.
Supports upscaling, downscaling and mixed variants.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">resize <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-dw WIDTH<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-dh HEIGHT<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-dw</code>, <code>--width</code> (int) - Destination image width</li>
<li><code>-dh</code>, <code>--height</code> (int) - Destination image height</li>
</ul>
<p>Examples:
Resize all images to 256x256 size</p>
<pre><code>datum transform -t resize -- -dw 256 -dh 256
</code></pre><p><a id="remove_images-transform"></a></p>
<h5 id="remove_images"><code>remove_images</code></h5>
<p>Removes specific dataset items by their ids.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">remove_images <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--id IDs<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>--id</code> (str) - Item id to remove. Id is &lsquo;<name>:<subset>&rsquo; pair (repeatable)</li>
</ul>
<p>Examples:</p>
<p>Remove specific images from the dataset</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t remove_images -- --id <span style="color:#4e9a06">&#39;image1:train&#39;</span> --id <span style="color:#4e9a06">&#39;image2:test&#39;</span>
</code></pre></div><p><a id="remove_annotations-transform"></a></p>
<h5 id="remove_annotations"><code>remove_annotations</code></h5>
<p>Allows to remove annotations on specific dataset items.</p>
<p>Can be useful to clean the dataset from broken or unnecessary annotations.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">remove_annotations <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--id IDs<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>--id</code> (str) - Item id to clean from annotations. Id is &lsquo;<name>:<subset>&rsquo; pair.
If not specified, removes all annotations (repeatable)</li>
</ul>
<p>Examples:
Remove annotations from specific items in the dataset</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t remove_annotations -- --id <span style="color:#4e9a06">&#39;image1:train&#39;</span> --id <span style="color:#4e9a06">&#39;image2:test&#39;</span>
</code></pre></div><p><a id="remove_attributes-transform"></a></p>
<h5 id="remove_attributes"><code>remove_attributes</code></h5>
<p>Allows to remove item and annotation attributes in a dataset.</p>
<p>Can be useful to clean the dataset from broken or unnecessary attributes.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">remove_attributes <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--id IDs<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--attr ATTRIBUTE_NAME<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>--id</code> (str) - Image id to clean from annotations. Id is &lsquo;<name>:<subset>&rsquo; pair.
If not specified, affects all items and annotations (repeatable)</li>
<li><code>-a</code>, <code>--attr</code> (flag) - Attribute name to be removed. If not specified,
removes all attributes (repeatable)</li>
</ul>
<p>Examples:
Remove the <code>is_crowd</code> attribute from dataset</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t remove_attributes -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --attr <span style="color:#4e9a06">&#39;is_crowd&#39;</span>
</code></pre></div><p>Remove the <code>occluded</code> attribute from annotations of
the <code>2010_001705</code> item in the <code>train</code> subset</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t remove_attributes -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --id <span style="color:#4e9a06">&#39;2010_001705:train&#39;</span> --attr <span style="color:#4e9a06">&#39;occluded&#39;</span>
</code></pre></div><p><a id="random_split-transform"></a></p>
<h5 id="random_split"><code>random_split</code></h5>
<p>Joins all subsets into one and splits the result into few parts.
It is expected that item ids are unique and subset ratios sum up to 1.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">random_split <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-s SPLITS<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--seed SEED<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-s</code>, <code>--subset</code> (str, repeatable) - Subsets in the form: &lsquo;<subset>:<ratio>&rsquo;
(repeatable, default: {<code>train</code>: 0.67, <code>test</code>: 0.33})</li>
<li><code>--seed</code> (int) - Random seed</li>
</ul>
<p>Example:
Split a dataset randomly to <code>train</code> and <code>test</code> subsets, ratio is 2:1</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t random_split -- --subset train:.67 --subset test:.33
</code></pre></div><p><a id="split-transform"></a></p>
<h5 id="split"><code>split</code></h5>
<p>Splits a dataset for model training, using task information:</p>
<ul>
<li>
<p>classification splits
Splits dataset into subsets (train/val/test) in class-wise manner.
Splits dataset images in the specified ratio, keeping the initial
class distribution.</p>
</li>
<li>
<p>detection &amp; segmentation splits
Each image can have multiple object annotations - bbox, mask, polygon.
Since an image shouldn&rsquo;t be included in multiple subsets at the same time,
and image annotations shouldn&rsquo;t be split, in general, dataset annotations are
unlikely to be split exactly in the specified ratio.
This split tries to split dataset images as close as possible to the specified
ratio, keeping the initial class distribution.</p>
</li>
<li>
<p>reidentification splits
In this task, the test set should consist of images of unseen people or
objects during the training phase.
This function splits a dataset in the following way:</p>
</li>
</ul>
<ol>
<li>Splits the dataset into <code>train + val</code> and <code>test</code> sets
based on person or object ID.</li>
<li>Splits <code>test</code> set into <code>test-gallery</code> and <code>test-query</code> sets
in class-wise manner.</li>
<li>Splits the <code>train + val</code> set into <code>train</code> and <code>val</code> sets
in the same way.
The final subsets would be <code>train</code>, <code>val</code>, <code>test-gallery</code> and <code>test-query</code>.</li>
</ol>
<p>Notes:</p>
<ul>
<li>Each image is expected to have only one <code>Annotation</code>. Unlabeled or
multi-labeled images will be split into subsets randomly.</li>
<li>If Labels also have attributes, also splits by attribute values.</li>
<li>If there is not enough images in some class or attributes group,
the split ratio can&rsquo;t be guaranteed.</li>
</ul>
<p>In reidentification task,</p>
<ul>
<li>Object ID can be described by Label, or by attribute (<code>--attr</code> parameter)</li>
<li>The splits of the test set are controlled by <code>--query</code> parameter
Gallery ratio would be <code>1.0 - query</code>.</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">split <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-t <span style="color:#ce5c00;font-weight:bold">{</span>classification,detection,segmentation,reid<span style="color:#ce5c00;font-weight:bold">}]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-s SPLITS<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--query QUERY<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--attr ATTR_FOR_ID<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--seed SEED<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-t</code>, <code>--task</code> (one of: <code>classification</code>, <code>detection</code>, <code>segmentation</code>,
<code>reid</code>) - Dataset task (default: <code>classification</code>)</li>
<li><code>-s</code>, <code>--subset</code> (str; repeatable) - Subsets in the form: &lsquo;<subset>:<ratio>&rsquo;
(default: {<code>train</code>: 0.5, <code>val</code>: 0.2, <code>test</code>: 0.3})</li>
<li><code>--query</code> (float) - Query ratio in the test set (default: 0.5)</li>
<li><code>--attr</code> (str) - Attribute name representing the ID (default: use label)</li>
<li><code>--seed</code>(int) - Random seed</li>
</ul>
<p>Example:</p>
<pre><code>datum transform -t split -- -t classification \
  --subset train:.5 --subset val:.2 --subset test:.3

datum transform -t split -- -t detection \
  --subset train:.5 --subset val:.2 --subset test:.3

datum transform -t split -- -t segmentation \
  --subset train:.5 --subset val:.2 --subset test:.3

datum transform -t split -- -t reid \
  --subset train:.5 --subset val:.2 --subset test:.3 --query .5
</code></pre><p>Example: use <code>person_id</code> attribute for splitting</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t split -- -t detection --attr person_id
</code></pre></div><p><a id="map_subsets-transform"></a></p>
<h5 id="map_subsets"><code>map_subsets</code></h5>
<p>Renames subsets in the dataset.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">map_subsets <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-s MAPPING<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-s</code>, <code>--subset</code> (str; repeatable) - Subset mapping of the form: <code>src:dst</code></li>
</ul>
<p><a id="remap_labels-transform"></a></p>
<h5 id="remap_labels"><code>remap_labels</code></h5>
<p>Changes labels in the dataset.</p>
<p>A label can be:</p>
<ul>
<li>renamed (and joined with existing) -
when <code>--label &lt;old_name&gt;:&lt;new_name&gt;</code> is specified</li>
<li>deleted - when <code>--label &lt;name&gt;:</code> is specified, or default action is <code>delete</code>
and the label is not mentioned in the list. When a label
is deleted, all the associated annotations are removed</li>
<li>kept unchanged - when <code>--label &lt;name&gt;:&lt;name&gt;</code> is specified,
or default action is <code>keep</code> and the label is not mentioned in the list
Annotations with no label are managed by the default action policy.</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">remap_labels <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-l MAPPING<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--default <span style="color:#ce5c00;font-weight:bold">{</span>keep,delete<span style="color:#ce5c00;font-weight:bold">}]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-l</code>, <code>--label</code> (str; repeatable) - Label in the form of: <code>&lt;src&gt;:&lt;dst&gt;</code></li>
<li><code>--default</code> (one of: <code>keep</code>, <code>delete</code>) - Action for unspecified labels
(default: <code>keep</code>)</li>
</ul>
<p>Examples:
Remove the <code>person</code> label (and corresponding annotations):</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t remap_labels -- -l person: --default keep
</code></pre></div><p>Rename <code>person</code> to <code>pedestrian</code> and <code>human</code> to <code>pedestrian</code>, join annotations
that had different classes under the same class id for <code>pedestrian</code>,
don&rsquo;t touch other classes:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t remap_labels -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -l person:pedestrian -l human:pedestrian --default keep
</code></pre></div><p>Rename <code>person</code> to <code>car</code> and <code>cat</code> to <code>dog</code>, keep <code>bus</code>, remove others:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t remap_labels -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -l person:car -l bus:bus -l cat:dog --default delete
</code></pre></div><p><a id="project_labels-transform"></a></p>
<h5 id="project_labels"><code>project_labels</code></h5>
<p>Changes the order of labels in the dataset from the existing
to the desired one, removes unknown labels and adds new labels.
Updates or removes the corresponding annotations.</p>
<p>Labels are matched by names (case dependent). Parent labels are
only kept if they are present in the resulting set of labels.
If new labels are added, and the dataset has mask colors defined,
new labels will obtain generated colors.</p>
<p>Useful for merging similar datasets, whose labels need to be aligned.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">project_labels <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-l DST_LABELS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-l</code>, <code>--label</code> (str; repeatable) - Label name (ordered)</li>
</ul>
<p>Examples:
Set dataset labels to [<code>person</code>, <code>cat</code>, <code>dog</code>], remove others, add missing.
Original labels (for example): <code>cat</code>, <code>dog</code>, <code>elephant</code>, <code>human</code>.
New labels: <code>person</code> (added), <code>cat</code> (kept), <code>dog</code> (kept).</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t project_labels -- -l person -l cat -l dog
</code></pre></div><p><a id="shapes_to_boxes-transform"></a></p>
<h5 id="shapes_to_boxes"><code>shapes_to_boxes</code></h5>
<p>Converts spatial annotations (masks, polygons, polylines, points)
to enclosing bounding boxes.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">shapes_to_boxes <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
</ul>
<p>Example:
Convert spatial annotations between each other</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t boxes_to_masks
datum transform -t masks_to_polygons
datum transform -t polygons_to_masks
datum transform -t shapes_to_boxes
</code></pre></div><p><a id="boxes_to_masks-transform"></a></p>
<h5 id="boxes_to_masks"><code>boxes_to_masks</code></h5>
<p>Converts bounding boxes to masks.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">boxes_to_masks <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
</ul>
<p><a id="polygons_to_masks-transform"></a></p>
<h5 id="polygons_to_masks"><code>polygons_to_masks</code></h5>
<p>Converts polygons to masks.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">polygons_to_masks <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
</ul>
<p><a id="masks_to_polygons-transform"></a></p>
<h5 id="masks_to_polygons"><code>masks_to_polygons</code></h5>
<p>Converts masks to polygons.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">masks_to_polygons <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
</ul>
<p><a id="anns_to_labels-transform"></a></p>
<h5 id="anns_to_labels"><code>anns_to_labels</code></h5>
<p>Collects all labels from annotations (of all types) and transforms
them into a set of annotations of type <code>Label</code></p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">anns_to_labels <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
</ul>
<p><a id="merge_instance_segments-transform"></a></p>
<h5 id="merge_instance_segments"><code>merge_instance_segments</code></h5>
<p>Replaces instance masks and, optionally, polygons with a single mask.
A group of annotations with the same group id is considered an &ldquo;instance&rdquo;.
The largest annotation in the group is considered the group &ldquo;head&rdquo;, so the
resulting mask takes properties from that annotation.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">merge_instance_segments <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--include-polygons<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>--include-polygons</code> (flag) - Include polygons</li>
</ul>
<p><a id="crop_covered_segments-transform"></a></p>
<h5 id="crop_covered_segments"><code>crop_covered_segments</code></h5>
<p>Sorts polygons and masks (&ldquo;segments&rdquo;) according to <code>z_order</code>,
crops covered areas of underlying segments. If a segment is split
into several independent parts by the segments above, produces
the corresponding number of separate annotations joined into a group.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">crop_covered_segments <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
</ul>
<p><a id="bbox_value_decrement-transform"></a></p>
<h5 id="bbox_value_decrement"><code>bbox_value_decrement</code></h5>
<p>Subtracts one from the coordinates of bounding boxes</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bbox_values_decrement <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-10150a1a6326aa9e8f2020442e6da77d">4.4.24 - Utilities</h1>
    
	<p><a id="split-video"></a></p>
<h3 id="split-video-into-frames">Split video into frames</h3>
<p>Splits a video into separate frames and saves them in a directory.
After the splitting, the images can be added into a project using
the <a href="../sources/#source-import"><code>import</code> command</a> and the <code>image_dir</code> format.</p>
<p>This command is useful for making a dataset from a video file.
Unlike direct video reading during model training, which can produce
different results if the system environment changes, this command
allows to split the video into frames and use them instead, making
the dataset reproducible and stable.</p>
<p>This command provides different options like setting the frame step
(the <code>-s/--step</code> option), file name pattern (<code>-n/--name-pattern</code>),
starting (<code>-b/--start-frame</code>) and finishing (<code>-e/--end-frame</code>) frame etc.</p>
<p>Note that this command is equivalent to the following commands:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o proj
datum import -p proj -f video_frames video.mp4 -- &lt;params&gt;
datum <span style="color:#204a87">export</span> -p proj -f image_dir -- &lt;params&gt;
</code></pre></div><p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum util split_video <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -i SRC_PATH <span style="color:#ce5c00;font-weight:bold">[</span>-o DST_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-n NAME_PATTERN<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-s STEP<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-b START_FRAME<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-e END_FRAME<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-x IMAGE_EXT<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>-i, --input-path</code> (string) - Path to the video file</li>
<li><code>-o, --output-dir</code> (string) - Output directory. By default, a subdirectory
in the current directory is used</li>
<li><code>--overwrite</code> - Allows overwriting existing files in the output directory,
when it is not empty</li>
<li><code>-n, --name-pattern</code> (string) - Name pattern for the produced
images (default: <code>%06d</code>)</li>
<li><code>-s, --step</code> (integer) - Frame step (default: 1)</li>
<li><code>-b, --start-frame</code> (integer) - Starting frame (default: 0)</li>
<li><code>-e, --end-frame</code> (integer) - Finishing frame (default: none)</li>
<li><code>-x, --image-ext</code> (string) Output image extension (default: <code>.jpg</code>)</li>
<li><code>-h, --help</code> - Print the help message and exit</li>
</ul>
<p>Example: split a video into frames, use each 30-rd frame:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum util split_video -i video.mp4 -o video.mp4-frames --step <span style="color:#0000cf;font-weight:bold">30</span>
</code></pre></div><p>Example: split a video into frames, save as &lsquo;frame_xxxxxx.png&rsquo; files:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum util split_video -i video.mp4 --image-ext<span style="color:#ce5c00;font-weight:bold">=</span>.png --name-pattern<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;frame_%%06d&#39;</span>
</code></pre></div><p>Example: split a video, add frames and annotations into dataset, export as YOLO:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum util split_video -i video.avi -o video-frames
datum create -o proj
datum import -p proj -f image_dir video-frames
datum import -p proj -f coco_instances annotations.json
datum <span style="color:#204a87">export</span> -p proj -f yolo -- --save-images
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a6fd93528e84d29a5a0d58dbccb92724">4.4.25 - Validate Dataset</h1>
    
	<p>This command inspects annotations with respect to the task type
and stores the results in JSON file.</p>
<p>The task types supported are <code>classification</code>, <code>detection</code>, and
<code>segmentation</code> (the <code>-t/--task-type</code> parameter).</p>
<p>The validation result contains</p>
<ul>
<li><code>annotation statistics</code> based on the task type</li>
<li><code>validation reports</code>, such as
<ul>
<li>items not having annotations</li>
<li>items having undefined annotations</li>
<li>imbalanced distribution in class/attributes</li>
<li>too small or large values</li>
</ul>
</li>
<li><code>summary</code></li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum validate <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -t TASK <span style="color:#ce5c00;font-weight:bold">[</span>-s SUBSET_NAME<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>target<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-- EXTRA_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;target&gt;</code> (string) - Target
<a href="../../docs/user-manual/how_to_use_datumaro/#revpath">dataset revpath</a>.
By default, validates the current project.</li>
<li><code>-t, --task-type</code> (string) - Task type for validation</li>
<li><code>-s, --subset</code> (string) - Dataset subset to be validated</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
<li><code>&lt;extra args&gt;</code> - The list of extra validation parameters. Should be passed
after the <code>--</code> separator after the main command arguments:
<ul>
<li><code>-fs, --few-samples-thr</code> (number) - The threshold for giving a warning
for minimum number of samples per class</li>
<li><code>-ir, --imbalance-ratio-thr</code> (number) - The threshold for giving
imbalance data warning</li>
<li><code>-m, --far-from-mean-thr</code> (number) - The threshold for giving
a warning that data is far from mean</li>
<li><code>-dr, --dominance-ratio-thr</code> (number) - The threshold for giving
a warning bounding box imbalance</li>
<li><code>-k, --topk-bins</code> (number) - The ratio of bins with the highest
number of data to total bins in the histogram</li>
</ul>
</li>
</ul>
<p>Example : give warning when imbalance ratio of data with classification task
over 40</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum validate -p prj/ -t classification -- -ir <span style="color:#0000cf;font-weight:bold">40</span>
</code></pre></div><p>Here is the list of validation items(a.k.a. anomaly types).</p>
<table>
<thead>
<tr>
<th>Anomaly Type</th>
<th>Description</th>
<th>Task Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>MissingLabelCategories</td>
<td>Metadata (ex. LabelCategories) should be defined</td>
<td>common</td>
</tr>
<tr>
<td>MissingAnnotation</td>
<td>No annotation found for an Item</td>
<td>common</td>
</tr>
<tr>
<td>MissingAttribute</td>
<td>An attribute key is missing for an Item</td>
<td>common</td>
</tr>
<tr>
<td>MultiLabelAnnotations</td>
<td>Item needs a single label</td>
<td>classification</td>
</tr>
<tr>
<td>UndefinedLabel</td>
<td>A label not defined in the metadata is found for an item</td>
<td>common</td>
</tr>
<tr>
<td>UndefinedAttribute</td>
<td>An attribute not defined in the metadata is found for an item</td>
<td>common</td>
</tr>
<tr>
<td>LabelDefinedButNotFound</td>
<td>A label is defined, but not found actually</td>
<td>common</td>
</tr>
<tr>
<td>AttributeDefinedButNotFound</td>
<td>An attribute is defined, but not found actually</td>
<td>common</td>
</tr>
<tr>
<td>OnlyOneLabel</td>
<td>The dataset consists of only label</td>
<td>common</td>
</tr>
<tr>
<td>OnlyOneAttributeValue</td>
<td>The dataset consists of only attribute value</td>
<td>common</td>
</tr>
<tr>
<td>FewSamplesInLabel</td>
<td>The number of samples in a label might be too low</td>
<td>common</td>
</tr>
<tr>
<td>FewSamplesInAttribute</td>
<td>The number of samples in an attribute might be too low</td>
<td>common</td>
</tr>
<tr>
<td>ImbalancedLabels</td>
<td>There is an imbalance in the label distribution</td>
<td>common</td>
</tr>
<tr>
<td>ImbalancedAttribute</td>
<td>There is an imbalance in the attribute distribution</td>
<td>common</td>
</tr>
<tr>
<td>ImbalancedDistInLabel</td>
<td>Values (ex. bbox width) are not evenly distributed for a label</td>
<td>detection, segmentation</td>
</tr>
<tr>
<td>ImbalancedDistInAttribute</td>
<td>Values (ex. bbox width) are not evenly distributed for an attribute</td>
<td>detection, segmentation</td>
</tr>
<tr>
<td>NegativeLength</td>
<td>The width or height of bounding box is negative</td>
<td>detection</td>
</tr>
<tr>
<td>InvalidValue</td>
<td>There&rsquo;s invalid (ex. inf, nan) value for bounding box info.</td>
<td>detection</td>
</tr>
<tr>
<td>FarFromLabelMean</td>
<td>An annotation has an too small or large value than average for a label</td>
<td>detection, segmentation</td>
</tr>
<tr>
<td>FarFromAttrMean</td>
<td>An annotation has an too small or large value than average for an attribute</td>
<td>detection, segmentation</td>
</tr>
</tbody>
</table>
<p>Validation Result Format:</p>
<details>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ce5c00;font-weight:bold">{</span>
    <span style="color:#4e9a06">&#39;statistics&#39;</span>: <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#8f5902;font-style:italic">## common statistics</span>
        <span style="color:#4e9a06">&#39;label_distribution&#39;</span>: <span style="color:#ce5c00;font-weight:bold">{</span>
            <span style="color:#4e9a06">&#39;defined_labels&#39;</span>: &lt;dict&gt;,   <span style="color:#8f5902;font-style:italic"># &lt;label:str&gt;: &lt;count:int&gt;</span>
            <span style="color:#4e9a06">&#39;undefined_labels&#39;</span>: &lt;dict&gt;
            <span style="color:#8f5902;font-style:italic"># &lt;label:str&gt;: {</span>
            <span style="color:#8f5902;font-style:italic">#     &#39;count&#39;: &lt;int&gt;,</span>
            <span style="color:#8f5902;font-style:italic">#     &#39;items_with_undefined_label&#39;: [&lt;item_key&gt;, ]</span>
            <span style="color:#8f5902;font-style:italic"># }</span>
        <span style="color:#ce5c00;font-weight:bold">}</span>,
        <span style="color:#4e9a06">&#39;attribute_distribution&#39;</span>: <span style="color:#ce5c00;font-weight:bold">{</span>
            <span style="color:#4e9a06">&#39;defined_attributes&#39;</span>: &lt;dict&gt;,
            <span style="color:#8f5902;font-style:italic"># &lt;label:str&gt;: {</span>
            <span style="color:#8f5902;font-style:italic">#     &lt;attribute:str&gt;: {</span>
            <span style="color:#8f5902;font-style:italic">#         &#39;distribution&#39;: {&lt;attr_value:str&gt;: &lt;count:int&gt;, },</span>
            <span style="color:#8f5902;font-style:italic">#         &#39;items_missing_attribute&#39;: [&lt;item_key&gt;, ]</span>
            <span style="color:#8f5902;font-style:italic">#     }</span>
            <span style="color:#8f5902;font-style:italic"># }</span>
            <span style="color:#4e9a06">&#39;undefined_attributes&#39;</span>: &lt;dict&gt;
            <span style="color:#8f5902;font-style:italic"># &lt;label:str&gt;: {</span>
            <span style="color:#8f5902;font-style:italic">#     &lt;attribute:str&gt;: {</span>
            <span style="color:#8f5902;font-style:italic">#         &#39;distribution&#39;: {&lt;attr_value:str&gt;: &lt;count:int&gt;, },</span>
            <span style="color:#8f5902;font-style:italic">#         &#39;items_with_undefined_attr&#39;: [&lt;item_key&gt;, ]</span>
            <span style="color:#8f5902;font-style:italic">#     }</span>
            <span style="color:#8f5902;font-style:italic"># }</span>
        <span style="color:#ce5c00;font-weight:bold">}</span>,
        <span style="color:#4e9a06">&#39;total_ann_count&#39;</span>: &lt;int&gt;,
        <span style="color:#4e9a06">&#39;items_missing_annotation&#39;</span>: &lt;list&gt;, <span style="color:#8f5902;font-style:italic"># [&lt;item_key&gt;, ]</span>

        <span style="color:#8f5902;font-style:italic">## statistics for classification task</span>
        <span style="color:#4e9a06">&#39;items_with_multiple_labels&#39;</span>: &lt;list&gt;, <span style="color:#8f5902;font-style:italic"># [&lt;item_key&gt;, ]</span>

        <span style="color:#8f5902;font-style:italic">## statistics for detection task</span>
        <span style="color:#4e9a06">&#39;items_with_invalid_value&#39;</span>: &lt;dict&gt;,
        <span style="color:#8f5902;font-style:italic"># &#39;&lt;item_key&gt;&#39;: {&lt;ann_id:int&gt;: [ &lt;property:str&gt;, ], }</span>
        <span style="color:#8f5902;font-style:italic"># - properties: &#39;x&#39;, &#39;y&#39;, &#39;width&#39;, &#39;height&#39;,</span>
        <span style="color:#8f5902;font-style:italic">#               &#39;area(wxh)&#39;, &#39;ratio(w/h)&#39;, &#39;short&#39;, &#39;long&#39;</span>
        <span style="color:#8f5902;font-style:italic"># - &#39;short&#39; is min(w,h) and &#39;long&#39; is max(w,h).</span>
        <span style="color:#4e9a06">&#39;items_with_negative_length&#39;</span>: &lt;dict&gt;,
        <span style="color:#8f5902;font-style:italic"># &#39;&lt;item_key&gt;&#39;: { &lt;ann_id:int&gt;: { &lt;&#39;width&#39;|&#39;height&#39;&gt;: &lt;value&gt;, }, }</span>
        <span style="color:#4e9a06">&#39;bbox_distribution_in_label&#39;</span>: &lt;dict&gt;, <span style="color:#8f5902;font-style:italic"># &lt;label:str&gt;: &lt;bbox_template&gt;</span>
        <span style="color:#4e9a06">&#39;bbox_distribution_in_attribute&#39;</span>: &lt;dict&gt;,
        <span style="color:#8f5902;font-style:italic"># &lt;label:str&gt;: {&lt;attribute:str&gt;: { &lt;attr_value&gt;: &lt;bbox_template&gt;, }, }</span>
        <span style="color:#4e9a06">&#39;bbox_distribution_in_dataset_item&#39;</span>: &lt;dict&gt;,
        <span style="color:#8f5902;font-style:italic"># &#39;&lt;item_key&gt;&#39;: &lt;bbox count:int&gt;</span>

        <span style="color:#8f5902;font-style:italic">## statistics for segmentation task</span>
        <span style="color:#4e9a06">&#39;items_with_invalid_value&#39;</span>: &lt;dict&gt;,
        <span style="color:#8f5902;font-style:italic"># &#39;&lt;item_key&gt;&#39;: {&lt;ann_id:int&gt;: [ &lt;property:str&gt;, ], }</span>
        <span style="color:#8f5902;font-style:italic"># - properties: &#39;area&#39;, &#39;width&#39;, &#39;height&#39;</span>
        <span style="color:#4e9a06">&#39;mask_distribution_in_label&#39;</span>: &lt;dict&gt;, <span style="color:#8f5902;font-style:italic"># &lt;label:str&gt;: &lt;mask_template&gt;</span>
        <span style="color:#4e9a06">&#39;mask_distribution_in_attribute&#39;</span>: &lt;dict&gt;,
        <span style="color:#8f5902;font-style:italic"># &lt;label:str&gt;: {</span>
        <span style="color:#8f5902;font-style:italic">#     &lt;attribute:str&gt;: { &lt;attr_value&gt;: &lt;mask_template&gt;, }</span>
        <span style="color:#8f5902;font-style:italic"># }</span>
        <span style="color:#4e9a06">&#39;mask_distribution_in_dataset_item&#39;</span>: &lt;dict&gt;,
        <span style="color:#8f5902;font-style:italic"># &#39;&lt;item_key&gt;&#39;: &lt;mask/polygon count: int&gt;</span>
    <span style="color:#ce5c00;font-weight:bold">}</span>,
    <span style="color:#4e9a06">&#39;validation_reports&#39;</span>: &lt;list&gt;, <span style="color:#8f5902;font-style:italic"># [ &lt;validation_error_format&gt;, ]</span>
    <span style="color:#8f5902;font-style:italic"># validation_error_format = {</span>
    <span style="color:#8f5902;font-style:italic">#     &#39;anomaly_type&#39;: &lt;str&gt;,</span>
    <span style="color:#8f5902;font-style:italic">#     &#39;description&#39;: &lt;str&gt;,</span>
    <span style="color:#8f5902;font-style:italic">#     &#39;severity&#39;: &lt;str&gt;, # &#39;warning&#39; or &#39;error&#39;</span>
    <span style="color:#8f5902;font-style:italic">#     &#39;item_id&#39;: &lt;str&gt;,  # optional, when it is related to a DatasetItem</span>
    <span style="color:#8f5902;font-style:italic">#     &#39;subset&#39;: &lt;str&gt;,   # optional, when it is related to a DatasetItem</span>
    <span style="color:#8f5902;font-style:italic"># }</span>
    <span style="color:#4e9a06">&#39;summary&#39;</span>: <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#4e9a06">&#39;errors&#39;</span>: &lt;count: int&gt;,
        <span style="color:#4e9a06">&#39;warnings&#39;</span>: &lt;count: int&gt;
    <span style="color:#ce5c00;font-weight:bold">}</span>
<span style="color:#ce5c00;font-weight:bold">}</span>

</code></pre></div><p><code>item_key</code> is defined as,</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">item_key</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">DatasetItem</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">:</span><span style="color:#204a87">str</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">DatasetItem</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">subset</span><span style="color:#000;font-weight:bold">:</span><span style="color:#204a87">str</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p><code>bbox_template</code> and <code>mask_template</code> are defined as,</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">bbox_template</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#4e9a06">&#39;width&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">numerical_stat_template</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;height&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">numerical_stat_template</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;area(wxh)&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">numerical_stat_template</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;ratio(w/h)&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">numerical_stat_template</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;short&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">numerical_stat_template</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic"># short = min(w, h)</span>
    <span style="color:#4e9a06">&#39;long&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">numerical_stat_template</span><span style="color:#ce5c00;font-weight:bold">&gt;</span>   <span style="color:#8f5902;font-style:italic"># long = max(w, h)</span>
<span style="color:#000;font-weight:bold">}</span>
<span style="color:#000">mask_template</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#4e9a06">&#39;area&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">numerical_stat_template</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;width&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">numerical_stat_template</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;height&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">numerical_stat_template</span><span style="color:#ce5c00;font-weight:bold">&gt;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><code>numerical_stat_template</code> is defined as,</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">numerical_stat_template</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#4e9a06">&#39;items_far_from_mean&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87">dict</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#8f5902;font-style:italic"># {&#39;&lt;item_key&gt;&#39;: {&lt;ann_id:int&gt;: &lt;value:float&gt;, }, }</span>
    <span style="color:#4e9a06">&#39;mean&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87">float</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;stddev&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87">float</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;min&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87">float</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;max&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87">float</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;median&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87">float</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;histogram&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#4e9a06">&#39;bins&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87">list</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>   <span style="color:#8f5902;font-style:italic"># [&lt;float&gt;, ]</span>
        <span style="color:#4e9a06">&#39;counts&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87">list</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic"># [&lt;int&gt;, ]</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div></details>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-5425ff20f66ad27cecd1cec97424d239">4.5 - Extending</h1>
    
	<p>There are few ways to extend and customize Datumaro behavior, which is
supported by plugins. Check <a href="../../docs/contributing">our contribution guide</a> for
details on plugin implementation. In general, a plugin is a Python module.
It must be put into a plugin directory:</p>
<ul>
<li><code>&lt;project_dir&gt;/.datumaro/plugins</code> for project-specific plugins</li>
<li><code>&lt;datumaro_dir&gt;/plugins</code> for global plugins</li>
</ul>
<p><a id="builtin-plugins"></a></p>
<h3 id="built-in-plugins">Built-in plugins</h3>
<p>Datumaro provides several builtin plugins. Plugins can have dependencies,
which need to be installed separately.</p>
<h4 id="tensorflow">TensorFlow</h4>
<p>The plugin provides support of TensorFlow Detection API format, which includes
boxes and masks.</p>
<p><strong>Dependencies</strong></p>
<p>The plugin depends on TensorFlow, which can be installed with <code>pip</code>:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pip install tensorflow
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pip install tensorflow-gpu
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pip install datumaro<span style="color:#ce5c00;font-weight:bold">[</span>tf<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pip install datumaro<span style="color:#ce5c00;font-weight:bold">[</span>tf-gpu<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><h4 id="accuracy-checker">Accuracy Checker</h4>
<p>This plugin allows to use <a href="https://github.com/openvinotoolkit/open_model_zoo/tree/master/tools/accuracy_checker">Accuracy Checker</a>
to launch deep learning models from various frameworks
(Caffe, MxNet, PyTorch, OpenVINO, &hellip;) through Accuracy Checker&rsquo;s API.</p>
<p><strong>Dependencies</strong></p>
<p>The plugin depends on Accuracy Checker, which can be installed with <code>pip</code>:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pip install <span style="color:#4e9a06">&#39;git+https://github.com/openvinotoolkit/open_model_zoo.git#subdirectory=tools/accuracy_checker&#39;</span>
</code></pre></div><p>To execute models with deep learning frameworks, they need to be installed too.</p>
<h4 id="openvino">OpenVINO™</h4>
<p>This plugin provides support for model inference with <a href="https://01.org/openvinotoolkit">OpenVINO™</a>.</p>
<p><strong>Dependencies</strong></p>
<p>The plugin depends on the OpenVINO™ Toolkit, which can be installed by
following <a href="https://docs.openvinotoolkit.org/latest/index.html#packaging_and_deployment">these instructions</a></p>
<h3 id="dataset-formats">Dataset Formats</h3>
<p>Dataset reading is supported by Extractors and Importers.
An Extractor produces a list of dataset items corresponding
to the dataset. An Importer creates a project from the data source location.
It is possible to add custom Extractors and Importers. To do this, you need
to put an Extractor and Importer implementation scripts to a plugin directory.</p>
<p>Dataset writing is supported by Converters.
A Converter produces a dataset of a specific format from dataset items.
It is possible to add custom Converters. To do this, you need to put a Converter
implementation script to a plugin directory.</p>
<h3 id="dataset-conversions-transforms">Dataset Conversions (&ldquo;Transforms&rdquo;)</h3>
<p>A Transform is a function for altering a dataset and producing a new one.
It can update dataset items, annotations, classes, and other properties.
A list of available transforms for dataset conversions can be extended by
adding a Transform implementation script into a plugin directory.</p>
<h3 id="model-launchers">Model launchers</h3>
<p>A list of available launchers for model execution can be extended by adding
a Launcher implementation script into a plugin directory.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-769eb55c675e353516911aa676486a8c">4.6 - Links</h1>
    
	<ul>
<li><a href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf2_detection_zoo.md">TensorFlow detection model zoo</a></li>
<li><a href="https://docs.openvinotoolkit.org/latest/_docs_MO_DG_prepare_model_convert_model_tf_specific_Convert_Object_Detection_API_Models.html">How to convert model to OpenVINO™ format</a></li>
<li><a href="https://github.com/openvinotoolkit/cvat/blob/3e09503ba6c6daa6469a6c4d275a5a8b168dfa2c/components/tf_annotation/install.sh#L23">Model conversion script example</a></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f6582e1039317c10889db7a3a9231d9f">4.7 - How to control telemetry data collection</h1>
    
	<p>The <a href="https://github.com/openvinotoolkit/telemetry/">OpenVINO™ telemetry library</a>
is used to collect basic information about Datumaro usage.</p>
<p>A short description of the information collected:</p>
<table>
<thead>
<tr>
<th>Event</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>version</td>
<td>Datumaro version</td>
</tr>
<tr>
<td>session start/end</td>
<td>Accessory event, there is no additional info here</td>
</tr>
<tr>
<td>{cli_command}_result</td>
<td>Datumaro command result with arguments passed*</td>
</tr>
<tr>
<td>error</td>
<td>Stack trace in case of exception*</td>
</tr>
</tbody>
</table>
<blockquote>
<p>* All sensitive arguments, such as filesystem paths or names, are sanitized</p>
</blockquote>
<p>To enable the collection of telemetry data, the ISIP consent file
must exist and contain <code>1</code>, otherwise telemetry will be disabled.
The ISIP file can be created/modified by an OpenVINO installer
or manually and used by other OpenVINO™ tools.</p>
<p>The location of the ISIP consent file depends on the OS:</p>
<ul>
<li>Windows: <code>%localappdata%\Intel Corporation\isip</code>,</li>
<li>Linux, MacOS: <code>$HOME/intel/isip</code>.</li>
</ul>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c4f3b7b6687248fa052de696ab2cf167">5 - Formats</h1>
    <div class="lead">List of dataset formats supported by Datumaro</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-7b335946c4e1c1cd7917e256f9ed089a">5.1 - NYU Depth Dataset V2</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>The original NYU Depth Dataset V2 is available
<a href="https://cs.nyu.edu/~silberman/datasets/nyu_depth_v2.html">here</a>.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>DepthAnnotation</code></li>
</ul>
<h2 id="import-nyu-depth-dataset-v2">Import NYU Depth Dataset V2</h2>
<p>The NYU Depth Dataset V2 is available for free <a href="http://datasets.lids.mit.edu/nyudepthv2/">download</a>.</p>
<p>A Datumaro project with a NYU Depth Dataset V2 source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format nyu_depth_v2 &lt;path/to/dataset&gt;
</code></pre></div><p>It is also possible to import the dataset using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;nyu_depth_v2&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>NYU Depth Dataset V2 directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>Dataset/
    ├── 1.h5
    ├── 2.h5
    ├── 3.h5
    └── ...
</code></pre><p>To make sure that the selected dataset has been added to the project, you can
run <code>datum project info</code>, which will display the project information.</p>
<h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/test_nyu_depth_v2_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-1646a51944fb0a27e86b592702a3eda8">5.2 - ADE20k (v2017)</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>The original ADE20K 2017 dataset is available
<a href="https://www.kaggle.com/soumikrakshit/ade20k">here</a>.</p>
<p>The consistency set (for checking the annotation consistency)
is available <a href="https://groups.csail.mit.edu/vision/datasets/ADE20K/ADE20K_2017_05_30_consistency.zip">here</a>.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Masks</code></li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li><code>occluded</code> (boolean): whether the object is occluded by another object</li>
<li>other arbitrary boolean attributes, which can be specified
in the annotation file <code>&lt;image_name&gt;_atr.txt</code></li>
</ul>
<h2 id="import-ade20k-2017-dataset">Import ADE20K 2017 dataset</h2>
<p>A Datumaro project with an ADE20k source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format ade20k2017 &lt;path/to/dataset&gt;
</code></pre></div><p>It is also possible to import the dataset using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">ade20k_dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;ade20k2017&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>ADE20K dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>dataset/
├── dataset_meta.json # a list of non-format labels (optional)
├── subset1/
│   └── super_label_1/
│       ├── img1.jpg
│       ├── img1_atr.txt
│       ├── img1_parts_1.png
│       ├── img1_seg.png
│       ├── img2.jpg
│       ├── img2_atr.txt
│       └── ...
└── subset2/
    ├── img3.jpg
    ├── img3_atr.txt
    ├── img3_parts_1.png
    ├── img3_parts_2.png
    ├── img4.jpg
    ├── img4_atr.txt
    ├── img4_seg.png
    └── ...
</code></pre><p>The mask images <code>&lt;image_name&gt;_seg.png</code> contain information about the object
class segmentation masks and also separate each class into instances.
The channels R and G encode the objects class masks.
The channel B encodes the instance object masks.</p>
<p>The mask images <code>&lt;image_name&gt;_parts_N.png</code> contain segmentation masks for parts
of objects, where N is a number indicating the level in the part hierarchy.</p>
<p>The annotation files <code>&lt;image_name&gt;_atr.txt</code> describe the content of each
image. Each line in the text file contains:</p>
<ul>
<li>column 1: instance number,</li>
<li>column 2: part level (0 for objects),</li>
<li>column 3: occluded (1 for true),</li>
<li>column 4: original raw name (might provide a more detailed categorization),</li>
<li>column 5: class name (parsed using wordnet),</li>
<li>column 6: double-quoted list of attributes, separated by commas.
Each column is separated by a <code>#</code>. See example of dataset
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/ade20k2017_dataset">here</a>.</li>
</ul>
<p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert an ADE20K dataset into any other format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to a format
that supports segmentation masks.</p>
<p>There are several ways to convert an ADE20k 2017 dataset to other dataset
formats using CLI:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f ade20k2017 &lt;path/to/dataset&gt;
datum <span style="color:#204a87">export</span> -f coco -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if ade20k2017 -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f coco -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;ade202017&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;coco&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/test_ade20k2017_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-22c9ec5acd736f4b76466752445697c5">5.3 - ADE20k (v2020)</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>The original ADE20K 2020 dataset is available
<a href="https://groups.csail.mit.edu/vision/datasets/ADE20K/">here</a>.</p>
<p>The consistency set (for checking the annotation consistency)
is available <a href="https://groups.csail.mit.edu/vision/datasets/ADE20K/ADE20K_2017_05_30_consistency.zip">here</a>.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Masks</code></li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li><code>occluded</code> (boolean): whether the object is occluded by another object</li>
<li>other arbitrary boolean attributes, which can be specified
in the annotation file <code>&lt;image_name&gt;.json</code></li>
</ul>
<h2 id="import-ade20k-dataset">Import ADE20K dataset</h2>
<p>A Datumaro project with an ADE20k source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format ade20k2020 &lt;path/to/dataset&gt;
</code></pre></div><p>It is also possible to import the dataset using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">ade20k_dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;ade20k2020&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>ADE20K dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>dataset/
├── dataset_meta.json # a list of non-format labels (optional)
├── subset1/
│   ├── img1/  # directory with instance masks for img1
│   |    ├── instance_001_img1.png
│   |    ├── instance_002_img1.png
│   |    └── ...
│   ├── img1.jpg
│   ├── img1.json
│   ├── img1_seg.png
│   ├── img1_parts_1.png
│   |
│   ├── img2/  # directory with instance masks for img2
│   |    ├── instance_001_img2.png
│   |    ├── instance_002_img2.png
│   |    └── ...
│   ├── img2.jpg
│   ├── img2.json
│   └── ...
│
└── subset2/
    ├── super_label_1/
    |   ├── img3/  # directory with instance masks for img3
    |   |    ├── instance_001_img3.png
    |   |    ├── instance_002_img3.png
    |   |    └── ...
    |   ├── img3.jpg
    |   ├── img3.json
    |   ├── img3_seg.png
    |   ├── img3_parts_1.png
    |   └── ...
    |
    ├── img4/  # directory with instance masks for img4
    |   ├── instance_001_img4.png
    |   ├── instance_002_img4.png
    |   └── ...
    ├── img4.jpg
    ├── img4.json
    ├── img4_seg.png
    └── ...
</code></pre><p>The mask images <code>&lt;image_name&gt;_seg.png</code> contain information about the object
class segmentation masks and also separate each class into instances.
The channels R and G encode the objects class masks.
The channel B encodes the instance object masks.</p>
<p>The mask images <code>&lt;image_name&gt;_parts_N.png</code> contain segmentation masks for
parts of objects, where N is a number indicating the level in the part
hierarchy.</p>
<p>The <code>&lt;image_name&gt;</code> directory contains instance masks for each
object in the image, these masks represent one-channel images,
each pixel of which indicates an affinity to a specific object.</p>
<p>The annotation files <code>&lt;image_name&gt;.json</code> describe the content of each image.
See our <a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/ade20k2020_dataset">tests asset</a>
for example of this file,
or check <a href="https://github.com/CSAILVision/ADE20K">ADE20K toolkit</a> for it.</p>
<p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert an ADE20K dataset into any other format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to a format
that supports segmentation masks.</p>
<p>There are several ways to convert an ADE20k dataset to other dataset
formats using CLI:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f ade20k2020 &lt;path/to/dataset&gt;
datum <span style="color:#204a87">export</span> -f coco -o ./save_dir -- --save-media
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if ade20k2020 -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f coco -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;ade20k2020&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/test_ade20k2020_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f20c26628d349ff890dd5cd005e9f851">5.4 - Align CelebA</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>The original CelebA dataset is available
<a href="https://mmlab.ie.cuhk.edu.hk/projects/CelebA.html">here</a>.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Label</code></li>
<li><code>Points</code> (landmarks)</li>
</ul>
<p>Supported attributes:</p>
<ul>
<li><code>5_o_Clock_Shadow</code>, <code>Arched_Eyebrows</code>, <code>Attractive</code>,
<code>Bags_Under_Eyes</code>, <code>Bald</code>, <code>Bangs</code>, <code>Big_Lips</code>, <code>Big_Nose</code>, <code>Black_Hair</code>,
<code>Blond_Hair</code>, <code>Blurry</code>, <code>Brown_Hair</code>, <code>Bushy_Eyebrows</code>, <code>Chubby</code>,
<code>Double_Chin</code>, <code>Eyeglasses</code>, <code>Goatee</code>, <code>Gray_Hair</code>, <code>Heavy_Makeup</code>,
<code>High_Cheekbones</code>, <code>Male</code>, <code>Mouth_Slightly_Open</code>, <code>Mustache</code>, <code>Narrow_Eyes</code>,
<code>No_Beard</code>, <code>Oval_Face</code>, <code>Pale_Skin</code>, <code>Pointy_Nose</code>, <code>Receding_Hairline</code>,
<code>Rosy_Cheeks</code>, <code>Sideburns</code>, <code>Smiling</code>, <code>Straight_Hair</code>, <code>Wavy_Hair</code>,
<code>Wearing_Earrings</code>, <code>Wearing_Hat</code>, <code>Wearing_Lipstick</code>, <code>Wearing_Necklace</code>,
<code>Wearing_Necktie</code>, <code>Young</code> (boolean)</li>
</ul>
<h2 id="import-align-celeba-dataset">Import align CelebA dataset</h2>
<p>A Datumaro project with an align CelebA source can be created
in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format align_celeba &lt;path/to/dataset&gt;
</code></pre></div><p>It is also possible to import the dataset using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">align_celeba_dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;align_celeba&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>Align CelebA dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>dataset/
├── dataset_meta.json # a list of non-format labels (optional)
├── Anno/
│   ├── identity_CelebA.txt
│   ├── list_attr_celeba.txt
│   └── list_landmarks_align_celeba.txt
├── Eval/
│   └── list_eval_partition.txt
└── Img/
    └── img_align_celeba/
        ├── 000001.jpg
        ├── 000002.jpg
        └── ...
</code></pre><p>The <code>identity_CelebA.txt</code> file contains labels (required).
The <code>list_attr_celeba.txt</code>, <code>list_landmarks_align_celeba.txt</code>,
<code>list_eval_partition.txt</code> files contain attributes, bounding boxes,
landmarks and subsets respectively (optional).</p>
<p>The original CelebA dataset stores images in a .7z archive. The archive
needs to be unpacked before importing.</p>
<p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert an align CelebA dataset into any other format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to a format
that supports labels or landmarks.</p>
<p>There are several ways to convert an align CelebA dataset to other dataset
formats using CLI:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f align_celeba &lt;path/to/dataset&gt;
datum <span style="color:#204a87">export</span> -f imagenet_txt -o ./save_dir -- --save-media
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if align_celeba -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f imagenet_txt -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;align_celeba&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/test_align_celeba_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-9c8aae20b55b28eeccea7db9dc9d165f">5.5 - AVA action</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>The AVA action format specification is available
<a href="https://arxiv.org/pdf/1705.08421.pdf">here</a>.</p>
<p>The dataset has annotations for recognizing an action per instance from video frames
like visual tracking task. Specifically, the AVA action dataset contains frame indices,
bounding box cooridnates, actions, and tracking ids in the annotation file. The action
categories are described in <code>ava_action_list_v2.2.pbtxt</code>. For the ease use for object
detection, the AVA action dataset provides the bounding box proposals from <code>Faster R-CNN</code>.</p>
<p>Supported task / format:</p>
<ul>
<li>Object detection - <code>ava</code></li>
</ul>
<p>Supported annotation types:</p>
<ul>
<li><code>Bbox</code> (detection)</li>
</ul>
<h2 id="import-ava-action-dataset">Import AVA action dataset</h2>
<p>The AVA action dataset is available for free download
<a href="https://research.google.com/ava/download.html#ava_actions_download">here</a>.</p>
<p>A Datumaro project with a AVA action source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format ava &lt;path/to/dataset&gt;
</code></pre></div><p>It is possible to specify project name and project directory. Run
<code>datum create --help</code> for more information.</p>
<p>The AVA action dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset
   ├── frames/
   │   ├── video0/ # directory with list of frames extracted from video0
   │   │   ├── img1.jpg
   │   |   ├── img2.jpg
   │   |   └── ...
   │   ├── video1/ # directory with list of frames extracted from video1
   │   │   ├── img1.jpg
   │   |   ├── img2.jpg
   │   |   └── ...
   └── annotations/
       ├── ava_action_list_v2.2.pbtxt # list of action categories
       ├── ava_train_v2.2.csv # annotations for training data
       ├── ava_val_v2.2.csv # annotations for validation data
       ├── ava_dense_proposals_train.FAIR.recall_93.9.pkl # region proposals for training data
       ├── ava_dense_proposals_val.FAIR.recall_93.9.pkl # region proposals for validation data
       └── ...
</code></pre><p>To make sure that the selected dataset has been added to the project, you
can run <code>datum project info</code>, which will display the project information.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert a AVA action dataset into any other format
<a href="../../docs/user-manual/supported_formats">Datumaro supports</a>.</p>
<p>Such conversion will only be successful if the output
format can represent the type of dataset you want to convert,
e.g., AVA action annotations can be converted to <code>COCO detection</code>.</p>
<p>There are several ways to convert a AVA action dataset to other dataset formats:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f ava &lt;path/to/ava&gt;
datum <span style="color:#204a87">export</span> -f coco -o &lt;output/dir&gt;
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if ava -i &lt;path/to/ava&gt; -f coco -o &lt;output/dir&gt;
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/ava&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;ava&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;coco&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="export-to-ava-action-format">Export to AVA action format</h2>
<p>There are several ways to convert an existing dataset to AVA action format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into AVA action format (detection) from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f ava -o &lt;output/dir&gt; --
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># converting to AVA action format from other format</span>
datum convert -if imagenet -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f ava -o &lt;output/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    --save-media
</code></pre></div><p>Extra options for exporting to AVA action format:</p>
<ul>
<li><code>--save-media</code> - allow to export dataset with saving media files
(by default <code>False</code>).</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum <span style="color:#204a87">export</span> -f ava -- --extra-option-1 --extra-option-2 ...
</code></pre></div><h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/unit/test_ava_format.py">the format tests</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a9ac2e8e3eb539b281d9d06f9d906506">5.6 - BraTS</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>The original BraTS dataset is available
<a href="https://www.med.upenn.edu/sbia/brats2017/data.html">here</a>.
The BraTS data provided since BraTS'17 differs significantly from the data
provided during the previous BraTS challenges (i.e., 2016 and backwards).
Datumaro supports BraTS'17-20.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Mask</code></li>
</ul>
<h2 id="import-brats-dataset">Import BraTS dataset</h2>
<p>A Datumaro project with a BraTS source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format brats &lt;path/to/dataset&gt;
</code></pre></div><p>It is also possible to import the dataset using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>

<span style="color:#000">brats_dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;brats&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>BraTS dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>dataset/
├── imagesTr
│   │── &lt;img1&gt;.nii.gz
│   │── &lt;img2&gt;.nii.gz
│   └── ...
├── imagesTs
│   │── &lt;img3&gt;.nii.gz
│   │── &lt;img4&gt;.nii.gz
│   └── ...
├── labels
└── labelsTr
    │── &lt;img1&gt;.nii.gz
    │── &lt;img2&gt;.nii.gz
    └── ...
</code></pre><p>The data in Datumaro is stored as multi-frame images (set of 2D images).
Annotated images are stored as masks for each 2d image separately
with an <code>image_id</code> attribute.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert a BraTS dataset into any other format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to a format
that supports segmentation masks.</p>
<p>There are several ways to convert a BraTS dataset to other dataset
formats using CLI:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f brats &lt;path/to/dataset&gt;
datum <span style="color:#204a87">export</span> -f voc -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if brats -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f voc -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;brats&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/test_brats_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ffe3e5d96a7d39ef06e636ccb30640dc">5.7 - BraTS Numpy</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>The original BraTS dataset is available
<a href="https://www.med.upenn.edu/sbia/brats2018/data.html">here</a>.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Mask</code></li>
<li><code>Cuboid3d</code></li>
</ul>
<h2 id="import-brats-numpy-dataset">Import BraTS Numpy dataset</h2>
<p>A Datumaro project with a BraTS Numpy source can be created
in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format brats_numpy &lt;path/to/dataset&gt;
</code></pre></div><p>It is also possible to import the dataset using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>

<span style="color:#000">brats_dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;brats_numpy&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>BraTS Numpy dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>dataset/
├── &lt;img1&gt;_data_cropped.npy
├── &lt;img1&gt;_label_cropped.npy
├── &lt;img2&gt;_data_cropped.npy
├── &lt;img2&gt;_label_cropped.npy
├── ...
├── labels
├── val_brain_bbox.p
└── val_ids.p
</code></pre><p>The data in Datumaro is stored as multi-frame images (set of 2D images).
Annotated images are stored as masks for each 2d image separately
with an <code>image_id</code> attribute.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert a BraTS Numpy dataset into any other format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to a format
that supports segmentation masks or cuboids.</p>
<p>There are several ways to convert a BraTS Numpy dataset to other dataset
formats using CLI:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f brats_numpy &lt;path/to/dataset&gt;
datum <span style="color:#204a87">export</span> -f voc -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if brats_numpy -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f voc -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.components.dataset</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Dataset</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;brats_numpy&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/test_brats_numpy_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-371aa98e0519c0c055b8ef101dec2080">5.8 - CelebA</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>The original CelebA dataset is available
<a href="https://mmlab.ie.cuhk.edu.hk/projects/CelebA.html">here</a>.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Label</code></li>
<li><code>Bbox</code></li>
<li><code>Points</code> (landmarks)</li>
</ul>
<p>Supported attributes:</p>
<ul>
<li><code>5_o_Clock_Shadow</code>, <code>Arched_Eyebrows</code>, <code>Attractive</code>,
<code>Bags_Under_Eyes</code>, <code>Bald</code>, <code>Bangs</code>, <code>Big_Lips</code>, <code>Big_Nose</code>, <code>Black_Hair</code>,
<code>Blond_Hair</code>, <code>Blurry</code>, <code>Brown_Hair</code>, <code>Bushy_Eyebrows</code>, <code>Chubby</code>,
<code>Double_Chin</code>, <code>Eyeglasses</code>, <code>Goatee</code>, <code>Gray_Hair</code>, <code>Heavy_Makeup</code>,
<code>High_Cheekbones</code>, <code>Male</code>, <code>Mouth_Slightly_Open</code>, <code>Mustache</code>, <code>Narrow_Eyes</code>,
<code>No_Beard</code>, <code>Oval_Face</code>, <code>Pale_Skin</code>, <code>Pointy_Nose</code>, <code>Receding_Hairline</code>,
<code>Rosy_Cheeks</code>, <code>Sideburns</code>, <code>Smiling</code>, <code>Straight_Hair</code>, <code>Wavy_Hair</code>,
<code>Wearing_Earrings</code>, <code>Wearing_Hat</code>, <code>Wearing_Lipstick</code>, <code>Wearing_Necklace</code>,
<code>Wearing_Necktie</code>, <code>Young</code> (boolean)</li>
</ul>
<h2 id="import-celeba-dataset">Import CelebA dataset</h2>
<p>A Datumaro project with a CelebA source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format celeba &lt;path/to/dataset&gt;
</code></pre></div><p>It is also possible to import the dataset using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">celeba_dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;celeba&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>CelebA dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>dataset/
├── dataset_meta.json # a list of non-format labels (optional)
├── Anno/
│   ├── identity_CelebA.txt
│   ├── list_attr_celeba.txt
│   ├── list_bbox_celeba.txt
│   └── list_landmarks_celeba.txt
├── Eval/
│   └── list_eval_partition.txt
└── Img/
    └── img_celeba/
        ├── 000001.jpg
        ├── 000002.jpg
        └── ...
</code></pre><p>The <code>identity_CelebA.txt</code> file contains labels (required).
The <code>list_attr_celeba.txt</code>, <code>list_bbox_celeba.txt</code>,
<code>list_landmarks_celeba.txt</code>, <code>list_eval_partition.txt</code> files contain
attributes, bounding boxes, landmarks and subsets respectively
(optional).</p>
<p>The original CelebA dataset stores images in a .7z archive. The archive
needs to be unpacked before importing.</p>
<p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert a CelebA dataset into any other format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to a format
that supports labels, bounding boxes or landmarks.</p>
<p>There are several ways to convert a CelebA dataset to other dataset
formats using CLI:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f celeba &lt;path/to/dataset&gt;
datum <span style="color:#204a87">export</span> -f imagenet_txt -o ./save_dir -- --save-media
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if celeba -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f imagenet_txt -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;celeba&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/test_celeba_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ddb50cccf6304e9bb85b1b9fb0369c48">5.9 - CIFAR</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>CIFAR format specification is available <a href="https://www.cs.toronto.edu/~kriz/cifar.html">here</a>.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Label</code></li>
</ul>
<p>Datumaro supports Python version CIFAR-10/100.
The difference between CIFAR-10 and CIFAR-100 is how labels are stored
in the meta files (<code>batches.meta</code> or <code>meta</code>) and in the annotation files.
The 100 classes in the CIFAR-100 are grouped into 20 superclasses. Each image
comes with a &ldquo;fine&rdquo; label (the class to which it belongs) and a &ldquo;coarse&rdquo; label
(the superclass to which it belongs). In CIFAR-10 there are no superclasses.</p>
<p>CIFAR formats contain 32 x 32 images. As an extension, Datumaro supports
reading and writing of arbitrary-sized images.</p>
<h2 id="import-cifar-dataset">Import CIFAR dataset</h2>
<p>The CIFAR dataset is available for free download:</p>
<ul>
<li><a href="https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz">cifar-10-python.tar.gz</a>:
CIFAR-10 python version</li>
<li><a href="https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz">cifar-100-python.tar.gz</a>:
CIFAR-100 python version</li>
</ul>
<p>A Datumaro project with a CIFAR source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format cifar &lt;path/to/dataset&gt;
</code></pre></div><p>It is possible to specify project name and project directory. Run
<code>datum create --help</code> for more information.</p>
<p>CIFAR-10 dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── dataset_meta.json # a list of non-format labels (optional)
    ├── batches.meta
    ├── &lt;subset_name1&gt;
    ├── &lt;subset_name2&gt;
    └── ...
</code></pre><p>CIFAR-100 dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── dataset_meta.json # a list of non-format labels (optional)
    ├── meta
    ├── &lt;subset_name1&gt;
    ├── &lt;subset_name2&gt;
    └── ...
</code></pre><p>Dataset files use the <a href="https://docs.python.org/3/library/pickle.html">Pickle</a>
data format.</p>
<p>Meta files:</p>
<!--lint disable fenced-code-flag-->
<pre><code>CIFAR-10:
    num_cases_per_batch: 1000
    label_names: list of strings (['airplane', 'automobile', 'bird', ...])
    num_vis: 3072

CIFAR-100:
    fine_label_names: list of strings (['apple', 'aquarium_fish', ...])
    coarse_label_names: list of strings (['aquatic_mammals', 'fish', ...])
</code></pre><p>Annotation files:</p>
<!--lint disable fenced-code-flag-->
<pre><code>Common:
    'batch_label': 'training batch 1 of &lt;N&gt;'
    'data': numpy.ndarray of uint8, layout N x C x H x W
    'filenames': list of strings

    If images have non-default size (32x32) (Datumaro extension):
        'image_sizes': list of (H, W) tuples

CIFAR-10:
    'labels': list of strings

CIFAR-100:
    'fine_labels': list of integers
    'coarse_labels': list of integers
</code></pre><p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert a CIFAR dataset into any other format <a href="../../docs/user-manual/supported_formats">Datumaro supports</a>.
To get the expected result, convert the dataset to a format
that supports the classification task (e.g. MNIST, ImageNet, PascalVOC, etc.)</p>
<p>There are several ways to convert a CIFAR dataset to other dataset
formats using CLI:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f cifar &lt;path/to/cifar&gt;
datum <span style="color:#204a87">export</span> -f imagenet -o &lt;output/dir&gt;
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if cifar -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f imagenet -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;cifar&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;imagenet&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="export-to-cifar">Export to CIFAR</h2>
<p>There are several ways to convert a dataset to CIFAR format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into CIFAR format from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f cifar -o &lt;output/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- --save-media
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># converting to CIFAR format from other format</span>
datum convert -if imagenet -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f cifar -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Extra options for exporting to CIFAR format:</p>
<ul>
<li><code>--save-media</code> allow to export dataset with saving media files
(by default <code>False</code>)</li>
<li><code>--image-ext &lt;IMAGE_EXT&gt;</code> allow to specify image extension
for exporting the dataset (by default <code>.png</code>)</li>
<li><code>--save-dataset-meta</code> - allow to export dataset with saving dataset meta
file (by default <code>False</code>)</li>
</ul>
<p>The format (CIFAR-10 or CIFAR-100) in which the dataset will be
exported depends on the presence of superclasses in the <code>LabelCategories</code>.</p>
<h2 id="examples">Examples</h2>
<p>Datumaro supports filtering, transformation, merging etc. for all formats
and for the CIFAR format in particular. Follow the <a href="../../docs/user-manual">user manual</a>
to get more information about these operations.</p>
<p>There are several examples of using Datumaro operations to solve
particular problems with CIFAR dataset:</p>
<h3 id="example-1-how-to-create-a-custom-cifar-like-dataset">Example 1. How to create a custom CIFAR-like dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">numpy</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">np</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">([</span>
    <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">32</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">32</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)),</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Label</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)]</span>
    <span style="color:#000;font-weight:bold">),</span>
    <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">32</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">32</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)),</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Label</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">)]</span>
    <span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;airplane&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;automobile&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;bird&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;cat&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;deer&#39;</span><span style="color:#000;font-weight:bold">,</span>
               <span style="color:#4e9a06">&#39;dog&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;frog&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;horse&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;ship&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;truck&#39;</span><span style="color:#000;font-weight:bold">])</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./dataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;cifar&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h3 id="example-2-how-to-filter-and-convert-a-cifar-dataset-to-imagenet">Example 2. How to filter and convert a CIFAR dataset to ImageNet</h3>
<p>Convert a CIFAR dataset to ImageNet format, keep only images with the
<code>dog</code> class present:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># Download CIFAR-10 dataset:</span>
<span style="color:#8f5902;font-style:italic"># https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz</span>
datum convert --input-format cifar --input-path &lt;path/to/cifar&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>              --output-format imagenet <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>              --filter <span style="color:#4e9a06">&#39;/item[annotation/label=&#34;dog&#34;]&#39;</span>
</code></pre></div><p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/test_cifar_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-b4837f6e880fb91ac1bc5f75998df382">5.10 - Cityscapes</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>Cityscapes format overview is available <a href="https://www.cityscapes-dataset.com/dataset-overview/">here</a>.</p>
<p>Cityscapes format specification is available <a href="https://github.com/mcordts/cityscapesScripts#the-cityscapes-dataset">here</a>.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Masks</code></li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li><code>is_crowd</code> (boolean). Specifies if the annotation label can
distinguish between different instances.
If <code>False</code>, the annotation <code>id</code> field encodes the instance id.</li>
</ul>
<h2 id="import-cityscapes-dataset">Import Cityscapes dataset</h2>
<p>The Cityscapes dataset is available for free <a href="https://www.cityscapes-dataset.com/downloads/">download</a>.</p>
<p>A Datumaro project with a Cityscapes source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format cityscapes &lt;path/to/dataset&gt;
</code></pre></div><p>Cityscapes dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── dataset_meta.json # a list of non-Cityscapes labels (optional)
    ├── label_colors.txt # a list of non-Cityscapes labels in other format (optional)
    ├── imgsFine/
    │   ├── leftImg8bit
    │   │   ├── &lt;split: train,val, ...&gt;
    │   │   |   ├── {city1}
    │   │   │   |   ├── {city1}_{seq:[0...6]}_{frame:[0...6]}_leftImg8bit.png
    │   │   │   │   └── ...
    │   │   |   ├── {city2}
    │   │   │   └── ...
    │   │   └── ...
    └── gtFine/
        ├── &lt;split: train,val, ...&gt;
        │   ├── {city1}
        │   |   ├── {city1}_{seq:[0...6]}_{frame:[0...6]}_gtFine_color.png
        │   |   ├── {city1}_{seq:[0...6]}_{frame:[0...6]}_gtFine_instanceIds.png
        │   |   ├── {city1}_{seq:[0...6]}_{frame:[0...6]}_gtFine_labelIds.png
        │   │   └── ...
        │   ├── {city2}
        │   └── ...
        └── ...
</code></pre><p>Annotated files description:</p>
<ol>
<li><code>*_leftImg8bit.png</code> - left images in 8-bit LDR format</li>
<li><code>*_color.png</code> - class labels encoded by its color</li>
<li><code>*_labelIds.png</code> - class labels are encoded by its index</li>
<li><code>*_instanceIds.png</code> - class and instance labels encoded by an instance ID.
The pixel values encode class and the individual instance: the integer part
of a division by 1000 of each ID provides class ID, the remainder
is the instance ID. If a certain annotation describes multiple instances,
then the pixels have the regular ID of that class</li>
</ol>
<p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>
and <code>label_colors.txt</code>.
If the <code>dataset_meta.json</code> is not represented in the dataset, then
<code>label_colors.txt</code> will be imported if possible.</p>
<p>In <code>label_colors.txt</code> you can define custom color map and non-cityscapes labels,
for example:</p>
<pre><code># label_colors [color_rgb name]
0 124 134 elephant
</code></pre><p>To make sure that the selected dataset has been added to the project, you can
run <code>datum project info</code>, which will display the project information.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert a Cityscapes dataset into any other format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to formats
that support the segmentation task (e.g. PascalVOC, CamVID, etc.)</p>
<p>There are several ways to convert a Cityscapes dataset to other dataset
formats using CLI:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f cityscapes &lt;path/to/cityscapes&gt;
datum <span style="color:#204a87">export</span> -f voc -o &lt;output/dir&gt;
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if cityscapes -i &lt;path/to/cityscapes&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f voc -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;cityscapes&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="export-to-cityscapes">Export to Cityscapes</h2>
<p>There are several ways to convert a dataset to Cityscapes format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into Cityscapes format from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f cityscapes -o &lt;output/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- --save-media
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># converting to Cityscapes format from other format</span>
datum convert -if voc -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f cityscapes -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Extra options for exporting to Cityscapes format:</p>
<ul>
<li><code>--save-media</code> allow to export dataset with saving media files
(by default <code>False</code>)</li>
<li><code>--image-ext IMAGE_EXT</code> allow to specify image extension
for exporting dataset (by default - keep original or use <code>.png</code>, if none)</li>
<li><code>--save-dataset-meta</code> - allow to export dataset with saving dataset meta
file (by default <code>False</code>)</li>
<li><code>--label_map</code> allow to define a custom colormap. Example:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># mycolormap.txt :</span>
<span style="color:#8f5902;font-style:italic"># 0 0 255 sky</span>
<span style="color:#8f5902;font-style:italic"># 255 0 0 person</span>
<span style="color:#8f5902;font-style:italic">#...</span>
datum <span style="color:#204a87">export</span> -f cityscapes -- --label-map mycolormap.txt
</code></pre></div><p>or you can use original cityscapes colomap:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum <span style="color:#204a87">export</span> -f cityscapes -- --label-map cityscapes
</code></pre></div><h2 id="examples">Examples</h2>
<p>Datumaro supports filtering, transformation, merging etc. for all formats
and for the Cityscapes format in particular. Follow the
<a href="../../docs/user-manual/">user manual</a>
to get more information about these operations.</p>
<p>There are several examples of using Datumaro operations to solve
particular problems with a Cityscapes dataset:</p>
<h3 id="example-1-load-the-original-cityscapes-dataset-and-convert-to-pascal-voc">Example 1. Load the original Cityscapes dataset and convert to Pascal VOC</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o project
datum import -p project -f cityscapes ./Cityscapes/
datum stats -p project
datum <span style="color:#204a87">export</span> -p project -o dataset/ -f voc -- --save-media
</code></pre></div><h3 id="example-2-create-a-custom-cityscapes-like-dataset">Example 2. Create a custom Cityscapes-like dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">collections</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">OrderedDict</span>

<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">numpy</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">np</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro.plugins.cityscapes_format</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">Cityscapes</span>

<span style="color:#000">label_map</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">OrderedDict</span><span style="color:#000;font-weight:bold">()</span>
<span style="color:#000">label_map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;background&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">label_map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;label_1&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">label_map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;label_2&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">categories</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Cityscapes</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">make_cityscapes_categories</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">label_map</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">([</span>
    <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)),</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
            <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Mask</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">array</span><span style="color:#000;font-weight:bold">([[</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]]),</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span>
            <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Mask</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">array</span><span style="color:#000;font-weight:bold">([[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]]),</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;is_crowd&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">False</span><span style="color:#000;font-weight:bold">}),</span>
        <span style="color:#000;font-weight:bold">]</span>
    <span style="color:#000;font-weight:bold">),</span>
<span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">categories</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./dataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;cityscapes&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_cityscapes_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f3691abbbae7eae85ce83b256e5aec64">5.11 - COCO</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>COCO format specification is available <a href="https://cocodataset.org/#format-data">here</a>.</p>
<p>The dataset has annotations for multiple tasks. Each task has its own format
in Datumaro, and there is also a combined <code>coco</code> format, which includes all
the available tasks. The sub-formats have the same options as the &ldquo;main&rdquo;
format and only limit the set of annotation files they work with. To work with
multiple formats, use the corresponding option of the <code>coco</code> format.</p>
<p>Supported tasks / formats:</p>
<ul>
<li>The combined format - <code>coco</code></li>
<li><a href="https://cocodataset.org/#captions-2015">Image Captioning</a> - <code>coco_caption</code></li>
<li><a href="https://cocodataset.org/#detection-2020">Object Detection</a> - <code>coco_instances</code></li>
<li><a href="https://cocodataset.org/#panoptic-2020">Panoptic Segmentation</a> - <code>coco_panoptic</code></li>
<li><a href="https://cocodataset.org/#keypoints-2020">Keypoint Detection</a> - <code>coco_person_keypoints</code></li>
<li><a href="https://cocodataset.org/#stuff-2019">Stuff Segmentation</a> - <code>coco_stuff</code></li>
<li>Image Info - <code>coco_image_info</code></li>
<li>Image classification (Datumaro extension) - <code>coco_labels</code>. The format is like
Object Detection, but uses only <code>category_id</code> and <code>score</code> annotation fields.</li>
</ul>
<p>Supported annotation types (depending on the task):</p>
<ul>
<li><code>Caption</code> (captions)</li>
<li><code>Label</code> (label, Datumaro extension)</li>
<li><code>Bbox</code> (instances, person keypoints)</li>
<li><code>Polygon</code> (instances, person keypoints)</li>
<li><code>Mask</code> (instances, person keypoints, panoptic, stuff)</li>
<li><code>Points</code> (person keypoints)</li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li><code>is_crowd</code> (boolean; on <code>bbox</code>, <code>polygon</code> and <code>mask</code> annotations) - Indicates
that the annotation covers multiple instances of the same class.</li>
<li><code>score</code> (number; range [0; 1]) - Indicates the confidence in this
annotation. Ground truth annotations always have 1.</li>
<li>arbitrary attributes (string/number) - A Datumaro extension. Stored
in the <code>attributes</code> section of the annotation descriptor.</li>
</ul>
<h2 id="import-coco-dataset">Import COCO dataset</h2>
<p>The COCO dataset is available for free download:</p>
<p>Images:</p>
<ul>
<li><a href="http://images.cocodataset.org/zips/train2017.zip">train images</a></li>
<li><a href="http://images.cocodataset.org/zips/val2017.zip">val images</a></li>
<li><a href="http://images.cocodataset.org/zips/test2017.zip">test images</a></li>
<li><a href="http://images.cocodataset.org/zips/unlabeled2017.zip">unlabeled images</a></li>
</ul>
<p>Annotations:</p>
<ul>
<li><a href="http://images.cocodataset.org/annotations/annotations_trainval2017.zip">captions</a></li>
<li><a href="http://images.cocodataset.org/annotations/image_info_test2017.zip">image_info</a></li>
<li><a href="http://images.cocodataset.org/annotations/annotations_trainval2017.zip">instances</a></li>
<li><a href="http://images.cocodataset.org/annotations/panoptic_annotations_trainval2017.zip">panoptic</a></li>
<li><a href="http://images.cocodataset.org/annotations/annotations_trainval2017.zip">person_keypoints</a></li>
<li><a href="http://images.cocodataset.org/annotations/stuff_annotations_trainval2017.zip">stuff</a></li>
</ul>
<p>A Datumaro project with a COCO source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format coco &lt;path/to/dataset&gt;
</code></pre></div><p>It is possible to specify project name and project directory. Run
<code>datum create --help</code> for more information.</p>
<p>Extra options for adding a source in the COCO format:</p>
<ul>
<li><code>--keep-original-category-ids</code>: Add dummy label categories so that
category indexes in the imported data source correspond to the category IDs
in the original annotation file.</li>
</ul>
<p>A COCO dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── dataset_meta.json # a list of custom labels (optional)
    ├── images/
    │   ├── train/
    │   │   ├── &lt;image_name1.ext&gt;
    │   │   ├── &lt;image_name2.ext&gt;
    │   │   └── ...
    │   └── val/
    │       ├── &lt;image_name1.ext&gt;
    │       ├── &lt;image_name2.ext&gt;
    │       └── ...
    └── annotations/
        ├── &lt;task&gt;_&lt;subset_name&gt;.json
        └── ...
</code></pre><p>For the panoptic task, a dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── dataset_meta.json # a list of custom labels (optional)
    ├── images/
    │   ├── train/
    │   │   ├── &lt;image_name1.ext&gt;
    │   │   ├── &lt;image_name2.ext&gt;
    │   │   └── ...
    │   ├── val/
    │   │   ├── &lt;image_name1.ext&gt;
    │   │   ├── &lt;image_name2.ext&gt;
    │   │   └── ...
    └── annotations/
        ├── panoptic_train/
        │   ├── &lt;image_name1.ext&gt;
        │   ├── &lt;image_name2.ext&gt;
        │   └── ...
        ├── panoptic_train.json
        ├── panoptic_val/
        │   ├── &lt;image_name1.ext&gt;
        │   ├── &lt;image_name2.ext&gt;
        │   └── ...
        └── panoptic_val.json
</code></pre><p>Annotation files must have the names like <code>&lt;task_name&gt;_&lt;subset_name&gt;.json</code>.
The year is treated as a part of the subset name.
If the annotation file name does&rsquo;t match this pattern, use one of the
task-specific formats instead of plain <code>coco</code>: <code>coco_captions</code>,
<code>coco_image_info</code>, <code>coco_instances</code>, <code>coco_labels</code>, <code>coco_panoptic</code>,
<code>coco_person_keypoints</code>, <code>coco_stuff</code>. In this case all items of the
dataset will be added to the <code>default</code> subset.</p>
<p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>.</p>
<p>You can import a dataset for one or several tasks
instead of the whole dataset. This option also allows to import annotation
files with non-default names. For example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format coco_stuff -r &lt;relpath/to/stuff.json&gt; &lt;path/to/dataset&gt;
</code></pre></div><p>To make sure that the selected dataset has been added to the project, you can
run <code>datum project info</code>, which will display the project information.</p>
<p>Notes:</p>
<ul>
<li>COCO categories can have any integer ids, however, Datumaro will count
annotation category id 0 as &ldquo;not specified&rdquo;. This does not contradict
the original annotations, because they have category indices starting from 1.</li>
</ul>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert COCO dataset into any other format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to formats
that support the specified task (e.g. for panoptic segmentation - VOC, CamVID)</p>
<p>There are several ways to convert a COCO dataset to other dataset formats
using CLI:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f coco &lt;path/to/coco&gt;
datum <span style="color:#204a87">export</span> -f voc -o &lt;output/dir&gt;
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if coco -i &lt;path/to/coco&gt; -f voc -o &lt;output/dir&gt;
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;coco&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="export-to-coco">Export to COCO</h2>
<p>There are several ways to convert a dataset to COCO format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into COCO format from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f coco -o &lt;output/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- --save-media
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># converting to COCO format from other format</span>
datum convert -if voc -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f coco -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Extra options for exporting to COCO format:</p>
<ul>
<li><code>--save-media</code> allow to export dataset with saving media files
(by default <code>False</code>)</li>
<li><code>--image-ext IMAGE_EXT</code> allow to specify image extension
for exporting dataset (by default - keep original or use <code>.jpg</code>, if none)</li>
<li><code>--save-dataset-meta</code> - allow to export dataset with saving dataset meta
file (by default <code>False</code>)</li>
<li><code>--segmentation-mode MODE</code> allow to specify save mode for instance
segmentation:
<ul>
<li>&lsquo;guess&rsquo;: guess the mode for each instance
(using &lsquo;is_crowd&rsquo; attribute as hint)</li>
<li>&lsquo;polygons&rsquo;: save polygons (merge and convert masks, prefer polygons)</li>
<li>&lsquo;mask&rsquo;: save masks (merge and convert polygons, prefer masks)
(by default <code>guess</code>)</li>
</ul>
</li>
<li><code>--crop-covered</code> allow to crop covered segments so that background objects
segmentation was more accurate (by default <code>False</code>)</li>
<li><code>--allow-attributes ALLOW_ATTRIBUTES</code> allow export of attributes
(by default <code>True</code>). The parameter enables or disables writing
the custom annotation attributes to the &ldquo;attributes&rdquo; annotation
field. This field is an extension to the original COCO format</li>
<li><code>--reindex REINDEX</code> allow to assign new indices to images and annotations,
useful to avoid merge conflicts (by default <code>False</code>).
This option allows to control if the images and
annotations must be given new indices. It can be useful, when
you want to preserve the original indices in the produced dataset.
Consider having this option enabled when converting from other formats
or merging datasets to avoid conflicts</li>
<li><code>--merge-images</code> allow to save all images into a single directory
(by default <code>False</code>). The parameter controls the output directory for
images. When enabled, the dataset images are saved into a single
directory, otherwise they are saved in separate directories by subsets.</li>
<li><code>--tasks TASKS</code> allow to specify tasks for export dataset,
by default Datumaro uses all tasks. Example:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f coco &lt;path/to/dataset&gt;
datum <span style="color:#204a87">export</span> -f coco -- --tasks instances,stuff
</code></pre></div><h2 id="examples">Examples</h2>
<p>Datumaro supports filtering, transformation, merging etc. for all formats
and for the COCO format in particular. Follow the
<a href="../../docs/user-manual/">user manual</a>
to get more information about these operations.</p>
<p>There are several examples of using Datumaro operations to solve
particular problems with a COCO dataset:</p>
<h3 id="example-1-how-to-load-an-original-panoptic-coco-dataset-and-convert-to-pascal-voc">Example 1. How to load an original panoptic COCO dataset and convert to Pascal VOC</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o project
datum import -p project -f coco_panoptic ./COCO/annotations/panoptic_val2017.json
datum stats -p project
datum <span style="color:#204a87">export</span> -p project -f voc -- --save-media
</code></pre></div><h3 id="example-2-how-to-create-custom-coco-like-dataset">Example 2. How to create custom COCO-like dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">numpy</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">np</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">([</span>
  <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;000000000001&#39;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)),</span>
    <span style="color:#000">subset</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;val&#39;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;id&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">40</span><span style="color:#000;font-weight:bold">},</span>
    <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
      <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Mask</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">array</span><span style="color:#000;font-weight:bold">([[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]]),</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">group</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;is_crowd&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">False</span><span style="color:#000;font-weight:bold">}),</span>
      <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Mask</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">array</span><span style="color:#000;font-weight:bold">([[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]]),</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">20</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">group</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">20</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;is_crowd&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">}),</span>
    <span style="color:#000;font-weight:bold">]</span>
  <span style="color:#000;font-weight:bold">),</span>
<span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;a&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;b&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;c&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;d&#39;</span><span style="color:#000;font-weight:bold">])</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./dataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;coco_panoptic&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_coco_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-dc7c8d0a431dc29fa653d95ad0142fa6">5.12 - Common Semantic Segmentation</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>CSS format specification is available <a href="https://github.com/openvinotoolkit/open_model_zoo/blob/master/tools/accuracy_checker/openvino/tools/accuracy_checker/annotation_converters/README.md#supported-converters">here</a>.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Masks</code></li>
</ul>
<h2 id="import-common-semantic-segmentation-dataset">Import Common Semantic Segmentation dataset</h2>
<p>A Datumaro project with a CSS source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format common_semantic_segmentation &lt;path/to/dataset&gt;
</code></pre></div><p>Extra import options:</p>
<ul>
<li><code>--image-prefix IMAGE_PREFIX</code> allow to import dataset with custom image prefix
(by default &lsquo;')</li>
<li><code>--mask-prefix MASK_PREFIX</code> allow to import dataset with custom mask prefix
(by default &lsquo;')</li>
</ul>
<p>CSS dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── dataset_meta.json # a list of labels
    ├── images/
    │   ├── &lt;img1&gt;.png
    │   ├── &lt;img2&gt;.png
    │   └── ...
    └── masks/
        ├── &lt;img1&gt;.png
        ├── &lt;img2&gt;.png
        └── ...
</code></pre><p>To describe classes and colors, you should use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>.</p>
<p>To make sure that the selected dataset has been added to the project, you can
run <code>datum project info</code>, which will display the project information.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert a CSS dataset into any other format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to formats
that support the segmentation task (e.g. PASCAL VOC, CamVid, Cityscapes, etc.)</p>
<p>There are several ways to convert a CSS dataset to other dataset
formats using CLI:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f common_semantic_segmentation &lt;path/to/dataset&gt;
datum <span style="color:#204a87">export</span> -f voc -o &lt;output/dir&gt;
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if common_semantic_segmentation -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f cityscapes -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;common_semantic_segmentation&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;camvid&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/test_common_semantic_segmentation_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-70ad816d48fd3a880f1fd7c3d38c73fb">5.13 - Common Super Resolution</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>CSR format specification is available <a href="https://github.com/openvinotoolkit/workbench/blob/master/docs/Workbench_DG/Dataset_Types.md#common-super-resolution-csr">here</a>.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>SuperResolutionAnnotation</code></li>
</ul>
<p>Supported attributes:</p>
<ul>
<li><code>upsampled</code> (<code>Image</code>): upsampled image</li>
</ul>
<h2 id="import-common-super-resolution-dataset">Import Common Super Resolution dataset</h2>
<p>A Datumaro project with a CSR source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format common_super_resolution &lt;path/to/dataset&gt;
</code></pre></div><p>CSR dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── HR/
    │   ├── &lt;img1&gt;.png
    │   ├── &lt;img2&gt;.png
    │   └── ...
    ├── LR/
    │   ├── &lt;img1&gt;.png
    │   ├── &lt;img2&gt;.png
    │   └── ...
    └── upsampled/ # optional
        ├── &lt;img1&gt;.png
        ├── &lt;img2&gt;.png
        └── ...
</code></pre><p>To make sure that the selected dataset has been added to the project, you can
run <code>datum project info</code>, which will display the project information.</p>
<h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/test_common_super_resolution_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-b609bb1f95fb3092dcde65b871e94fed">5.14 - Datumaro</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>Datumaro format is <a href="https://github.com/openvinotoolkit/datumaro">Datumaro</a>&rsquo;s own data format.
It aims to cover all media types and annotation types in Datumaro as possible.
Therefore, if you do not want information loss when re-importing your dataset by <a href="https://github.com/openvinotoolkit/datumaro">Datumaro</a>, we recommend exporting your dataset using the Datumaro format.
In addition, you can directly use the Datumaro format for the model training using <a href="https://github.com/openvinotoolkit/training_extensions">OpenVINO™ Training Extensions</a>.</p>
<p>Supported media types:</p>
<ul>
<li><code>Image</code></li>
<li><code>PointCloud</code></li>
</ul>
<p>Supported annotation types:</p>
<ul>
<li><code>Label</code></li>
<li><code>Mask</code></li>
<li><code>PolyLine</code></li>
<li><code>Polygon</code></li>
<li><code>Bbox</code></li>
<li><code>Points</code></li>
<li><code>Caption</code></li>
<li><code>Cuboid3d</code></li>
<li><code>Ellipse</code></li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li>No restrictions</li>
</ul>
<h2 id="import-datumaro-dataset">Import Datumaro dataset</h2>
<p>A Datumaro project with a Datumaro source can be created in the following way:</p>
<pre><code class="language-console" data-lang="console">datum create
datum import --format datumaro &lt;path/to/dataset&gt;
</code></pre><p>It is possible to specify project name and project directory. Run
<code>datum create --help</code> for more information.</p>
<p>A Datumaro dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── dataset_meta.json # a list of custom labels (optional)
    ├── images/
    │   ├── &lt;subset_name_1&gt;/
    │   │   ├── &lt;image_name1.ext&gt;
    │   │   ├── &lt;image_name2.ext&gt;
    │   │   └── ...
    │   └── &lt;subset_name_2&gt; /
    │       ├── &lt;image_name1.ext&gt;
    │       ├── &lt;image_name2.ext&gt;
    │       └── ...
    └── annotations/
        ├── &lt;subset_name_1&gt;.json
        ├── &lt;subset_name_2&gt;.json
        └── ...
</code></pre><p>If your dataset is not following the above directory structure,
it cannot detect and import your dataset as the Datumaro format properly.</p>
<p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>.</p>
<p>To make sure that the selected dataset has been added to the project, you can
run <code>datum project info</code>, which will display the project information.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>It can convert Datumaro dataset into any other format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to formats
that support the specified task (e.g. for panoptic segmentation - VOC, CamVID)</p>
<p>There are several ways to convert a Datumaro dataset to other dataset formats
using CLI:</p>
<ul>
<li>Export a dataset from Datumaro format to VOC format:</li>
</ul>
<pre><code class="language-console" data-lang="console">datum create
datum import -f datumaro &lt;path/to/dataset&gt;
datum export -f voc -o &lt;output/dir&gt;
</code></pre><p>or</p>
<pre><code class="language-console" data-lang="console">datum convert -if datumaro -i &lt;path/to/dataset&gt; -f voc -o &lt;output/dir&gt;
</code></pre><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;datumaro&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="export-to-datumaro">Export to Datumaro</h2>
<p>There are several ways to convert a dataset to Datumaro format:</p>
<ul>
<li>Export a dataset from an existing project to Datumaro format:</li>
</ul>
<pre><code class="language-console" data-lang="console"># export dataset into Datumaro format from existing project
datum export -p &lt;path/to/project&gt; -f datumaro -o &lt;output/dir&gt; \
    -- --save-media
</code></pre><ul>
<li>Convert a dataset from VOC format to Datumaro format:</li>
</ul>
<pre><code class="language-console" data-lang="console"># converting to Datumaro format from other format
datum convert -if voc -i &lt;path/to/dataset&gt; \
    -f datumaro -o &lt;output/dir&gt; -- --save-media
</code></pre><p>Extra options for exporting to Datumaro format:</p>
<ul>
<li><code>--save-media</code> allow to export dataset with saving media files
(by default <code>False</code>)</li>
</ul>
<h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/unit/data_formats/datumaro/test_datumaro_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-d63660400495cc60b092b7673dc82013">5.15 - DatumaroBinary</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>DatumaroBinary format is <a href="https://github.com/openvinotoolkit/datumaro">Datumaro</a>&rsquo;s own data format as same as <a href="./datumaro.md">Datumaro format</a>.
Basically, it provides the same function as <a href="./datumaro.md">Datumaro format</a>,
but the difference is that the annotation file is not JSON but binary format.
While JSON annotation file in the <a href="./datumaro.md">Datumaro format</a> has the advantage of being easily viewable using any text viewer,
the DatumaroBinary format takes up significantly less storage space since it is schemaless and stores data in binary form.</p>
<h3 id="efficient-storage-cost">Efficient storage cost</h3>
<p>To demonstrate the storage cost-effectiveness of DatumaroBinary,
we conducted an experiment to compare the annotation file sizes of three dataset formats:
COCO (JSON), Datumaro (JSON), and DatumaroBinary (binary).
The table below shows the sizes of each format:</p>
<table>
<thead>
<tr>
<th style="text-align:center">Format</th>
<th style="text-align:center">COCO (JSON)</th>
<th style="text-align:center">Datumaro (JSON)</th>
<th style="text-align:center">DatumaroBinary (binary)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Size</td>
<td style="text-align:center">468Mb</td>
<td style="text-align:center">1046Mb</td>
<td style="text-align:center">301Mb</td>
</tr>
</tbody>
</table>
<p>This table shows that DatumaroBinary reduces the size of annotation files to <strong>64.3% (COCO) and 28.8% (Datumaro).</strong></p>
<p>For this experiment, we used the training and validation annotation files of <a href="https://cocodataset.org">2017 COCO instance segmentation task</a>:</p>
<pre><code class="language-console" data-lang="console">Dataset/
├── images/
│   ├── train/
│   │   ├── &lt;image_name1.ext&gt;
│   │   └── ...
│   └── val/
│       ├── &lt;image_name1.ext&gt;
│       └── ...
└── annotations/
    ├── instances_train2017.json
    └── instances_val2017.json
</code></pre><h3 id="dataset-encryption">Dataset encryption</h3>
<p>Another advantage of the DatumaroBinary format is that it supports dataset encryption. If your dataset is hijacked by a potential attacker and you are concerned that your intellectual properties may be damaged, you can use this feature to protect your dataset from attackers. Enabling the dataset encryption feature allows you to encrypt both annotations and media or only the annotations. If you export the dataset to DatumaroBinary format with encryption, the secret key is automatically generated at the same time. You must keep this secret key separate from the exported dataset. This is because the secret key should be needed to read the exported dataset. Therefore, you have to be careful not to lose the secret key. If you would like to see an example of dataset encryption using Datumaro&rsquo;s Python API, please see <a href="https://github.com/openvinotoolkit/datumaro/blob/develop/notebooks/09_encrypt_dataset.ipynb">here</a>. For CLI usage of encryption, please see <a href="#import-encrypted-datasets">Import encrypted datasets</a> and <a href="#export-datasets-with-encryption">Export datasets with encryption</a> sections.</p>
<h3 id="usage-for-model-training">Usage for model training</h3>
<p>You can directly use the DatumaroBinary format for the model training using <a href="https://github.com/openvinotoolkit/training_extensions">OpenVINO™ Training Extensions</a>.</p>
<p>Supported media types:</p>
<ul>
<li><code>Image</code></li>
<li><code>PointCloud</code></li>
</ul>
<p>Supported annotation types:</p>
<ul>
<li><code>Label</code></li>
<li><code>Mask</code></li>
<li><code>PolyLine</code></li>
<li><code>Polygon</code></li>
<li><code>Bbox</code></li>
<li><code>Points</code></li>
<li><code>Caption</code></li>
<li><code>Cuboid3d</code></li>
<li><code>Ellipse</code></li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li>No restrictions</li>
</ul>
<h2 id="import-datumarobinary-dataset">Import DatumaroBinary dataset</h2>
<p>A Datumaro project with a DatumaroBinary source can be created in the following way:</p>
<pre><code class="language-console" data-lang="console">datum create
datum import --format datumaro_binary &lt;path/to/dataset&gt;
</code></pre><p>It is possible to specify project name and project directory. Run
<code>datum create --help</code> for more information.</p>
<p>A DatumaroBinary dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── dataset_meta.json   # a list of custom labels (optional)
    ├── images/
    │   ├── &lt;subset_name_1&gt;/
    │   │   ├── &lt;image_name1.ext&gt;
    │   │   ├── &lt;image_name2.ext&gt;
    │   │   └── ...
    │   └── &lt;subset_name_2&gt; /
    │       ├── &lt;image_name1.ext&gt;
    │       ├── &lt;image_name2.ext&gt;
    │       └── ...
    └── annotations/
        ├── &lt;subset_name_1&gt;.datum
        ├── &lt;subset_name_2&gt;.datum
        └── ...
</code></pre><p>If your dataset is not following the above directory structure,
it cannot detect and import your dataset as the DatumaroBinary format properly.</p>
<p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>.</p>
<p>To make sure that the selected dataset has been added to the project, you can
run <code>datum project info</code>, which will display the project information.</p>
<h3 id="import-encrypted-datasets">Import encrypted datasets</h3>
<p>If you want to import the dataset with encryption, please give <code>--encryption-key &lt;secret-key&gt;</code> to the optional arguments:</p>
<pre><code class="language-console" data-lang="console">datum create
datum import --format datumaro_binary &lt;path/to/dataset&gt; -- --encryption-key &lt;secret-key&gt;
</code></pre><p><code>&lt;secret-key&gt;</code> is a 50-bytes long base64 encoded string prefixed with <code>datum-</code>. It is auto-generated in <code>&lt;output/dir&gt;/secret_key.txt</code> when the dataset is exported to DatumaroBinary format with <code>--encryption</code> option. You must have a correct <code>&lt;secret-key&gt;</code> to import the dataset encrypted by Datumaro.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>It can convert DatumaroBinary dataset into any other format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to formats
that support the specified task (e.g. for panoptic segmentation - VOC, CamVID)</p>
<p>There are several ways to convert a DatumaroBinary dataset to other dataset formats
using CLI:</p>
<ul>
<li>Export a dataset from DatumaroBinary to VOC format:</li>
</ul>
<pre><code class="language-console" data-lang="console">datum create
datum import -f datumaro_binary &lt;path/to/dataset&gt;
datum export -f voc -o &lt;output/dir&gt;
</code></pre><p>or</p>
<pre><code class="language-console" data-lang="console">datum convert -if datumaro_binary -i &lt;path/to/dataset&gt; -f voc -o &lt;output/dir&gt;
</code></pre><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;datumaro_binary&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="export-to-datumarobinary">Export to DatumaroBinary</h2>
<p>There are several ways to convert a dataset to DatumaroBinary format:</p>
<ul>
<li>Export a dataset from an existing project to DatumaroBinary:</li>
</ul>
<pre><code class="language-console" data-lang="console"># export dataset into DatumaroBinary format from existing project
datum export -p &lt;path/to/project&gt; -f datumaro_binary -o &lt;output/dir&gt; \
    -- --save-media
</code></pre><ul>
<li>Convert a dataset from VOC format to DatumaroBinary:</li>
</ul>
<pre><code class="language-console" data-lang="console"># converting to DatumaroBinary format from other format
datum convert -if voc -i &lt;path/to/dataset&gt; \
    -f datumaro_binary -o &lt;output/dir&gt; -- --save-media
</code></pre><h2 id="export-datasets-with-encryption">Export datasets with encryption</h2>
<p>If you want to encrypt your dataset, please add ``&ndash;encryption` directive to your command:</p>
<pre><code class="language-console" data-lang="console"># export dataset into DatumaroBinary format from existing project
datum export -p &lt;path/to/project&gt; -f datumaro_binary -o &lt;output/dir&gt; \
    -- --save-media --encryption
</code></pre><blockquote>
<p>Note:
Please keep your secret key file seperate from the exported dataset. The secret key file is in <code>&lt;output/dir&gt;/secret_key.txt</code>. You should have this secret key whenever you want to import your dataset. <strong>We are not responsible for you permanently losing access to your datasets if you lose this secret key.</strong></p>
</blockquote>
<p>If you want to encrypt the annotation files only, not the media files, please add <code>--no-media-encryption</code> in addition to ``&ndash;encryption` directive to your command:</p>
<pre><code class="language-console" data-lang="console"># export dataset into DatumaroBinary format from existing project
datum export -p &lt;path/to/project&gt; -f datumaro_binary -o &lt;output/dir&gt; \
    -- --save-media --encryption --no-media-encryption
</code></pre><p>Extra options for exporting to DatumaroBinary format:</p>
<ul>
<li><code>--save-media</code> allow to export dataset with saving media files
(by default <code>False</code>)</li>
<li><code>--encryption</code> allow to encrypt your dataset with the auto-generated secret key.</li>
<li><code>--num-workers NUM_WORKERS</code> allow to multi-processing for the export. If num_workers = 0, do not use multiprocessing (default: 0).</li>
</ul>
<h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/unit/data_formats/datumaro/test_datumaro_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-9c502db72874fd0b813f297ee04b2391">5.16 - ICDAR</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>ICDAR is a dataset for text recognition task, it&rsquo;s available
for download <a href="https://rrc.cvc.uab.es/">here</a>. There is exists
two most popular version of this dataset: ICDAR13 and ICDAR15,
Datumaro supports both of them.</p>
<p>Original dataset contains the following subformats:</p>
<ul>
<li>ICDAR word recognition;</li>
<li>ICDAR text localization;</li>
<li>ICDAR text segmentation.</li>
</ul>
<p>Supported types of annotations:</p>
<ul>
<li>ICDAR word recognition
<ul>
<li><code>Caption</code></li>
</ul>
</li>
<li>ICDAR text localization
<ul>
<li><code>Polygon</code>, <code>Bbox</code></li>
</ul>
</li>
<li>ICDAR text segmentation
<ul>
<li><code>Mask</code></li>
</ul>
</li>
</ul>
<p>Supported attributes:</p>
<ul>
<li>ICDAR text localization
<ul>
<li><code>text</code>: transcription of text is inside a <code>Polygon</code>/<code>Bbox</code>.</li>
</ul>
</li>
<li>ICDAR text segmentation
<ul>
<li><code>index</code>: identifier of the annotation object, which is encoded in the mask
and coincides with the line number in which the description
of this object is written;</li>
<li><code>text</code>: transcription of text is inside a <code>Mask</code>;</li>
<li><code>color</code>: RGB values of the color corresponding text in the mask image
(three numbers separated by space);</li>
<li><code>center</code>: coordinates of the center of text
(two numbers separated by space).</li>
</ul>
</li>
</ul>
<h2 id="import-icdar-dataset">Import ICDAR dataset</h2>
<p>There is few ways to import ICDAR dataset with Datumaro:</p>
<ul>
<li>Through the Datumaro project</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f icdar_text_localization &lt;text_localization_dataset&gt;
datum import -f icdar_text_segmentation &lt;text_segmentation_dataset&gt;
datum import -f icdar_word_recognition &lt;word_recognition_dataset&gt;
</code></pre></div><ul>
<li>With Python API</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>
<span style="color:#000">data1</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;text_localization_path&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;icdar_text_localization&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">data2</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;text_segmentation_path&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;icdar_text_segmentation&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">data3</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;word_recognition_path&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;icdar_word_recognition&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>Dataset with ICDAR dataset should have the following structure:</p>
<p>For <code>icdar_word_recognition</code></p>
<pre><code>&lt;dataset_path&gt;/
├── &lt;subset_name_1&gt;
│   ├── gt.txt
│   └── images
│       ├── word_1.png
│       ├── word_2.png
│       ├── ...
├── &lt;subset_name_2&gt;
├── ...
</code></pre><p>For <code>icdar_text_localization</code></p>
<pre><code>&lt;dataset_path&gt;/
├── &lt;subset_name_1&gt;
│   ├── gt_img_1.txt
│   ├── gt_img_2.txt
│   ├── ...
│   └── images
│       ├── img_1.png
│       ├── img_2.png
│       ├── ...
├── &lt;subset_name_2&gt;
│   ├── ...
├── ...
</code></pre><p>For <code>icdar_text_segmentation</code></p>
<pre><code>&lt;dataset_path&gt;/
├── &lt;subset_name_1&gt;
│   ├── image_1_GT.bmp # mask for image_1
│   ├── image_1_GT.txt # description of mask objects on the image_1
│   ├── image_2_GT.bmp
│   ├── image_2_GT.txt
│   ├── ...
│   └── images
│       ├── image_1.png
│       ├── image_2.png
│       ├── ...
├── &lt;subset_name_2&gt;
│   ├── ...
├── ...
</code></pre><p>See more information about adding datasets to the project in the
<a href="../../docs/user-manual/command-reference/sources/#source-add">docs</a>.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert ICDAR dataset into any other format
<a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>. Examples:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># converting ICDAR text segmentation dataset into the VOC with `convert` command</span>
datum convert -if icdar_text_segmentation -i source_dataset <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f voc -o export_dir -- --save-media
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># converting ICDAR text localization into the LabelMe through Datumaro project</span>
datum create
datum import -f icdar_text_localization source_dataset
datum <span style="color:#204a87">export</span> -f label_me -o ./export_dir -- --save-media
</code></pre></div><blockquote>
<p>Note: some formats have extra export options. For particular format see the
<a href="../../docs/formats/">docs</a> to get information about it.</p>
</blockquote>
<p>With Datumaro you can also convert your dataset to one of the ICDAR formats,
but to get expected result, the source dataset should contain required
attributes, described in previous section.</p>
<blockquote>
<p>Note: in case with <code>icdar_text_segmentation</code> format, if your dataset contains
masks without attribute <code>color</code> then it will be generated automatically.</p>
</blockquote>
<p>Available extra export options for ICDAR dataset formats:</p>
<ul>
<li><code>--save-media</code> allow to export dataset with saving media files
(by default <code>False</code>)</li>
<li><code>--image-ext IMAGE_EXT</code> allow to specify image extension
for exporting dataset (by default - keep original)</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-69397e43070456769c1b4fdb55f75baf">5.17 - Image zip</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>The image zip format allows to export/import unannotated datasets
with images to/from a zip archive. The format doesn&rsquo;t support any
annotations or attributes.</p>
<h2 id="import-image-zip-dataset">Import Image zip dataset</h2>
<p>There are several ways to import unannotated datasets to your Datumaro project:</p>
<ul>
<li>From an existing archive:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f image_zip ./images.zip
</code></pre></div><ul>
<li>From a directory with zip archives. Datumaro will import images from
all zip files in the directory:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f image_zip ./foo
</code></pre></div><p>The directory with zip archives must have the following structure:</p>
<pre><code>└── foo/
    ├── archive1.zip/
    |   ├── image_1.jpg
    |   ├── image_2.png
    |   ├── subdir/
    |   |   ├── image_3.jpg
    |   |   └── ...
    |   └── ...
    ├── archive2.zip/
    |   ├── image_101.jpg
    |   ├── image_102.jpg
    |   └── ...
    ...
</code></pre><p>Images in the archives must have a supported extension,
follow the <a href="../../docs/user-manual/media_formats/">user manual</a> to see the supported
extensions.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert image zip dataset into any other format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
For example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o project
datum import -p project -f image_zip ./images.zip
datum <span style="color:#204a87">export</span> -p project -f coco -o ./new_dir -- --save-media
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;image_zip&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;coco&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="export-an-unannotated-dataset-to-a-zip-archive">Export an unannotated dataset to a zip archive</h2>
<p>Example: exporting images from a VOC dataset to zip archives:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o project
datum import -p project -f voc ./VOC2012
datum <span style="color:#204a87">export</span> -p project -f image_zip -- --name voc_images.zip
</code></pre></div><p>Extra options for exporting to image_zip format:</p>
<ul>
<li><code>--save-media</code> allow to export dataset with saving media files
(default: <code>False</code>)</li>
<li><code>--image-ext &lt;IMAGE_EXT&gt;</code> allow to specify image extension
for exporting dataset (default: use original or <code>.jpg</code>, if none)</li>
<li><code>--name</code> name of output zipfile (default: <code>default.zip</code>)</li>
<li><code>--compression</code> allow to specify archive compression method.
Available methods:
<code>ZIP_STORED</code>, <code>ZIP_DEFLATED</code>, <code>ZIP_BZIP2</code>, <code>ZIP_LZMA</code> (default: <code>ZIP_STORED</code>).
Follow <a href="https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT">zip documentation</a>
for more information.</li>
</ul>
<h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_image_zip_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-91e6aa400d029f03bff463e9b96b334c">5.18 - ImageNet</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>ImageNet is one of the most popular datasets for image classification task,
this dataset is available for downloading
<a href="https://image-net.org/download.php">here</a></p>
<p>Supported types of annotations:</p>
<ul>
<li><code>Label</code></li>
</ul>
<p>Format doesn&rsquo;t support any attributes for annotations objects.</p>
<p>The original ImageNet dataset contains about 1.2M images and information
about class name for each image. Datumaro supports two versions of ImageNet
format: <code>imagenet</code> and <code>imagenet_txt</code>. The <code>imagenet_txt</code> format assumes storing
information about the class of the image in <code>*.txt</code> files. And <code>imagenet</code> format
assumes storing information about the class of the image in the name of
directory where is this image stored.</p>
<h2 id="import-imagenet-dataset">Import ImageNet dataset</h2>
<p>A Datumaro project with a ImageNet dataset can be created
in the following way:</p>
<pre><code>datum create
datum import -f imagenet &lt;path_to_dataset&gt;
# or
datum import -f imagenet_txt &lt;path_to_dataset&gt;
</code></pre><blockquote>
<p>Note: if you use <code>datum import</code> then &lt;path_to_dataset&gt; should not be a
subdirectory of directory with Datumaro project, see more information about
it in the <a href="../../docs/user-manual/command-reference/sources/#source-add">docs</a>.</p>
</blockquote>
<p>Load ImageNet dataset through the Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path_to_dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;imagenet_txt&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>For successful importing of ImageNet dataset the input directory with dataset
should has the following structure:</p>
<!--lint disable fenced-code-flag-->

  














  














<ul class="nav nav-tabs" id="tabs-0" role="tablist"><li class="nav-item">
      <a class="nav-link active"
        id="tabs-0-0-tab" data-toggle="tab" href="#tabs-0-0" role="tab"
        aria-controls="tabs-0-0" aria-selected="true">
        imagenet
      </a>
    </li><li class="nav-item">
      <a class="nav-link"
        id="tabs-0-1-tab" data-toggle="tab" href="#tabs-0-1" role="tab"
        aria-controls="tabs-0-1" aria-selected="false">
        imagenet_txt
      </a>
    </li></ul>


<div class="tab-content" id="tabs-0-content"><div class="tab-pane fade show active"
        id="tabs-0-0" role="tabpanel" aria-labelled-by="tabs-0-0-tab"><pre><code class="language-en" data-lang="en">imagenet_dataset/
├── label_0
│   ├── &lt;image_name_0&gt;.jpg
│   ├── &lt;image_name_1&gt;.jpg
│   ├── &lt;image_name_2&gt;.jpg
│   ├── ...
├── label_1
│    ├── &lt;image_name_0&gt;.jpg
│    ├── &lt;image_name_1&gt;.jpg
│    ├── &lt;image_name_2&gt;.jpg
│    ├── ...
├── ...
  </code></pre></div>
  <div class="tab-pane fade"
        id="tabs-0-1" role="tabpanel" aria-labelled-by="tabs-0-1-tab"><pre><code class="language-en" data-lang="en">imagenet_txt_dataset/
├── images # directory with images
│   ├── &lt;image_name_0&gt;.jpg
│   ├── &lt;image_name_1&gt;.jpg
│   ├── &lt;image_name_2&gt;.jpg
│   ├── ...
├── synsets.txt # optional, list of labels
└── train.txt   # list of pairs (image_name, label)
  </code></pre></div>
  
</div>

<blockquote>
<p>Note: if you don&rsquo;t have synsets file then Datumaro will automatically generate
classes with a name pattern <code>class-&lt;i&gt;</code>.</p>
</blockquote>
<p>Datumaro has few import options for <code>imagenet_txt</code> format, to apply them
use the <code>--</code> after the main command argument.</p>
<p><code>imagenet_txt</code> import options:</p>
<ul>
<li><code>--labels</code> {<code>file</code>, <code>generate</code>}: allow to specify where to get label
descriptions from (use <code>file</code> to load from the file specified
by <code>--labels-file</code>; <code>generate</code> to create generic ones)</li>
<li><code>--labels-file</code> allow to specify path to the file with label descriptions
(&ldquo;synsets.txt&rdquo;)</li>
</ul>
<h2 id="export-imagenet-dataset">Export ImageNet dataset</h2>
<p>Datumaro can convert ImageNet into any other format
<a href="../../docs/user-manual/supported_formats">Datumaro supports</a>.
To get the expected result, convert the dataset to a format
that supports <code>Label</code> annotation objects.</p>
<pre><code># Using `convert` command
datum convert -if imagenet -i &lt;path_to_imagenet&gt; \
    -f voc -o &lt;output_dir&gt; -- --save-media

# Using Datumaro project
datum create
datum import -f imagenet_txt &lt;path_to_imagenet&gt; -- --labels generate
datum export -f open_images -o &lt;output_dir&gt;
</code></pre><p>And also you can convert your ImageNet dataset using Python API</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">imagenet_dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path_to_dataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;imagenet&#39;</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#000">imagenet_dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;output_dir&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;vgg_face2&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><blockquote>
<p>Note: some formats have extra export options. For particular format see the
<a href="../../docs/formats/">docs</a> to get information about it.</p>
</blockquote>
<h2 id="export-dataset-to-the-imagenet-format">Export dataset to the ImageNet format</h2>
<p>If your dataset contains <code>Label</code> for images and you want to convert this
dataset into the ImagetNet format, you can use Datumaro for it:</p>
<pre><code># Using convert command
datum convert -if open_images -i &lt;path_to_oid&gt; \
    -f imagenet_txt -o &lt;output_dir&gt; -- --save-media --save-dataset-meta

# Using Datumaro project
datum create
datum import -f open_images &lt;path_to_oid&gt;
datum export -f imagenet -o &lt;output_dir&gt;
</code></pre><p>Extra options for exporting to ImageNet formats:</p>
<ul>
<li><code>--save-media</code> allow to export dataset with saving media files
(by default <code>False</code>)</li>
<li><code>--image-ext &lt;IMAGE_EXT&gt;</code> allow to specify image extension
for exporting the dataset (by default <code>.png</code>)</li>
<li><code>--save-dataset-meta</code> - allow to export dataset with saving dataset meta
file (by default <code>False</code>)</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c23396cbb18b060ffca5492eb3b20fe0">5.19 - Kinetics</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>Kinetics 400/600/700 is a video datasets for action recognition task.
Dataset is available for downloading
<a href="https://www.deepmind.com/open-source/kinetics">here</a></p>
<p>Supported media type:</p>
<ul>
<li><code>Video</code></li>
</ul>
<p>Supported type of annotations:</p>
<ul>
<li><code>Label</code></li>
</ul>
<p>Supported attributes for labels:</p>
<ul>
<li><code>time_start</code> (integer) - time (in seconds) of the start of recognized action</li>
<li><code>time_end</code> (integer) - time (in seconds) of the end of recognized action</li>
</ul>
<h2 id="import-kinetics-dataset">Import Kinetics dataset</h2>
<p>A Datumaro project with a Kinetics dataset can be created
in the following way using CLI:</p>
<pre><code>datum create
datum import -f kinetics &lt;path_to_dataset&gt;
</code></pre><p>Or using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path_to_dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;kinetics&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><pre><code>├── test.csv
├── train.json
├── train
│   ├── &lt;name_of_video_1_with_yt_id&gt;.avi # extension of video could be other
│   ├── &lt;name_of_video_2_with_yt_id&gt;.avi
│   ├── ...
└── test
    ├── &lt;name_of_video_100_with_yt_id&gt;.avi # extension of video could be other
    ├── &lt;name_of_video_101_with_yt_id&gt;.avi
    ├── ...
</code></pre><p>Kinetics dataset has two equivalent annotation file formats: <code>.csv</code> and
<code>.json</code>. Datumaro supports both, but in case when two annotation files have
same names but different extensions Datumaro will use <code>.csv</code>.</p>
<blockquote>
<p>Note: name of each video file must contain youtube_id of this video,
that specified in annotation file. And to speed up the import, you can leave
only the youtube_id in the video filename.</p>
</blockquote>
<p>See the full list of supported video extensions <a href="../../docs/user-manual/media_formats">here</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-342fda6e82df12e35a4cf02ae46d4bab">5.20 - KITTI</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>The KITTI dataset has many annotations for different tasks. Datumaro supports
only a few of them.</p>
<p>Supported tasks / formats:</p>
<ul>
<li><a href="http://www.cvlibs.net/datasets/kitti/eval_object.php?obj_benchmark">Object Detection</a> - <code>kitti_detection</code>
The format specification is available in <code>README.md</code> <a href="https://s3.eu-central-1.amazonaws.com/avg-kitti/devkit_object.zip">here</a>.</li>
<li><a href="http://www.cvlibs.net/datasets/kitti/eval_semseg.php?benchmark=semantics2015">Segmentation</a> - <code>kitti_segmentation</code>
The format specification is available in <code>README.md</code> <a href="https://s3.eu-central-1.amazonaws.com/avg-kitti/devkit_semantics.zip">here</a>.</li>
<li>Raw 3D / Velodyne Points - described <a href="../../docs/formats/kitti_raw">here</a></li>
</ul>
<p>Supported annotation types:</p>
<ul>
<li><code>Bbox</code> (object detection)</li>
<li><code>Mask</code> (segmentation)</li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li><code>truncated</code> (boolean) - indicates that the bounding box specified for
the object does not correspond to the full extent of the object</li>
<li><code>occluded</code> (boolean) - indicates that a significant portion of the object
within the bounding box is occluded by another object</li>
<li><code>score</code> (float) - indicates confidence in detection</li>
</ul>
<h2 id="import-kitti-dataset">Import KITTI dataset</h2>
<p>The KITTI left color images for object detection are available <a href="http://www.cvlibs.net/download.php?file=data_object_image_2.zip">here</a>.
The KITTI object detection labels are available <a href="http://www.cvlibs.net/download.php?file=data_object_label_2.zip">here</a>.
The KITTI segmentation dataset is available <a href="http://www.cvlibs.net/download.php?file=data_semantics.zip">here</a>.</p>
<p>A Datumaro project with a KITTI source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format kitti &lt;path/to/dataset&gt;
</code></pre></div><p>It is possible to specify project name and project directory. Run
<code>datum create --help</code> for more information.</p>
<p>KITTI detection dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── testing/
    │   └── image_2/
    │       ├── &lt;name_1&gt;.&lt;img_ext&gt;
    │       ├── &lt;name_2&gt;.&lt;img_ext&gt;
    │       └── ...
    └── training/
        ├── image_2/ # left color camera images
        │   ├── &lt;name_1&gt;.&lt;img_ext&gt;
        │   ├── &lt;name_2&gt;.&lt;img_ext&gt;
        │   └── ...
        └─── label_2/ # left color camera label files
            ├── &lt;name_1&gt;.txt
            ├── &lt;name_2&gt;.txt
            └── ...
</code></pre><p>KITTI segmentation dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── dataset_meta.json # a list of non-format labels (optional)
    ├── label_colors.txt # optional, color map for non-original segmentation labels
    ├── testing/
    │   └── image_2/
    │       ├── &lt;name_1&gt;.&lt;img_ext&gt;
    │       ├── &lt;name_2&gt;.&lt;img_ext&gt;
    │       └── ...
    └── training/
        ├── image_2/ # left color camera images
        │   ├── &lt;name_1&gt;.&lt;img_ext&gt;
        │   ├── &lt;name_2&gt;.&lt;img_ext&gt;
        │   └── ...
        ├── label_2/ # left color camera label files
        │   ├── &lt;name_1&gt;.txt
        │   ├── &lt;name_2&gt;.txt
        │   └── ...
        ├── instance/ # instance segmentation masks
        │   ├── &lt;name_1&gt;.png
        │   ├── &lt;name_2&gt;.png
        │   └── ...
        ├── semantic/ # semantic segmentation masks (labels are encoded by its id)
        │   ├── &lt;name_1&gt;.png
        │   ├── &lt;name_2&gt;.png
        │   └── ...
        └── semantic_rgb/ # semantic segmentation masks (labels are encoded by its color)
            ├── &lt;name_1&gt;.png
            ├── &lt;name_2&gt;.png
            └── ...
</code></pre><p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>
and <code>label_colors.txt</code>.
If the <code>dataset_meta.json</code> is not represented in the dataset, then
<code>label_colors.txt</code> will be imported if possible.</p>
<p>You can import a dataset for specific tasks
of KITTI dataset instead of the whole dataset,
for example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import --format kitti_detection &lt;path/to/dataset&gt;
</code></pre></div><p>To make sure that the selected dataset has been added to the project, you can
run <code>datum project info</code>, which will display the project information.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert a KITTI dataset into any other format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.</p>
<p>Such conversion will only be successful if the output
format can represent the type of dataset you want to convert,
e.g. segmentation annotations can be
saved in <code>Cityscapes</code> format, but not as <code>COCO keypoints</code>.</p>
<p>There are several ways to convert a KITTI dataset to other dataset formats:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f kitti &lt;path/to/kitti&gt;
datum <span style="color:#204a87">export</span> -f cityscapes -o &lt;output/dir&gt;
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if kitti -i &lt;path/to/kitti&gt; -f cityscapes -o &lt;output/dir&gt;
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;kitti&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;cityscapes&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="export-to-kitti">Export to KITTI</h2>
<p>There are several ways to convert a dataset to KITTI format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into KITTI format from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f kitti -o &lt;output/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- --save-media
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># converting to KITTI format from other format</span>
datum convert -if cityscapes -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f kitti -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Extra options for exporting to KITTI format:</p>
<ul>
<li><code>--save-media</code> allow to export dataset with saving media files
(by default <code>False</code>)</li>
<li><code>--image-ext IMAGE_EXT</code> allow to specify image extension
for exporting dataset (by default - keep original or use <code>.png</code>, if none)</li>
<li><code>--save-dataset-meta</code> - allow to export dataset with saving dataset meta
file (by default <code>False</code>)</li>
<li><code>--apply-colormap APPLY_COLORMAP</code> allow to use colormap for class masks
(in folder <code>semantic_rgb</code>, by default <code>True</code>)</li>
<li><code>--label_map</code> allow to define a custom colormap. Example:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># mycolormap.txt :</span>
<span style="color:#8f5902;font-style:italic"># 0 0 255 sky</span>
<span style="color:#8f5902;font-style:italic"># 255 0 0 person</span>
<span style="color:#8f5902;font-style:italic">#...</span>
datum <span style="color:#204a87">export</span> -f kitti -- --label-map mycolormap.txt

</code></pre></div><p>or you can use original kitti colomap:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum <span style="color:#204a87">export</span> -f kitti -- --label-map kitti
</code></pre></div><ul>
<li><code>--tasks TASKS</code> allow to specify tasks for export dataset,
by default Datumaro uses all tasks. Example:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum <span style="color:#204a87">export</span> -f kitti -- --tasks detection
</code></pre></div><ul>
<li><code>--allow-attributes ALLOW_ATTRIBUTES</code> allow export of attributes
(by default <code>True</code>).</li>
</ul>
<h2 id="examples">Examples</h2>
<p>Datumaro supports filtering, transformation, merging etc. for all formats
and for the KITTI format in particular. Follow the
<a href="../../docs/user-manual/">user manual</a>
to get more information about these operations.</p>
<p>There are several examples of using Datumaro operations to solve
particular problems with KITTI dataset:</p>
<h3 id="example-1-how-to-load-an-original-kitti-dataset-and-convert-to-cityscapes">Example 1. How to load an original KITTI dataset and convert to Cityscapes</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o project
datum import -p project -f kitti ./KITTI/
datum stats -p project
datum <span style="color:#204a87">export</span> -p project -f cityscapes -- --save-media
</code></pre></div><h3 id="example-2-how-to-create-a-custom-kitti-like-dataset">Example 2. How to create a custom KITTI-like dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">numpy</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">np</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro.plugins.kitti_format</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">KITTI</span>

<span style="color:#000">label_map</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{}</span>
<span style="color:#000">label_map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;background&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">label_map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;label_1&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">label_map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;label_2&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">categories</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">KITTI</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">make_kitti_categories</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">label_map</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">([</span>
  <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)),</span>
    <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
      <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Mask</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">array</span><span style="color:#000;font-weight:bold">([[</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]]),</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;is_crowd&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">False</span><span style="color:#000;font-weight:bold">}),</span>
      <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Mask</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">array</span><span style="color:#000;font-weight:bold">([[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]]),</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;is_crowd&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">False</span><span style="color:#000;font-weight:bold">}),</span>
    <span style="color:#000;font-weight:bold">]</span>
  <span style="color:#000;font-weight:bold">),</span>
<span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">categories</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./dataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;kitti&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_kitti_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-3a73527e621d046bb88cc355b73eb8dd">5.21 - LFW</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p><a href="http://vis-www.cs.umass.edu/lfw/">LFW (Labeled Faces in the Wild Home)</a>
it&rsquo;s dataset for face identification task,
specification for this format is available
<a href="http://vis-www.cs.umass.edu/lfw/README.txt">here</a>.
You can also download original LFW dataset
<a href="http://vis-www.cs.umass.edu/lfw/#download">here</a>.</p>
<p>Original dataset contains images with people faces.
For each image contains information about person&rsquo;s name, as well as
information about images that matched with this person
and mismatched with this person.
Also LFW contains additional information about landmark points on the face.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Label</code></li>
<li><code>Points</code> (face landmark points)</li>
</ul>
<p>Supported attributes:</p>
<ul>
<li><code>negative_pairs</code>: list with names of mismatched persons;</li>
<li><code>positive_pairs</code>: list with names of matched persons;</li>
</ul>
<h2 id="import-lfw-dataset">Import LFW dataset</h2>
<p>Importing LFW dataset into the Datumaro project:</p>
<pre><code>datum create
datum import -f lfw &lt;path_to_lfw_dataset&gt;
</code></pre><p>See more information about adding datasets to the project in the
<a href="../../docs/user-manual/command-reference/sources/#source-add">docs</a>.</p>
<p>Also you can import LFW dataset from Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">lfw_dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path_to_lfw_dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;lfw&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>For successful importing the LFW dataset, the directory with it
should has the following structure:</p>
<pre><code>&lt;path_to_lfw_dataset&gt;/
├── subset_1
│    ├── annotations
│    │   ├── landmarks.txt # list with landmark points for each image
│    │   ├── pairs.txt # list of matched and mismatched pairs of person
│    │   └── people.txt # optional file with a list of persons name
│    └── images
│        ├── name0
│        │   ├── name0_0001.jpg
│        │   ├── name0_0002.jpg
│        │   ├── ...
│        ├── name1
│        │   ├── name1_0001.jpg
│        │   ├── name1_0002.jpg
│        │   ├── ...
├── subset_2
│    ├── ...
├── ...
</code></pre><p>Full description of annotation <code>*.txt</code> files available
<a href="http://vis-www.cs.umass.edu/lfw/README.txt">here</a>.</p>
<h2 id="export-lfw-dataset">Export LFW dataset</h2>
<p>With Datumaro you can convert LFW dataset into any other
format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
Pay attention that this format should also support <code>Label</code> and/or <code>Points</code>
annotation types.</p>
<p>There is few ways to convert LFW dataset into other format:</p>
<pre><code># Converting to ImageNet with `convert` command:
datum convert -if lfw -i ./lfw_dataset \
    -f imagenet -o ./output_dir -- --save-media

# Converting to VggFace2 through the Datumaro project:
datum create
datum add -f lfw ./lfw_dataset
datum export -f vgg_face2 -o ./output_dir2
</code></pre><blockquote>
<p>Note: some formats have extra export options. For particular format see the
<a href="../../docs/formats/">docs</a> to get information about it.</p>
</blockquote>
<h2 id="export-dataset-to-the-lfw-format">Export dataset to the LFW format</h2>
<p>With Datumaro you can export dataset that has <code>Label</code> or/and <code>Points</code>
annotations to the LFW format, example:</p>
<pre><code># Converting VGG Face2 dataset into the LFW format
datum convert -if vgg_face2 -i ./voc_dataset \
    -f lfw -o ./output_dir


# Export dataaset to the LFW format through the Datumaro project:
datum create
datum import -f voc_classification ../vgg_dataset
datum export -f lfw -o ./output_dir -- --save-media --image-ext png
</code></pre><p>Available extra export options for LFW dataset format:</p>
<ul>
<li><code>--save-media</code> allow to export dataset with saving media files
(by default <code>False</code>)</li>
<li><code>--image-ext IMAGE_EXT</code> allow to specify image extension
for exporting dataset (by default - keep original)</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-1e4c6d683fee0e4d48d435e66064eab9">5.22 - Mapillary Vistas</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>Mapillary Vistas dataset homepage is available
<a href="https://www.mapillary.com/dataset/vistas">here</a>.
After registration the dataset will be available for downloading.
The specification for this format contains in the root directory of original
dataset.</p>
<p>Supported annotation types:
- <code>Mask</code> (class, instances, panoptic)
- <code>Polygon</code></p>
<p>Supported atttibutes:
- <code>is_crowd</code>(boolean; on panoptic <code>mask</code>): Indicates that the annotation
covers multiple instances of the same class.</p>
<h2 id="import-mapillary-vistas-dataset">Import Mapillary Vistas dataset</h2>
<p>Use these instructions to import Mapillary Vistas dataset into Datumaro project:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum add -f mapillary_vistas ./dataset
</code></pre></div><blockquote>
<p>Note: the directory with dataset should be subdirectory of the
project directory.</p>
</blockquote>
<!-- markdownlint-disable-line MD028 -->
<blockquote>
<p>Note: there is no opportunity to import both instance and panoptic
masks for one dataset.</p>
</blockquote>
<p>Use one of subformats (<code>mapillary_vistas_instances</code>, <code>mapillary_vistas_panoptic</code>),
if your dataset contains both panoptic and instance masks:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum add -f mapillary_vistas_instances ./dataset
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum add -f mapillary_vistas_panoptic ./dataset
</code></pre></div><p>Extra options for adding a source in the Mapillary Vistas format:</p>
<ul>
<li><code>--use-original-config</code>: Use original <code>config_*.json</code> file for your version of
Mapillary Vistas dataset. This options can helps to import dataset, in case
when you don&rsquo;t have <code>config_*.json</code> file, but your dataset is using original
categories of Mapillary Vistas dataset. The version of dataset will be detect
by the name of annotation directory in your dataset (v1.2 or v2.0).</li>
<li><code>--keep-original-category-ids</code>: Add dummy label categories so that
category indexes in the imported data source correspond to the category IDs
in the original annotation file.</li>
</ul>
<p>Example of using extra options:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum add -f mapillary_vistas ./dataset -- --use-original-config
</code></pre></div><p>Mapillary Vistas dataset has two versions: v1.2, v2.0.
They differ in the number of classes, the name of the classes, supported types
of annotations, and the names of the directory with annotations.
So, the directory with dataset should have one of these structures:</p>
<!--lint disable fenced-code-flag-->

  














  














  














  














<ul class="nav nav-tabs" id="tabs-0" role="tablist"><li class="nav-item">
      <a class="nav-link active"
        id="tabs-0-0-tab" data-toggle="tab" href="#tabs-0-0" role="tab"
        aria-controls="tabs-0-0" aria-selected="true">
        v1.2
      </a>
    </li><li class="nav-item">
      <a class="nav-link"
        id="tabs-0-1-tab" data-toggle="tab" href="#tabs-0-1" role="tab"
        aria-controls="tabs-0-1" aria-selected="false">
        v2.0
      </a>
    </li><li class="nav-item">
      <a class="nav-link"
        id="tabs-0-2-tab" data-toggle="tab" href="#tabs-0-2" role="tab"
        aria-controls="tabs-0-2" aria-selected="false">
        v1.2 w/o subsets
      </a>
    </li><li class="nav-item">
      <a class="nav-link"
        id="tabs-0-3-tab" data-toggle="tab" href="#tabs-0-3" role="tab"
        aria-controls="tabs-0-3" aria-selected="false">
        v2.0 w/o subsets
      </a>
    </li></ul>


<div class="tab-content" id="tabs-0-content"><div class="tab-pane fade show active"
        id="tabs-0-0" role="tabpanel" aria-labelled-by="tabs-0-0-tab"><pre><code class="language-en" data-lang="en">dataset
├── dataset_meta.json # a list of custom labels (optional)
├── config_v1.2.json # config file with description of classes (id, color, name)
├── &lt;subset_name1&gt;
│   ├── images
│   │   ├── &lt;image_name1&gt;.jpg
│   │   ├── &lt;image_name2&gt;.jpg
│   │   ├── ...
│   └── v1.2
│       ├── instances # directory with instance masks
│       │   └── &lt;image_name1&gt;.png
│       │   ├── &lt;image_name2&gt;.png
│       │   ├── ...
│       └── labels # directory with class masks
│           └── &lt;image_name1&gt;.png
│           ├── &lt;image_name2&gt;.png
│           ├── ...
├── &lt;subset_name2&gt;
│   ├── ...
├── ...
  </code></pre></div>
  <div class="tab-pane fade"
        id="tabs-0-1" role="tabpanel" aria-labelled-by="tabs-0-1-tab"><pre><code class="language-en" data-lang="en">dataset
├── config_v2.0.json
├── &lt;subset_name1&gt; # config file with description of classes (id, color, name)
│   ├── images
│   │   ├── &lt;image_name1&gt;.jpg
│   │   ├── &lt;image_name2&gt;.jpg
│   │   ├── ...
│   └── v2.0
│       ├── instances # directory with instance masks
│       │   ├── &lt;image_name1&gt;.png
│       │   ├── &lt;image_name2&gt;.png
│       │   ├── ...
│       ├── labels # directory with class masks
│       │   ├── &lt;image_name1&gt;.png
│       │   ├── &lt;image_name2&gt;.png
│       │   ├── ...
│       ├── panoptic # directory with panoptic masks and panoptic config file
│       │   ├── panoptic_2020.json # description of classes and annotations
│       │   ├── &lt;image_name1&gt;.png
│       │   ├── &lt;image_name2&gt;.png
│       │   ├── ...
│       └── polygons # directory with description of polygons
│           ├── &lt;image_name1&gt;.json
│           ├── &lt;image_name2&gt;.json
│           ├── ...
├── &lt;subset_name2&gt;
    ├── ...
├── ...
  </code></pre></div>
  <div class="tab-pane fade"
        id="tabs-0-2" role="tabpanel" aria-labelled-by="tabs-0-2-tab"><pre><code class="language-en" data-lang="en">dataset
├── config_v1.2.json # config file with description of classes (id, color, name)
├── images
│   ├── &lt;image_name1&gt;.jpg
│   ├── &lt;image_name2&gt;.jpg
│   ├── ...
└── v1.2
    ├── instances # directory with instance masks
    │   └── &lt;image_name1&gt;.png
    │   ├── &lt;image_name2&gt;.png
    │   ├── ...
    └── labels # directory with class masks
        └── &lt;image_name1&gt;.png
        ├── &lt;image_name2&gt;.png
        ├── ...
  </code></pre></div>
  <div class="tab-pane fade"
        id="tabs-0-3" role="tabpanel" aria-labelled-by="tabs-0-3-tab"><pre><code class="language-en" data-lang="en">dataset
├── config_v2.0.json
├── images
│   ├── &lt;image_name1&gt;.jpg
│   ├── &lt;image_name2&gt;.jpg
│   ├── ...
└── v2.0
    ├── instances # directory with instance masks
    │   ├── &lt;image_name1&gt;.png
    │   ├── &lt;image_name2&gt;.png
    │   ├── ...
    ├── labels # directory with class masks
    │   ├── &lt;image_name1&gt;.png
    │   ├── &lt;image_name2&gt;.png
    │   ├── ...
    ├── panoptic # directory with panoptic masks and panoptic config file
    │   ├── panoptic_2020.json # description of classes and annotation objects
    │   ├── &lt;image_name1&gt;.png
    │   ├── &lt;image_name2&gt;.png
    │   ├── ...
    └── polygons # directory with description of polygons
        ├── &lt;image_name1&gt;.json
        ├── &lt;image_name2&gt;.json
        ├── ...
  </code></pre></div>
  
</div>

<p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>.</p>
<p>See examples of annotation files in
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/mapillary_vistas_dataset">test assets</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-bbc15af9ed7559fac248c0c8bbffadd9">5.23 - Market-1501</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>Market-1501 is a dataset for person re-identification task, link
for downloading this dataset is available
<a href="https://zheng-lab.cecs.anu.edu.au/Project/project_reid.html">here</a>.</p>
<p>Supported items attributes:</p>
<ul>
<li><code>person_id</code> (str): four-digit number that represent ID of pedestrian;</li>
<li><code>camera_id</code> (int): one-digit number that represent ID of camera that took
the image (original dataset has totally 6 cameras);</li>
<li><code>track_id</code> (int): one-digit number that represent ID of the track with
the particular pedestrian, this attribute matches with <code>sequence_id</code>
in the original dataset;</li>
<li><code>frame_id</code> (int): six-digit number, that mean number of
frame within this track. For the tracks, their names are accumulated
for each ID, but for frames, they start from &ldquo;0001&rdquo; in each track;</li>
<li><code>bbox_id</code> (int): two-digit number, that mean number of
bounding bbox that was selected for that image
(see the
<a href="https://zheng-lab.cecs.anu.edu.au/Project/project_reid.html">original docs</a>
for more info).</li>
</ul>
<p>These item attributes decodes into the image name with such convention:</p>
<pre><code>0000_c1s1_000000_00.jpg
</code></pre><ul>
<li>first four digits indicate the <code>person_id</code>;</li>
<li>digit after <code>c</code> indicates the <code>camera_id</code>;</li>
<li>digit after <code>s</code> indicate the <code>track_id</code>;</li>
<li>six digits after <code>s1_</code> indicate the <code>frame_id</code>;</li>
<li>the last two digits before <code>.jpg</code> indicate the <code>bbox_id</code>.</li>
</ul>
<h2 id="import-market-1501-dataset">Import Market-1501 dataset</h2>
<p>Importing of Market-1501 dataset into the Datumaro project:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f market1501 &lt;path_to_market1501&gt;
</code></pre></div><p>See more information about adding datasets to the project in the
<a href="../../docs/user-manual/command-reference/sources/#source-add">docs</a>.</p>
<p>Or you can import Market-1501 using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>
<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path_to_dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;market1501&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>For successful importing the Market-1501 dataset, the directory with it
should has the following structure:</p>
<pre><code>market1501_dataset/
├── query # optional directory with query image
│   ├── 0001_c1s1_001051_00.jpg
│   ├── 0002_c1s1_001051_00.jpg
│   ├── ...
├── bounding_box_&lt;subset_name1&gt;
│   ├── 0003_c1s1_001051_00.jpg
│   ├── 0003_c2s1_001054_01.jpg
│   ├── 0004_c1s1_001051_00.jpg
│   ├── ...
├── bounding_box_&lt;subset_name2&gt;
│   ├── 0005_c1s1_001051_00.jpg
│   ├── 0006_c1s1_001051_00.jpg
│   ├── ...
├── ...
</code></pre><h2 id="export-dataset-to-the-market-1501-format">Export dataset to the Market-1501 format</h2>
<p>With Datumaro you can export dataset, that has <code>person_id</code> item attribute,
to the Market-1501 format, example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># Converting MARS dataset into the Market-1501</span>
datum convert -if mars -i ./mars_dataset <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f market1501 -o ./output_dir
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># Export dataaset to the Market-1501 format through the Datumaro project:</span>
datum create
datum add -f mars ../mars
datum <span style="color:#204a87">export</span> -f market1501 -o ./output_dir -- --save-media --image-ext png
</code></pre></div><blockquote>
<p>Note: if your dataset contains only person_id attributes Datumaro
will assign default values for other attributes (camera_id, track_id, bbox_id)
and increment frame_id for collisions.</p>
</blockquote>
<p>Available extra export options for Market-1501 dataset format:</p>
<ul>
<li><code>--save-media</code> allow to export dataset with saving media files
(by default <code>False</code>)</li>
<li><code>--image-ext IMAGE_EXT</code> allow to specify image extension
for exporting dataset (by default - keep original)</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-bf920c551f5225f4f58da3de45a4a820">5.24 - MARS</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>MARS is a dataset for the motion analysis and person identification task.
MARS dataset is available for downloading
<a href="https://zheng-lab.cecs.anu.edu.au/Project/project_mars.html">here</a></p>
<p>Supported types of annotations:</p>
<ul>
<li><code>Bbox</code></li>
</ul>
<p>Required attributes:</p>
<ul>
<li><code>person_id</code> (str): four-digit number that represent ID of pedestrian;</li>
<li><code>camera_id</code> (int): one-digit number that represent ID of camera that took
the image (original dataset has totally 6 cameras);</li>
<li><code>track_id</code> (int): four-digit number that represent ID of the track with
the particular pedestrian;</li>
<li><code>frame_id</code> (int): three-digit number, that mean number of
frame within this track. For the tracks, their names are accumulated
for each ID, but for frames, they start from &ldquo;0001&rdquo; in each track.</li>
</ul>
<h2 id="import-mars-dataset">Import MARS dataset</h2>
<p>Use these instructions to import MARS dataset into Datumaro project:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum add -f mars ./dataset
</code></pre></div><blockquote>
<p>Note: the directory with dataset should be subdirectory of the
project directory.</p>
</blockquote>
<pre><code>mars_dataset
├── &lt;bbox_subset_name1&gt;
│   ├── 0001 # directory with images of pedestrian with id 0001
│   │   ├── 0001C1T0001F001.jpg
│   │   ├── 0001C1T0001F002.jpg
│   │   ├── ...
│   ├── 0002 # directory with images of pedestrian with id 0002
│   │   ├── 0002C1T0001F001.jpg
│   │   ├── 0002C1T0001F001.jpg
│   │   ├── ...
│   ├── 0000 # distractors images, which negatively affect retrieval accuracy.
│   │   ├── 0000C1T0001F001.jpg
│   │   ├── 0000C1T0001F001.jpg
│   │   ├── ...
│   ├── 00-1 # junk images which do not affect retrieval accuracy
│   │   ├── 00-1C1T0001F001.jpg
│   │   ├── 00-1C1T0001F001.jpg
│   │   ├── ...
├── &lt;bbox_subset_name2&gt;
│   ├── ...
├── ...
</code></pre><p>All images in MARS dataset follow a strict convention of naming:</p>
<pre><code>xxxxCxTxxxxFxxx.jpg
</code></pre><ul>
<li>the first four digits indicate the pedestrian&rsquo;s number;</li>
<li>digit after <code>C</code> indicates the camera id;</li>
<li>four digits after <code>T</code> indicate the track id for this pedestrian;</li>
<li>three digits after <code>F</code> indicate the frame id with this track.</li>
</ul>
<blockquote>
<p>Note: there are two specific pedestrian IDs 0000 and 00-1
which indicate distracting images and unwanted images respectively.</p>
</blockquote>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a2db7ecd3bd406d8822366b9b33229dd">5.25 - MNIST</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>MNIST format specification is available <a href="http://yann.lecun.com/exdb/mnist/">here</a>.</p>
<p>Fashion MNIST format specification is available <a href="https://github.com/zalandoresearch/fashion-mnist">here</a>.</p>
<p>MNIST in CSV  format specification is available <a href="https://pjreddie.com/projects/mnist-in-csv/">here</a>.</p>
<p>The dataset has several data formats available. Datumaro supports the
binary (Python pickle) format and the CSV variant. Each data format is covered
by a separate Datumaro format.</p>
<p>Supported formats:</p>
<ul>
<li>Binary (Python pickle) - <code>mnist</code></li>
<li>CSV - <code>mnist_csv</code></li>
</ul>
<p>Supported annotation types:</p>
<ul>
<li><code>Label</code></li>
</ul>
<p>The format only supports single channel 28 x 28 images.</p>
<h2 id="import-mnist-dataset">Import MNIST dataset</h2>
<p>The MNIST dataset is available for free download:</p>
<ul>
<li><a href="https://ossci-datasets.s3.amazonaws.com/mnist/train-images-idx3-ubyte.gz">train-images-idx3-ubyte.gz</a>:
training set images</li>
<li><a href="https://ossci-datasets.s3.amazonaws.com/mnist/train-labels-idx1-ubyte.gz">train-labels-idx1-ubyte.gz</a>:
training set labels</li>
<li><a href="https://ossci-datasets.s3.amazonaws.com/mnist/t10k-images-idx3-ubyte.gz">t10k-images-idx3-ubyte.gz</a>:
test set images</li>
<li><a href="https://ossci-datasets.s3.amazonaws.com/mnist/t10k-labels-idx1-ubyte.gz">t10k-labels-idx1-ubyte.gz</a>:
test set labels</li>
</ul>
<p>The Fashion MNIST dataset is available for free download:</p>
<ul>
<li><a href="http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-images-idx3-ubyte.gz">train-images-idx3-ubyte.gz</a>:
training set images</li>
<li><a href="http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-labels-idx1-ubyte.gz">train-labels-idx1-ubyte.gz</a>:
training set labels</li>
<li><a href="http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-images-idx3-ubyte.gz">t10k-images-idx3-ubyte.gz</a>:
test set images</li>
<li><a href="http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-labels-idx1-ubyte.gz">t10k-labels-idx1-ubyte.gz</a>:
test set labels</li>
</ul>
<p>The MNIST in CSV dataset is available for free download:</p>
<ul>
<li><a href="https://pjreddie.com/media/files/mnist_train.csv">mnist_train.csv</a></li>
<li><a href="https://pjreddie.com/media/files/mnist_test.csv">mnist_test.csv</a></li>
</ul>
<p>A Datumaro project with a MNIST source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format mnist &lt;path/to/dataset&gt;
datum import --format mnist_csv &lt;path/to/dataset&gt;
</code></pre></div><p>MNIST dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── dataset_meta.json # a list of non-format labels (optional)
    ├── labels.txt # a list of non-digit labels  in other format (optional)
    ├── t10k-images-idx3-ubyte.gz
    ├── t10k-labels-idx1-ubyte.gz
    ├── train-images-idx3-ubyte.gz
    └── train-labels-idx1-ubyte.gz
</code></pre><p>MNIST in CSV dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── dataset_meta.json # a list of non-format labels (optional)
    ├── labels.txt # a list of non-digit labels  in other format (optional)
    ├── mnist_test.csv
    └── mnist_train.csv
</code></pre><p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>
and <code>labels.txt</code>.
If the <code>dataset_meta.json</code> is not represented in the dataset, then
<code>labels.txt</code> will be imported if possible.</p>
<p>For example, <code>labels.txt</code> for Fashion MNIST the following contents:</p>
<!--lint disable fenced-code-flag-->
<pre><code>T-shirt/top
Trouser
Pullover
Dress
Coat
Sandal
Shirt
Sneaker
Bag
Ankle boot
</code></pre><h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert a MNIST dataset into any other format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to formats
that support the classification task (e.g. CIFAR-10/100, ImageNet, PascalVOC,
etc.)</p>
<p>There are several ways to convert a MNIST dataset to other dataset formats:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f mnist &lt;path/to/mnist&gt;
datum <span style="color:#204a87">export</span> -f imagenet -o &lt;output/dir&gt;
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if mnist -i &lt;path/to/mnist&gt; -f imagenet -o &lt;output/dir&gt;
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;mnist&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;imagenet&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>These steps also will work for MNIST in CSV, if you use <code>mnist_csv</code>
instead of <code>mnist</code>.</p>
<h2 id="export-to-mnist">Export to MNIST</h2>
<p>There are several ways to convert a dataset to MNIST format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into MNIST format from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f mnist -o &lt;output/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- --save-media
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># converting to MNIST format from other format</span>
datum convert -if imagenet -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f mnist -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Extra options for exporting to MNIST format:</p>
<ul>
<li><code>--save-media</code> allow to export dataset with saving media files
(by default <code>False</code>)</li>
<li><code>--image-ext &lt;IMAGE_EXT&gt;</code> allow to specify image extension
for exporting dataset (by default <code>.png</code>)</li>
<li><code>--save-dataset-meta</code> - allow to export dataset with saving dataset meta
file (by default <code>False</code>)</li>
</ul>
<p>These commands also work for MNIST in CSV if you use <code>mnist_csv</code> instead of <code>mnist</code>.</p>
<h2 id="examples">Examples</h2>
<p>Datumaro supports filtering, transformation, merging etc. for all formats
and for the MNIST format in particular. Follow the <a href="../../docs/user-manual/">user manual</a>
to get more information about these operations.</p>
<p>There are several examples of using Datumaro operations to solve
particular problems with MNIST dataset:</p>
<h3 id="example-1-how-to-create-a-custom-mnist-like-dataset">Example 1. How to create a custom MNIST-like dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">numpy</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">np</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">([</span>
    <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">28</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">28</span><span style="color:#000;font-weight:bold">)),</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Label</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)]</span>
    <span style="color:#000;font-weight:bold">),</span>
    <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">28</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">28</span><span style="color:#000;font-weight:bold">)),</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Label</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">)]</span>
    <span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#204a87">str</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">label</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">label</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#204a87">range</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">)])</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./dataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;mnist&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h3 id="example-2-how-to-filter-and-convert-a-mnist-dataset-to-imagenet">Example 2. How to filter and convert a MNIST dataset to ImageNet</h3>
<p>Convert MNIST dataset to ImageNet format, keep only images with <code>3</code> class
presented:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># Download MNIST dataset:</span>
<span style="color:#8f5902;font-style:italic"># https://ossci-datasets.s3.amazonaws.com/mnist/train-images-idx3-ubyte.gz</span>
<span style="color:#8f5902;font-style:italic"># https://ossci-datasets.s3.amazonaws.com/mnist/train-labels-idx1-ubyte.gz</span>
datum convert --input-format mnist --input-path &lt;path/to/mnist&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>              --output-format imagenet <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>              --filter <span style="color:#4e9a06">&#39;/item[annotation/label=&#34;3&#34;]&#39;</span>
</code></pre></div><p>Examples of using this format from the code can be found in
the <a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_mnist_format.py">binary format tests</a> and <a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_mnist_csv_format.py">csv format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-333c850baac99b48bc21f68354e1eddc">5.26 - MPII Human Pose Dataset</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>The original MPII Human Pose Dataset is available
<a href="http://human-pose.mpi-inf.mpg.de">here</a>.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Bbox</code></li>
<li><code>Points</code></li>
</ul>
<p>Supported attributes:</p>
<ul>
<li><code>center</code> (a list with two coordinates of the center point
of the object)</li>
<li><code>scale</code> (float)</li>
</ul>
<h2 id="import-mpii-human-pose-dataset">Import MPII Human Pose Dataset</h2>
<p>A Datumaro project with an MPII Human Pose Dataset source can be
created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format mpii &lt;path/to/dataset&gt;
</code></pre></div><p>It is also possible to import the dataset using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">mpii_dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;mpii&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>MPII Human Pose Dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>dataset/
├── mpii_human_pose_v1_u12_1.mat
├── 000000001.jpg
├── 000000002.jpg
├── 000000003.jpg
└── ...
</code></pre><h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert an MPII Human Pose Dataset into
any other format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to a format
that supports bounding boxes or points.</p>
<p>There are several ways to convert an MPII Human Pose Dataset
to other dataset formats using CLI:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f mpii &lt;path/to/dataset&gt;
datum <span style="color:#204a87">export</span> -f voc -o ./save_dir -- --save-media
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if mpii -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f voc -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;mpii&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/test_mpii_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-2a1b098a1d0fff03296325f67eaafc8b">5.27 - MPII Human Pose Dataset (JSON)</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>The original MPII Human Pose Dataset is available
<a href="http://human-pose.mpi-inf.mpg.de">here</a>.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Bbox</code></li>
<li><code>Points</code></li>
</ul>
<p>Supported attributes:</p>
<ul>
<li><code>center</code> (a list with two coordinates of the center point
of the object)</li>
<li><code>scale</code> (float)</li>
</ul>
<h2 id="import-mpii-human-pose-dataset-json">Import MPII Human Pose Dataset (JSON)</h2>
<p>A Datumaro project with an MPII Human Pose Dataset (JSON) source can be
created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format mpii_json &lt;path/to/dataset&gt;
</code></pre></div><p>It is also possible to import the dataset using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">mpii_dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;mpii_json&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>MPII Human Pose Dataset (JSON) directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>dataset/
├── jnt_visible.npy # optional
├── mpii_annotations.json
├── mpii_headboxes.npy # optional
├── mpii_pos_gt.npy # optional
├── 000000001.jpg
├── 000000002.jpg
├── 000000003.jpg
└── ...
</code></pre><h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert an MPII Human Pose Dataset (JSON) into
any other format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to a format
that supports bounding boxes or points.</p>
<p>There are several ways to convert an MPII Human Pose Dataset (JSON)
to other dataset formats using CLI:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f mpii_json &lt;path/to/dataset&gt;
datum <span style="color:#204a87">export</span> -f voc -o ./save_dir -- --save-media
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if mpii_json -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f voc -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;mpii_json&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/test_mpii_json_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-63609210ea058dde30ab67b20cc936b7">5.28 - MVTec AD</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>The MVTec AD format specification is available
<a href="https://link.springer.com/content/pdf/10.1007/s11263-020-01400-4.pdf">here</a>.</p>
<p>The dataset has annotations for detecting abnormal pixels through binary masks
and it turns into bounding boxes or abnormal labels for supporting classification,
detection, and segmentation tasks. The MVTec AD dataset is composed of training data only
for <code>good</code> category without any annotation and testing data for both <code>good</code> and multiple
<code>defective</code> categories with masks. The dataset contains total 15 kinds of objects or textures.</p>
<p>Supported tasks / formats:</p>
<ul>
<li>The combined format - <code>mvtec</code></li>
<li>Image classification - <code>mvtec_classification</code></li>
<li>Object detection - <code>mvtec_detection</code></li>
<li>Instance segmentation - <code>mvtec_segmentation</code></li>
</ul>
<p>Supported annotation types:</p>
<ul>
<li><code>Label</code> (classification)</li>
<li><code>Bbox</code> (detection)</li>
<li><code>Mask</code> (segmentation)</li>
</ul>
<h2 id="import-mvtec-ad-dataset">Import MVTec AD dataset</h2>
<p>The MVTec AD dataset is available for free download
<a href="https://www.mvtec.com/company/research/datasets/mvtec-ad">here</a>.</p>
<p>A Datumaro project with a MVTec AD source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format mvtec_segmentation &lt;path/to/dataset&gt;
</code></pre></div><p>It is possible to specify project name and project directory. Run
<code>datum create --help</code> for more information.</p>
<p>The MVTec AD dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/Category
   ├── train/
   │   ├── good/ # directory with list of good images
   │   │   ├── img1.png
   │   |   ├── img2.png
   │   |   └── ...
   ├── test/
   │   ├── good/ # directory with list of good images
   │   │   ├── img1.png
   │   |   ├── img2.png
   │   |   └── ...
   │   ├── defective1/ # directory with list of defective images
   │   │   ├── img1.png
   │   |   ├── img2.png
   │   |   └── ...
   │   ├── defective2/ # directory with list of defective images
   │   │   ├── img1.png
   │   |   ├── img2.png
   │   |   └── ...
   └── ground_truth/ # directory with semantic segmentation masks
       ├── defective1/ # directory with list of defective images for detection and segmentation task
       │   ├── img1_mask.png
       |   ├── img2_mask.png
       |   └── ...
       ├── defective2/ # directory with list of defective images for detection and segmentation task
       │   ├── img1_mask.png
       |   ├── img2_mask.png
       |   └── ...
</code></pre><p>To make sure that the selected dataset has been added to the project, you
can run <code>datum project info</code>, which will display the project information.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert a MVTec AD dataset into any other format
<a href="../../docs/user-manual/supported_formats">Datumaro supports</a>.</p>
<p>Such conversion will only be successful if the output
format can represent the type of dataset you want to convert,
e.g., image classification annotations can be
saved in <code>ImageNet</code> format, but not as <code>COCO keypoints</code>.</p>
<p>There are several ways to convert a MVTec AD dataset to other dataset formats:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f mvtec &lt;path/to/mvtec&gt;
datum <span style="color:#204a87">export</span> -f coco -o &lt;output/dir&gt;
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if mvtec -i &lt;path/to/mvtec&gt; -f coco -o &lt;output/dir&gt;
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/mvtec&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;mvtec&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;coco&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="export-to-mvtec-ad-format">Export to MVTec AD format</h2>
<p>There are several ways to convert an existing dataset to Pascal VOC format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into MVTec AD format (classification) from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f mvtec -o &lt;output/dir&gt; -- --tasks classification
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># converting to MVTec AD format from other format</span>
datum convert -if imagenet -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f mvtec -o &lt;output/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    --save-media
</code></pre></div><p>Extra options for exporting to MVTec AD format:</p>
<ul>
<li><code>--save-media</code> - allow to export dataset with saving media files
(by default <code>False</code>)</li>
<li><code>--tasks TASKS</code> - allow to specify tasks for export dataset,
by default Datumaro uses all tasks.</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum <span style="color:#204a87">export</span> -f mvtec -- --tasks detection,classification
</code></pre></div><h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/unit/test_mvtec_format.py">the format tests</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f97053c70a29d6713d3412af07bcdcca">5.29 - Open Images</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>A description of the Open Images Dataset (OID) format is available
<a href="https://storage.googleapis.com/openimages/web/download.html">here</a>.
Datumaro supports versions 4, 5 and 6.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Label</code> (human-verified image-level labels)</li>
<li><code>Bbox</code> (bounding boxes)</li>
<li><code>Mask</code> (segmentation masks)</li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li>
<p>Labels</p>
<ul>
<li><code>score</code> (read/write, float).
The confidence level from 0 to 1.
A score of 0 indicates that
the image does not contain objects of the corresponding class.</li>
</ul>
</li>
<li>
<p>Bounding boxes</p>
<ul>
<li><code>score</code> (read/write, float).
The confidence level from 0 to 1.
In the original dataset this is always equal to 1,
but custom datasets may be created with arbitrary values.</li>
<li><code>occluded</code> (read/write, boolean).
Whether the object is occluded by another object.</li>
<li><code>truncated</code> (read/write, boolean).
Whether the object extends beyond the boundary of the image.</li>
<li><code>is_group_of</code> (read/write, boolean).
Whether the object represents a group of objects of the same class.</li>
<li><code>is_depiction</code> (read/write, boolean).
Whether the object is a depiction (such as a drawing)
rather than a real object.</li>
<li><code>is_inside</code> (read/write, boolean).
Whether the object is seen from the inside.</li>
</ul>
</li>
<li>
<p>Masks</p>
<ul>
<li><code>box_id</code> (read/write, string).
An identifier for the bounding box associated with the mask.</li>
<li><code>predicted_iou</code> (read/write, float).
Predicted IoU value with respect to the ground truth.</li>
</ul>
</li>
</ul>
<h2 id="import-open-images-dataset">Import Open Images dataset</h2>
<p>The Open Images dataset is available for free download.</p>
<p>See the <a href="https://github.com/cvdfoundation/open-images-dataset"><code>open-images-dataset</code> GitHub repository</a>
for information on how to download the images.</p>
<p>Datumaro also requires the image description files,
which can be downloaded from the following URLs:</p>
<ul>
<li><a href="https://storage.googleapis.com/openimages/2018_04/image_ids_and_rotation.csv">complete set</a></li>
<li><a href="https://storage.googleapis.com/openimages/v6/oidv6-train-images-with-labels-with-rotation.csv">train set</a></li>
<li><a href="https://storage.googleapis.com/openimages/2018_04/validation/validation-images-with-rotation.csv">validation set</a></li>
<li><a href="https://storage.googleapis.com/openimages/2018_04/test/test-images-with-rotation.csv">test set</a></li>
</ul>
<p>In addition, the following metadata file must be present
in the <code>annotations</code> directory:</p>
<ul>
<li><a href="https://storage.googleapis.com/openimages/v6/oidv6-class-descriptions.csv">class descriptions</a></li>
</ul>
<p>You can optionally download the following additional metadata file:</p>
<ul>
<li><a href="https://storage.googleapis.com/openimages/2018_04/bbox_labels_600_hierarchy.json">class hierarchy</a></li>
</ul>
<p>Annotations can be downloaded from the following URLs:</p>
<ul>
<li><a href="https://storage.googleapis.com/openimages/v6/oidv6-train-annotations-human-imagelabels.csv">train image labels</a></li>
<li><a href="https://storage.googleapis.com/openimages/v5/validation-annotations-human-imagelabels.csv">validation image labels</a></li>
<li><a href="https://storage.googleapis.com/openimages/v5/test-annotations-human-imagelabels.csv">test image labels</a></li>
<li><a href="https://storage.googleapis.com/openimages/v6/oidv6-train-annotations-bbox.csv">train bounding boxes</a></li>
<li><a href="https://storage.googleapis.com/openimages/v5/validation-annotations-bbox.csv">validation bounding boxes</a></li>
<li><a href="https://storage.googleapis.com/openimages/v5/test-annotations-bbox.csv">test bounding boxes</a></li>
<li><a href="https://storage.googleapis.com/openimages/v5/train-annotations-object-segmentation.csv">train segmentation masks (metadata)</a></li>
<li>train segmentation masks (images):
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-0.zip">0</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-1.zip">1</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-2.zip">2</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-3.zip">3</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-4.zip">4</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-5.zip">5</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-6.zip">6</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-7.zip">7</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-8.zip">8</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-9.zip">9</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-a.zip">a</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-b.zip">b</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-c.zip">c</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-d.zip">d</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-e.zip">e</a>
<a href="https://storage.googleapis.com/openimages/v5/train-masks/train-masks-f.zip">f</a></li>
<li><a href="https://storage.googleapis.com/openimages/v5/validation-annotations-object-segmentation.csv">validation segmentation masks (metadata)</a></li>
<li>validation segmentation masks (images):
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-0.zip">0</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-1.zip">1</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-2.zip">2</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-3.zip">3</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-4.zip">4</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-5.zip">5</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-6.zip">6</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-7.zip">7</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-8.zip">8</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-9.zip">9</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-a.zip">a</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-b.zip">b</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-c.zip">c</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-d.zip">d</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-e.zip">e</a>
<a href="https://storage.googleapis.com/openimages/v5/validation-masks/validation-masks-f.zip">f</a></li>
<li><a href="https://storage.googleapis.com/openimages/v5/test-annotations-object-segmentation.csv">test segmentation masks (metadata)</a></li>
<li>test segmentation masks (images):
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-0.zip">0</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-1.zip">1</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-2.zip">2</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-3.zip">3</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-4.zip">4</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-5.zip">5</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-6.zip">6</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-7.zip">7</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-8.zip">8</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-9.zip">9</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-a.zip">a</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-b.zip">b</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-c.zip">c</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-d.zip">d</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-e.zip">e</a>
<a href="https://storage.googleapis.com/openimages/v5/test-masks/test-masks-f.zip">f</a></li>
</ul>
<p>All annotation files are optional,
except that if the mask metadata files for a given subset are downloaded,
all corresponding images must be downloaded as well, and vice versa.</p>
<p>A Datumaro project with an OID source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format open_images &lt;path/to/dataset&gt;
</code></pre></div><p>It is possible to specify project name and project directory. Run
<code>datum create --help</code> for more information.</p>
<p>Open Images dataset directory should have the following structure:</p>
<pre><code>└─ Dataset/
    ├── dataset_meta.json # a list of custom labels (optional)
    ├── annotations/
    │   └── bbox_labels_600_hierarchy.json
    │   └── image_ids_and_rotation.csv  # optional
    │   └── oidv6-class-descriptions.csv
    │   └── *-annotations-bbox.csv
    │   └── *-annotations-human-imagelabels.csv
    │   └── *-annotations-object-segmentation.csv
    ├── images/
    |   ├── test/
    |   │   ├── &lt;image_name1.jpg&gt;
    |   │   ├── &lt;image_name2.jpg&gt;
    |   │   └── ...
    |   ├── train/
    |   │   ├── &lt;image_name1.jpg&gt;
    |   │   ├── &lt;image_name2.jpg&gt;
    |   │   └── ...
    |   └── validation/
    |       ├── &lt;image_name1.jpg&gt;
    |       ├── &lt;image_name2.jpg&gt;
    |       └── ...
    └── masks/
        ├── test/
        │   ├── &lt;mask_name1.png&gt;
        │   ├── &lt;mask_name2.png&gt;
        │   └── ...
        ├── train/
        │   ├── &lt;mask_name1.png&gt;
        │   ├── &lt;mask_name2.png&gt;
        │   └── ...
        └── validation/
            ├── &lt;mask_name1.png&gt;
            ├── &lt;mask_name2.png&gt;
            └── ...
</code></pre><p>The mask images must be extracted from the ZIP archives linked above.</p>
<p>To use per-subset image description files instead of <code>image_ids_and_rotation.csv</code>,
place them in the <code>annotations</code> subdirectory.
The <code>annotations</code> directory is optional and you can store all annotation files
in the root of input path.</p>
<p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>.</p>
<h3 id="creating-an-image-metadata-file">Creating an image metadata file</h3>
<p>To load bounding box and segmentation mask annotations,
Datumaro needs to know the sizes of the corresponding images.
By default, it will determine these sizes by loading each image from disk,
which requires the images to be present and makes the loading process slow.</p>
<p>If you want to load the aforementioned annotations on a machine where
the images are not available,
or just to speed up the dataset loading process,
you can extract the image size information in advance
and record it in an image metadata file.
This file must be placed at <code>annotations/images.meta</code>,
and must contain one line per image, with the following structure:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">&lt;ID&gt; &lt;height&gt; &lt;width&gt;
</code></pre></div><p>Where <code>&lt;ID&gt;</code> is the file name of the image without the extension,
and <code>&lt;height&gt;</code> and <code>&lt;width&gt;</code> are the dimensions of that image.
<code>&lt;ID&gt;</code> may be quoted with either single or double quotes.</p>
<p>The image metadata file, if present, will be used to determine the image
sizes without loading the images themselves.</p>
<p>Here&rsquo;s one way to create the <code>images.meta</code> file using ImageMagick,
assuming that the images are present on the current machine:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># run this from the dataset directory</span>
find images -name <span style="color:#4e9a06">&#39;*.jpg&#39;</span> -exec <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    identify -format <span style="color:#4e9a06">&#39;&#34;%[basename]&#34; %[height] %[width]\n&#39;</span> <span style="color:#ce5c00;font-weight:bold">{}</span> + <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    &gt; annotations/images.meta
</code></pre></div><h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert OID into any other format <a href="../../docs/user-manual/supported_formats">Datumaro supports</a>.
To get the expected result, convert the dataset to a format
that supports image-level labels.
There are several ways to convert OID to other dataset formats:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f open_images &lt;path/to/open_images&gt;
datum <span style="color:#204a87">export</span> -f cvat -o &lt;output/dir&gt;
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if open_images -i &lt;path/to/open_images&gt; -f cvat -o &lt;output/dir&gt;
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;open_images&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;cvat&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="export-to-open-images">Export to Open Images</h2>
<p>There are several ways to convert an existing dataset to the Open Images format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into Open Images format from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f open_images -o &lt;output/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -- --save_media
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># convert a dataset in another format to the Open Images format</span>
datum convert -if imagenet -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f open_images -o &lt;output/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- --save-media
</code></pre></div><p>Extra options for exporting to the Open Images format:</p>
<ul>
<li><code>--save-media</code> - save media files when exporting the dataset
(by default, <code>False</code>)</li>
<li><code>--image-ext IMAGE_EXT</code> - save image files with the specified extension
when exporting the dataset (by default, uses the original extension
or <code>.jpg</code> if there isn&rsquo;t one)</li>
<li><code>--save-dataset-meta</code> - allow to export dataset with saving dataset meta
file (by default <code>False</code>)</li>
</ul>
<h2 id="examples">Examples</h2>
<p>Datumaro supports filtering, transformation, merging etc. for all formats
and for the Open Images format in particular. Follow the
<a href="../../docs/user-manual/">user manual</a>
to get more information about these operations.</p>
<p>Here are a few examples of using Datumaro operations to solve
particular problems with the Open Images dataset:</p>
<h3 id="example-1-load-the-open-images-dataset-and-convert-to-the-cvat-format">Example 1. Load the Open Images dataset and convert to the CVAT format</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o project
datum import -p project -f open_images ./open-images-dataset/
datum stats -p project
datum <span style="color:#204a87">export</span> -p project -f cvat -- --save-media
</code></pre></div><h3 id="example-2-create-a-custom-oid-like-dataset">Example 2. Create a custom OID-like dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">numpy</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">np</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">([</span>
    <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span>
        <span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;0000000000000001&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)),</span>
        <span style="color:#000">subset</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;validation&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
            <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Label</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;score&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">}),</span>
            <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Label</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;score&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">}),</span>
        <span style="color:#000;font-weight:bold">],</span>
    <span style="color:#000;font-weight:bold">),</span>
<span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;/m/0&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;/m/1&#39;</span><span style="color:#000;font-weight:bold">])</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./dataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;open_images&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_open_images_format.py">the format tests</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-db1d30fa5536c19aa2aa75b33dbf92ea">5.30 - Pascal VOC</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>Pascal VOC format specification is available
<a href="http://host.robots.ox.ac.uk/pascal/VOC/voc2012/devkit_doc.pdf">here</a>.</p>
<p>The dataset has annotations for multiple tasks. Each task has its own format
in Datumaro, and there is also a combined <code>voc</code> format, which includes all
the available tasks. The sub-formats have the same options as the &ldquo;main&rdquo;
format and only limit the set of annotation files they work with. To work with
multiple formats, use the corresponding option of the <code>voc</code> format.</p>
<p>Supported tasks / formats:</p>
<ul>
<li>The combined format - <code>voc</code></li>
<li>Image classification - <code>voc_classification</code></li>
<li>Object detection - <code>voc_detection</code></li>
<li>Action classification - <code>voc_action</code></li>
<li>Class and instance segmentation - <code>voc_segmentation</code></li>
<li>Person layout detection - <code>voc_layout</code></li>
</ul>
<p>Supported annotation types:</p>
<ul>
<li><code>Label</code> (classification)</li>
<li><code>Bbox</code> (detection, action detection and person layout)</li>
<li><code>Mask</code> (segmentation)</li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li><code>occluded</code> (boolean) - indicates that a significant portion of the
object within the bounding box is occluded by another object</li>
<li><code>truncated</code> (boolean) - indicates that the bounding box specified for
the object does not correspond to the full extent of the object</li>
<li><code>difficult</code> (boolean) - indicates that the object is considered difficult
to recognize</li>
<li>action attributes (boolean) - <code>jumping</code>, <code>reading</code> and
<a href="http://host.robots.ox.ac.uk/pascal/VOC/voc2012/actionexamples/index.html">others</a>.
Indicate that the object does the corresponding action.</li>
<li>arbitrary attributes (string/number) - A Datumaro extension. Stored
in the <code>attributes</code> section of the annotation <code>xml</code> file. Available for
bbox annotations only.</li>
</ul>
<h2 id="import-pascal-voc-dataset">Import Pascal VOC dataset</h2>
<p>The Pascal VOC dataset is available for free download
<a href="http://host.robots.ox.ac.uk/pascal/VOC/voc2012/index.html#devkit">here</a></p>
<p>A Datumaro project with a Pascal VOC source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format voc &lt;path/to/dataset&gt;
</code></pre></div><p>It is possible to specify project name and project directory. Run
<code>datum create --help</code> for more information.</p>
<p>Pascal VOC dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
   ├── dataset_meta.json # a list of non-Pascal labels (optional)
   ├── labelmap.txt # or a list of non-Pascal labels in other format (optional)
   │
   ├── Annotations/
   │     ├── ann1.xml # Pascal VOC format annotation file
   │     ├── ann2.xml
   │     └── ...
   ├── JPEGImages/
   │    ├── img1.jpg
   │    ├── img2.jpg
   │    └── ...
   ├── SegmentationClass/ # directory with semantic segmentation masks
   │    ├── img1.png
   │    ├── img2.png
   │    └── ...
   ├── SegmentationObject/ # directory with instance segmentation masks
   │    ├── img1.png
   │    ├── img2.png
   │    └── ...
   │
   └── ImageSets/
        ├── Main/ # directory with list of images for detection and classification task
        │   ├── test.txt  # list of image names in test subset  (without extension)
        |   ├── train.txt # list of image names in train subset (without extension)
        |   └── ...
        ├── Layout/ # directory with list of images for person layout task
        │   ├── test.txt
        |   ├── train.txt
        |   └── ...
        ├── Action/ # directory with list of images for action classification task
        │   ├── test.txt
        |   ├── train.txt
        |   └── ...
        └── Segmentation/ # directory with list of images for segmentation task
            ├── test.txt
            ├── train.txt
            └── ...
</code></pre><p>The <code>ImageSets</code> directory should contain at least one of the directories:
<code>Main</code>, <code>Layout</code>, <code>Action</code>, <code>Segmentation</code>.
These directories contain <code>.txt</code> files with a list of images in a subset,
the subset name is the same as the <code>.txt</code> file name. Subset names can be
arbitrary.</p>
<p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>
and <code>labelmap.txt</code>.
If the <code>dataset_meta.json</code> is not represented in the dataset, then
<code>labelmap.txt</code> will be imported if possible.</p>
<p>In <code>labelmap.txt</code> you can define custom color map and non-pascal labels,
for example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt"># label_map [label : color_rgb : parts : actions]
helicopter:::
elephant:0:124:134:head,ear,foot:
</code></pre></div><p>It is also possible to import grayscale (1-channel) PNG masks.
For grayscale masks provide a list of labels with the number of lines
equal to the maximum color index on images. The lines must be in the
right order so that line index is equal to the color index. Lines can
have arbitrary, but different, colors. If there are gaps in the used
color indices in the annotations, they must be filled with arbitrary
dummy labels. Example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">car:0,128,0:: # color index 0
aeroplane:10,10,128:: # color index 1
_dummy2:2,2,2:: # filler for color index 2
_dummy3:3,3,3:: # filler for color index 3
boat:108,0,100:: # color index 3
...
_dummy198:198,198,198:: # filler for color index 198
_dummy199:199,199,199:: # filler for color index 199
the_last_label:12,28,0:: # color index 200
</code></pre></div><p>You can import dataset for specific tasks
of Pascal VOC dataset instead of the whole dataset,
for example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import -f voc_detection -r ImageSets/Main/train.txt &lt;path/to/dataset&gt;
</code></pre></div><p>To make sure that the selected dataset has been added to the project, you
can run <code>datum project info</code>, which will display the project information.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert a Pascal VOC dataset into any other format
<a href="../../docs/user-manual/supported_formats">Datumaro supports</a>.</p>
<p>Such conversion will only be successful if the output
format can represent the type of dataset you want to convert,
e.g. image classification annotations can be
saved in <code>ImageNet</code> format, but not as <code>COCO keypoints</code>.</p>
<p>There are several ways to convert a Pascal VOC dataset to other dataset formats:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f voc &lt;path/to/voc&gt;
datum <span style="color:#204a87">export</span> -f coco -o &lt;output/dir&gt;
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if voc -i &lt;path/to/voc&gt; -f coco -o &lt;output/dir&gt;
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;coco&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="export-to-pascal-voc">Export to Pascal VOC</h2>
<p>There are several ways to convert an existing dataset to Pascal VOC format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into Pascal VOC format (classification) from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f voc -o &lt;output/dir&gt; -- --tasks classification
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># converting to Pascal VOC format from other format</span>
datum convert -if imagenet -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f voc -o &lt;output/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- --label_map voc --save-media
</code></pre></div><p>Extra options for exporting to Pascal VOC format:</p>
<ul>
<li><code>--save-media</code> - allow to export dataset with saving media files
(by default <code>False</code>)</li>
<li><code>--image-ext IMAGE_EXT</code> - allow to specify image extension
for exporting dataset (by default use original or <code>.jpg</code> if none)</li>
<li><code>--save-dataset-meta</code> - allow to export dataset with saving dataset meta
file (by default <code>False</code>)</li>
<li><code>--apply-colormap APPLY_COLORMAP</code> - allow to use colormap for class
and instance masks (by default <code>True</code>)</li>
<li><code>--allow-attributes ALLOW_ATTRIBUTES</code> - allow export of attributes
(by default <code>True</code>)</li>
<li><code>--keep-empty KEEP_EMPTY</code> - write subset lists even if they are empty
(by default <code>False</code>)</li>
<li><code>--tasks TASKS</code> - allow to specify tasks for export dataset,
by default Datumaro uses all tasks. Example:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum <span style="color:#204a87">export</span> -f voc -- --tasks detection,classification
</code></pre></div><ul>
<li><code>--label_map PATH</code> - allows to define a custom colormap. Example:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># mycolormap.txt [label : color_rgb : parts : actions]:</span>
<span style="color:#8f5902;font-style:italic"># cat:0,0,255::</span>
<span style="color:#8f5902;font-style:italic"># person:255,0,0:head:</span>
datum <span style="color:#204a87">export</span> -f voc_segmentation -- --label-map mycolormap.txt
</code></pre></div><p>or you can use original voc colomap:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum <span style="color:#204a87">export</span> -f voc_segmentation -- --label-map voc
</code></pre></div><h2 id="examples">Examples</h2>
<p>Datumaro supports filtering, transformation, merging etc. for all formats
and for the Pascal VOC format in particular. Follow
<a href="../../docs/user-manual/">user manual</a>
to get more information about these operations.</p>
<p>There are few examples of using Datumaro operations to solve
particular problems with Pascal VOC dataset:</p>
<h3 id="example-1-how-to-prepare-an-original-dataset-for-training">Example 1. How to prepare an original dataset for training</h3>
<p>In this example, preparing the original dataset to train the semantic
segmentation model includes:
loading,
checking duplicate images,
setting the number of images,
splitting into subsets,
export the result to Pascal VOC format.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o project
datum import -p project -f voc_segmentation ./VOC2012/ImageSets/Segmentation/trainval.txt
datum stats -p project <span style="color:#8f5902;font-style:italic"># check statisctics.json -&gt; repeated images</span>
datum transform -p project -t ndr -- -w trainval -k <span style="color:#0000cf;font-weight:bold">2500</span>
datum filter -p project -e <span style="color:#4e9a06">&#39;/item[subset=&#34;trainval&#34;]&#39;</span>
datum transform -p project -t random_split -- -s train:.8 -s val:.2
datum <span style="color:#204a87">export</span> -p project -f voc -- --label-map voc --save-media
</code></pre></div><h3 id="example-2-how-to-create-a-custom-dataset">Example 2. How to create a custom dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">([</span>
    <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;image1&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Image</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">path</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;image1.jpg&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">20</span><span style="color:#000;font-weight:bold">)),</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
            <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Label</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">),</span>
            <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Bbox</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">10.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;difficult&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;running&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">}),</span>
            <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Polygon</span><span style="color:#000;font-weight:bold">([</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;occluded&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">}),</span>
            <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Polygon</span><span style="color:#000;font-weight:bold">([</span><span style="color:#0000cf;font-weight:bold">6</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">9</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">9</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">6</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">),</span>
        <span style="color:#000;font-weight:bold">]</span>
    <span style="color:#000;font-weight:bold">),</span>
<span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;person&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;sky&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;water&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;lion&#39;</span><span style="color:#000;font-weight:bold">])</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">transform</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;polygons_to_masks&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./mydataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label_map</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;my_labelmap.txt&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p><code>my_labelmap.txt</code> has the following contents:</p>
<pre><code># label:color_rgb:parts:actions
person:0,0,255:hand,foot:jumping,running
sky:128,0,0::
water:0,128,0::
lion:255,128,0::
</code></pre><h3 id="example-3-load-filter-and-convert-from-code">Example 3. Load, filter and convert from code</h3>
<p>Load Pascal VOC dataset, and export train subset with items
which has <code>jumping</code> attribute:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./VOC2012&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#000">train_dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get_subset</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;train&#39;</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">as_dataset</span><span style="color:#000;font-weight:bold">()</span>

<span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">only_jumping</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">item</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">ann</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">item</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">annotations</span><span style="color:#000;font-weight:bold">:</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">ann</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;jumping&#39;</span><span style="color:#000;font-weight:bold">):</span>
            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#3465a4">True</span>
    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#3465a4">False</span>

<span style="color:#000">train_dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">only_jumping</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#000">train_dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./jumping_label_me&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;label_me&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h3 id="example-4-get-information-about-items-in-pascal-voc-2012-dataset-for-segmentation-task">Example 4. Get information about items in Pascal VOC 2012 dataset for segmentation task</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./VOC2012&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">has_mask</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">item</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">ann</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">item</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">annotations</span><span style="color:#000;font-weight:bold">:</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">ann</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">AnnotationType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">mask</span><span style="color:#000;font-weight:bold">:</span>
            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#3465a4">True</span>
    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#3465a4">False</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">has_mask</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#204a87;font-weight:bold">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Pascal VOC 2012 has </span><span style="color:#4e9a06">%s</span><span style="color:#4e9a06"> images for segmentation task:&#34;</span> <span style="color:#ce5c00;font-weight:bold">%</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dataset</span><span style="color:#000;font-weight:bold">))</span>
<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">subset_name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">subset</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">subsets</span><span style="color:#000;font-weight:bold">()</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">items</span><span style="color:#000;font-weight:bold">():</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">item</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">subset</span><span style="color:#000;font-weight:bold">:</span>
        <span style="color:#204a87;font-weight:bold">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">item</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">subset_name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">end</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;;&#34;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>After executing this code, we can see that there are 5826 images
in Pascal VOC 2012 has for segmentation task and this result is the same as the
<a href="http://host.robots.ox.ac.uk/pascal/VOC/voc2012/dbstats.html">official documentation</a></p>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_voc_format.py">tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0c9b196a180c68b9b42be11ddc52c8bb">5.31 - Supervisely Point Cloud</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>Specification for the Point Cloud data format is available
<a href="https://docs.supervise.ly/data-organization/00_ann_format_navi">here</a>.</p>
<p>You can also find examples of working with the dataset
<a href="https://drive.google.com/file/d/1BtZyffWtWNR-mk_PHNPMnGgSlAkkQpBl/view">here</a>.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>cuboid_3d</code></li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li><code>track_id</code> (read/write, integer), responsible for <code>object</code> field</li>
<li><code>createdAt</code> (write, string),</li>
<li><code>updatedAt</code> (write, string),</li>
<li><code>labelerLogin</code> (write, string), responsible for the corresponding fields
in the annotation file.</li>
<li>arbitrary attributes</li>
</ul>
<p>Supported image attributes:</p>
<ul>
<li><code>description</code> (read/write, string),</li>
<li><code>createdAt</code> (write, string),</li>
<li><code>updatedAt</code> (write, string),</li>
<li><code>labelerLogin</code> (write, string), responsible for the corresponding fields
in the annotation file.</li>
<li><code>frame</code> (read/write, integer). Indicates frame number of the image.</li>
<li>arbitrary attributes</li>
</ul>
<h2 id="import-supervisely-point-cloud-dataset">Import Supervisely Point Cloud dataset</h2>
<p>An example dataset in Supervisely Point Cloud format is available for download:</p>
<p><a href="https://drive.google.com/u/0/uc?id=1BtZyffWtWNR-mk_PHNPMnGgSlAkkQpBl&amp;export=download">https://drive.google.com/u/0/uc?id=1BtZyffWtWNR-mk_PHNPMnGgSlAkkQpBl&amp;export=download</a></p>
<p>Point Cloud dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── ds0/
    │   ├── ann/
    │   │   ├── &lt;pcdname1.pcd.json&gt;
    │   │   ├── &lt;pcdname2.pcd.json&gt;
    │   │   └── ...
    │   ├── pointcloud/
    │   │   ├── &lt;pcdname1.pcd&gt;
    │   │   ├── &lt;pcdname1.pcd&gt;
    │   │   └── ...
    │   ├── related_images/
    │   │   ├── &lt;pcdname1_pcd&gt;/
    │   │   |  ├── &lt;image_name.ext.json&gt;
    │   │   |  ├── &lt;image_name.ext.json&gt;
    │   │   └── ...
    ├── key_id_map.json
    └── meta.json
</code></pre><p>There are two ways to import a Supervisely Point Cloud dataset:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format sly_pointcloud --input-path &lt;path/to/dataset&gt;
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f sly_pointcloud &lt;path/to/dataset&gt;
</code></pre></div><p>To make sure that the selected dataset has been added to the project,
you can run <code>datum project info</code>, which will display the project and dataset
information.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert Supervisely Point Cloud dataset into any other
format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.</p>
<p>Such conversion will only be successful if the output
format can represent the type of dataset you want to convert,
e.g. 3D point clouds can be saved in <code>KITTI Raw</code> format,
but not in <code>COCO keypoints</code>.</p>
<p>There are several ways to convert a Supervisely Point Cloud dataset
to other dataset formats:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f sly_pointcloud &lt;path/to/sly_pcd/&gt;
datum <span style="color:#204a87">export</span> -f kitti_raw -o &lt;output/dir&gt;
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if sly_pointcloud -i &lt;path/to/sly_pcd/&gt; -f kitti_raw
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;sly_pointcloud&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;kitti_raw&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="export-to-supervisely-point-cloud">Export to Supervisely Point Cloud</h2>
<p>There are several ways to convert a dataset to Supervisely Point Cloud format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into Supervisely Point Cloud format from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f sly_pointcloud -o &lt;output/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- --save-media
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># converting to Supervisely Point Cloud format from other format</span>
datum convert -if kitti_raw -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f sly_pointcloud -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Extra options for exporting in Supervisely Point Cloud format:</p>
<ul>
<li><code>--save-media</code> allow to export dataset with saving media files. This will
include point clouds and related images (by default <code>False</code>)</li>
<li><code>--image-ext IMAGE_EXT</code> allow to specify image extension
for exporting dataset (by default - keep original or use <code>.png</code>, if none)</li>
<li><code>--reindex</code> assigns new indices to frames and annotations.</li>
<li><code>--allow-undeclared-attrs</code> allows writing arbitrary annotation attributes.
By default, only attributes specified in the input dataset metainfo
will be written.</li>
</ul>
<h2 id="examples">Examples</h2>
<h3 id="example-1-import-dataset-compute-statistics">Example 1. Import dataset, compute statistics</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o project
datum import -p project -f sly_pointcloud ../sly_dataset/
datum stats -p project
</code></pre></div><h3 id="example-2-convert-supervisely-point-clouds-to-kitti-raw">Example 2. Convert Supervisely Point Clouds to KITTI Raw</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if sly_pointcloud -i ../sly_pcd/ <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f kitti_raw -o my_kitti/ -- --save-media --reindex --allow-attrs
</code></pre></div><h3 id="example-3-create-a-custom-dataset">Example 3. Create a custom dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">([</span>
    <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;frame_1&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
            <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Cuboid3d</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">206</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">position</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">320.86</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">979.18</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1.04</span><span style="color:#000;font-weight:bold">],</span>
                <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;occluded&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">False</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;track_id&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;x&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">}),</span>

            <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Cuboid3d</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">207</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">position</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">318.19</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">974.65</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1.29</span><span style="color:#000;font-weight:bold">],</span>
                <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;occluded&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;track_id&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">}),</span>
        <span style="color:#000;font-weight:bold">],</span>
        <span style="color:#000">pcd</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;path/to/pcd1.pcd&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;frame&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;description&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;zzz&#39;</span><span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">),</span>

    <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;frm2&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
            <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Cuboid3d</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">208</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">position</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">23.04</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8.75</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">0.78</span><span style="color:#000;font-weight:bold">],</span>
                <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;occluded&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">False</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;track_id&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">})</span>
        <span style="color:#000;font-weight:bold">],</span>
        <span style="color:#000">pcd</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;path/to/pcd2.pcd&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">related_images</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;image2.png&#39;</span><span style="color:#000;font-weight:bold">],</span>
        <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;frame&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">),</span>
<span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;cat&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;dog&#39;</span><span style="color:#000;font-weight:bold">])</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;my_dataset/&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;sly_pointcloud&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000">allow_undeclared_attrs</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_sly_pointcloud_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ce33d4e30ead378e5921038c30e7a0bf">5.32 - SYNTHIA</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>The original SYNTHIA dataset is available
<a href="https://synthia-dataset.net">here</a>.</p>
<p>Datumaro supports all SYNTHIA formats except SYNTHIA-AL.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Mask</code></li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li><code>dynamic_object</code> (boolean): whether the object moving</li>
</ul>
<h2 id="import-synthia-dataset">Import SYNTHIA dataset</h2>
<p>A Datumaro project with a SYNTHIA source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format synthia &lt;path/to/dataset&gt;
</code></pre></div><p>It is also possible to import the dataset using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">synthia_dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;synthia&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>SYNTHIA dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>dataset/
├── dataset_meta.json # a list of non-format labels (optional)
├── GT/
│   ├── COLOR/
│   │   ├── Stereo_Left/
│   │   │   ├── Omni_B
│   │   │   │   ├── 000000.png
│   │   │   │   ├── 000001.png
│   │   │   │   └── ...
│   │   │   └── ...
│   │   └── Stereo_Right
│   │       ├── Omni_B
│   │       │   ├── 000000.png
│   │       │   ├── 000001.png
│   │       │   └── ...
│   │       └── ...
│   └── LABELS
│       ├── Stereo_Left
│       │   ├── Omni_B
│       │   │   ├── 000000.png
│       │   │   ├── 000001.png
│       │   │   └── ...
│       │   └── ...
│       └── Stereo_Right
│           ├── Omni_B
│           │   ├── 000000.png
│           │   ├── 000001.png
│           │   └── ...
│           └── ...
└── RGB
    ├── Stereo_Left
    │   ├── Omni_B
    │   │   ├── 000000.png
    │   │   ├── 000001.png
    │   │   └── ...
    │   └── ...
    └── Stereo_Right
        ├── Omni_B
        │   ├── 000000.png
        │   ├── 000001.png
        │   └── ...
        └── ...
</code></pre><ul>
<li><code>RGB</code> folder containing standard RGB images used for training.</li>
<li><code>GT/LABELS</code> folder containing containing PNG files (one per image).
Annotations are given in three channels. The red channel contains
the class of that pixel. The green channel contains the class only
for those objects that are dynamic (cars, pedestrians, etc.),
otherwise it contains <code>0</code>.</li>
<li><code>GT/COLOR</code> folder containing png files (one per image).
Annotations are given using a color representation.</li>
</ul>
<p>When importing a dataset, only <code>GT/LABELS</code> folder will be used.
If it is missing, <code>GT/COLOR</code> folder will be used.</p>
<p>The original dataset also contains depth information, but Datumaro
does not currently support it.</p>
<p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert a SYNTHIA dataset into any other format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to a format
that supports segmentation masks.</p>
<p>There are several ways to convert a SYNTHIA dataset to other dataset
formats using CLI:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f synthia &lt;path/to/dataset&gt;
datum <span style="color:#204a87">export</span> -f voc -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if synthia -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f voc -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;synthia&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/test_synthia_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-bc1c599a20f4d5c48cfd2ed514e3f166">5.33 - Velodyne Points / KITTI Raw 3D</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>Velodyne Points / KITTI Raw 3D data format homepage is
available <a href="http://www.cvlibs.net/datasets/kitti/raw_data.php">here</a>.</p>
<p>Velodyne Points / KITTI Raw 3D data format specification
is available <a href="https://s3.eu-central-1.amazonaws.com/avg-kitti/devkit_raw_data.zip">here</a>.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Cuboid3d</code> (represent tracks)</li>
</ul>
<p>Supported annotation attributes:</p>
<ul>
<li><code>truncation</code> (write, string), possible values: <code>truncation_unset</code>,
<code>in_image</code>, <code>truncated</code>, <code>out_image</code>, <code>behind_image</code> (case-independent).</li>
<li><code>occlusion</code> (write, string), possible values: <code>occlusion_unset</code>, <code>visible</code>,
<code>partly</code>, <code>fully</code> (case-independent). This attribute has priority
over <code>occluded</code>.</li>
<li><code>occluded</code> (read/write, boolean)</li>
<li><code>keyframe</code> (read/write, boolean). Responsible for <code>occlusion_kf</code> field.</li>
<li><code>track_id</code> (read/write, integer). Indicates the group over frames for
annotations, represent tracks.</li>
</ul>
<p>Supported image attributes:</p>
<ul>
<li><code>frame</code> (read/write, integer). Indicates frame number of the image.</li>
</ul>
<h2 id="import-kitti-raw-dataset">Import KITTI Raw dataset</h2>
<p>The velodyne points/KITTI Raw dataset is available for download
<a href="http://www.cvlibs.net/datasets/kitti/raw_data.php">here</a> and
<a href="https://cloud.enterprise.deepsystems.io/s/YcyfIf5zrS7NZcI/download">here</a>.</p>
<p>KITTI Raw dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ Dataset/
    ├── dataset_meta.json # a list of custom labels (optional)
    ├── image_00/ # optional, aligned images from different cameras
    │   └── data/
    │       ├── &lt;name1.ext&gt;
    │       └── &lt;name2.ext&gt;
    ├── image_01/
    │   └── data/
    │       ├── &lt;name1.ext&gt;
    │       └── &lt;name2.ext&gt;
    ...
    │
    ├── velodyne_points/ # optional, 3d point clouds
    │   └── data/
    │       ├── &lt;name1.pcd&gt;
    │       └── &lt;name2.pcd&gt;
    ├── tracklet_labels.xml
    └── frame_list.txt # optional, required for custom image names

</code></pre><p>The format does not support arbitrary image names and paths, but Datumaro
provides an option to use a special index file to allow this.</p>
<p><code>frame_list.txt</code> contents:</p>
<pre><code>12345 relative/path/to/name1/from/data
46 relative/path/to/name2/from/data
...
</code></pre><p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>.</p>
<p>A Datumaro project with a KITTI source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format kitti_raw &lt;path/to/dataset&gt;
</code></pre></div><p>To make sure that the selected dataset has been added to the project,
you can run <code>datum project info</code>, which will display the project and dataset
information.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert a KITTI Raw dataset into any other
format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.</p>
<p>Such conversion will only be successful if the output
format can represent the type of dataset you want to convert,
e.g. 3D point clouds can be saved in Supervisely Point Clouds format,
but not in COCO keypoints.</p>
<p>There are several ways to convert a KITTI Raw dataset to other dataset formats:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f kitti_raw &lt;path/to/kitti_raw&gt;
datum <span style="color:#204a87">export</span> -f sly_pointcloud -o &lt;output/dir&gt;
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if kitti_raw -i &lt;path/to/kitti_raw&gt; -f sly_pointcloud
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;kitti_raw&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;sly_pointcloud&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="export-to-kitti-raw">Export to KITTI Raw</h2>
<p>There are several ways to convert a dataset to KITTI Raw format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># export dataset into KITTI Raw format from existing project</span>
datum <span style="color:#204a87">export</span> -p &lt;path/to/project&gt; -f kitti_raw -o &lt;output/dir&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -- --save-media
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># converting to KITTI Raw format from other format</span>
datum convert -if sly_pointcloud -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f kitti_raw -o &lt;output/dir&gt; -- --save-media --reindex
</code></pre></div><p>Extra options for exporting to KITTI Raw format:</p>
<ul>
<li><code>--save-media</code> allow to export dataset with saving media files. This will
include point clouds and related images (by default <code>False</code>)</li>
<li><code>--image-ext IMAGE_EXT</code> allow to specify image extension
for exporting dataset (by default - keep original or use <code>.png</code>, if none)</li>
<li><code>--reindex</code> assigns new indices to frames and tracks. Allows annotations
without <code>track_id</code> attribute (they will be exported as single-frame tracks).</li>
<li><code>--allow-attrs</code> allows writing arbitrary annotation attributes. They will
be written in <code>&lt;annotations&gt;</code> section of <code>&lt;poses&gt;&lt;item&gt;</code>
(disabled by default)</li>
</ul>
<h2 id="examples">Examples</h2>
<h3 id="example-1-import-dataset-compute-statistics">Example 1. Import dataset, compute statistics</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o project
datum import -p project -f kitti_raw ../kitti_raw/
datum stats -p project
</code></pre></div><h3 id="example-2-convert-supervisely-pointclouds-to-kitti-raw">Example 2. Convert Supervisely Pointclouds to KITTI Raw</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if sly_pointcloud -i ../sly_pcd/ <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f kitti_raw -o my_kitti/ -- --save-media --allow-attrs
</code></pre></div><h3 id="example-3-create-a-custom-dataset">Example 3. Create a custom dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">numpy</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">np</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">([</span>
    <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;some/name/qq&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
            <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Cuboid3d</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">position</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">13.54</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">9.41</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0.24</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;occluded&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">False</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;track_id&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">}),</span>

            <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Cuboid3d</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">position</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">3.4</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">2.11</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4.4</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;occluded&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;track_id&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">})</span>
        <span style="color:#000;font-weight:bold">],</span>
        <span style="color:#000">pcd</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;path/to/pcd1.pcd&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">related_images</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">)),</span> <span style="color:#4e9a06">&#39;path/to/image2.png&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;image3.jpg&#39;</span><span style="color:#000;font-weight:bold">],</span>
        <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;frame&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">),</span>
<span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;cat&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;dog&#39;</span><span style="color:#000;font-weight:bold">])</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;my_dataset/&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;kitti_raw&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_kitti_raw_format.py">the format tests</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-eb23d21da40c4ef53f89d57813e46708">5.34 - Vgg Face2 CSV</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>Vgg Face 2 is a dataset for face-recognition task,
the repository with some information and sample data of Vgg Face 2 is available
<a href="https://github.com/ox-vgg/vgg_face2">here</a></p>
<p>Supported types of annotations:</p>
<ul>
<li><code>Bbox</code></li>
<li><code>Points</code></li>
<li><code>Label</code></li>
</ul>
<p>Format doesn&rsquo;t support any attributes for annotations objects.</p>
<h2 id="import-vgg-face2-dataset">Import Vgg Face2 dataset</h2>
<p>A Datumaro project with a Vgg Face 2 dataset can be created
in the following way:</p>
<pre><code>datum create
datum import -f vgg_face2 &lt;path_to_dataset&gt;
</code></pre><blockquote>
<p>Note: if you use <code>datum import</code> then &lt;path_to_dataset&gt; should not be a
subdirectory of directory with Datumaro project, see more information about
it in the <a href="../../docs/user-manual/command-reference/sources/#source-add">docs</a>.</p>
</blockquote>
<p>And you can also load Vgg Face 2 through the Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path_to_dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;vgg_face2&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>For successful importing of Vgg Face2 face the input directory with dataset
should has the following structure:</p>
<pre><code>vgg_face2_dataset/
├── labels.txt # labels mapping
├── bb_landmark
│   ├── loose_bb_test.csv  # information about bounding boxes for test subset
│   ├── loose_bb_train.csv
│   ├── loose_bb_&lt;any_other_subset_name&gt;.csv
│   ├── loose_landmark_test.csv # landmark points information for test subset
│   ├── loose_landmark_train.csv
│   └── loose_landmark_&lt;any_other_subset_name&gt;.csv
├── test
│   ├── n000001 # directory with images for n000001 label
│   │   ├── 0001_01.jpg
│   │   ├── 0001_02.jpg
│   │   ├── ...
│   ├── n000002 # directory with images for n000002 label
│   │   ├── 0002_01.jpg
│   │   ├── 0003_01.jpg
│   │   ├── ...
│   ├── ...
├── train
│   ├── n000004
│   │   ├── 0004_01.jpg
│   │   ├── 0004_02.jpg
│   │   ├── ...
│   ├── ...
└── &lt;any_other_subset_name&gt;
    ├── ...
</code></pre><h2 id="export-vgg-face2-dataset">Export Vgg Face2 dataset</h2>
<p>Datumaro can convert a Vgg Face2 dataset into any other format
<a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
There is few examples how to do it:</p>
<pre><code># Using `convert` command
datum convert -if vgg_face2 -i &lt;path_to_vgg_face2&gt; \
    -f voc -o &lt;output_dir&gt; -- --save-images

# Using Datumaro project
datum create
datum import -f vgg_face2 &lt;path_to_vgg_face2&gt;
datum export -f yolo -o &lt;output_dir&gt;
</code></pre><blockquote>
<p>Note: to get the expected result from the conversion, the output format
should support the same types of annotations (one or more) as Vgg Face2
(<code>Bbox</code>, <code>Points</code>, <code>Label</code>)</p>
</blockquote>
<p>And also you can convert your Vgg Face2 dataset using Python API</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">vgg_face2_dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path_to_dataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;vgg_face2&#39;</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#000">vgg_face2_dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;output_dir&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;open_images&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><blockquote>
<p>Note: some formats have extra export options. For particular format see the
<a href="../../docs/formats/">docs</a> to get information about it.</p>
</blockquote>
<h2 id="export-dataset-to-the-vgg-face2-format">Export dataset to the Vgg Face2 format</h2>
<p>If you have dataset in some format and want to convert this dataset
into the Vgg Face2, ensure that this dataset contains <code>Bbox</code> or/and <code>Points</code>
or/and <code>Label</code> and use Datumaro to perform conversion.
There is few examples:</p>
<pre><code># Using convert command
datum convert -if wider_face -i &lt;path_to_wider&gt; \
    -f vgg_face2 -o &lt;output_dir&gt;

# Using Datumaro project
datum create
datum import -f wider_face &lt;path_to_wider&gt;
datum export -f vgg_face2 -o &lt;output_dir&gt; -- --save-media --image-ext '.png'
</code></pre><blockquote>
<p>Note: <code>vgg_face2</code> format supports only one <code>Bbox</code> per image</p>
</blockquote>
<p>Extra options for exporting to Vgg Face2 format:</p>
<ul>
<li><code>--save-media</code> allow to export dataset with saving media files
(by default <code>False</code>)</li>
<li><code>--image-ext &lt;IMAGE_EXT&gt;</code> allow to specify image extension
for exporting the dataset (by default <code>.png</code>)</li>
<li><code>--save-dataset-meta</code> - allow to export dataset with saving dataset meta
file (by default <code>False</code>)</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e5fe2fdda92db64d1736d255d4d50ef4">5.35 - Video</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>There are many kinds of video extensions as listed up
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/datumaro/plugins/data_formats/video.py">here</a>.</p>
<p>Datumaro can import a video into video frames by adjusting the start frame, end frame,
and step size. Furthermore, with a <code>video_keyframes</code> format, Datumaro can extract
keyframes by comparing zero-mean normalized cross correlation (ZNCC) metric between
successive frames as following <a href="https://www.sciencedirect.com/science/article/pii/S1047320312000223">here</a>.
Plus, Datumaro provides the options for choosing image extension and name patterns
for efficient data management from multiple videos.</p>
<h2 id="import-video">Import video</h2>
<p>A Datumaro project with a video frames can be created
in the following way:</p>
<pre><code>datum create
datum import -f video_frames &lt;path_to_video&gt;
</code></pre><p>Load video through the Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path_to_video&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;video_frames&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>Datumaro has few import options for <code>video_frames</code> format, to apply them
use the <code>--</code> after the main command argument.</p>
<p><code>video_frames</code> import options:</p>
<ul>
<li><code>--subset</code> (string) - The name of the subset for the produced
dataset items (default: none)</li>
<li><code>-p, --name-pattern</code> (string) - Name pattern for the produced
images (default: <code>%06d</code>)</li>
<li><code>-s, --step</code> (integer) - Frame step (default: 1)</li>
<li><code>-b, --start-frame</code> (integer) - Starting frame (default: 0)</li>
<li><code>-e, --end-frame</code> (integer) - Finishing frame (default: none)</li>
<li><code>-h, --help</code> - Print the help message and exit</li>
</ul>
<p>Usage:</p>
<pre><code class="language-console" data-lang="console">datum import -f video_frames [-h] [-n NAME] [-r RPATH] [-p PROJECT_DIR]
  [--no-check] [-s STEP] [-b START_FRAME] [-e END_FRAME] url ...
</code></pre><p>Example: import a video into frames, use each 30th frame:</p>
<pre><code class="language-console" data-lang="console">datum import -f video_frames video.mp4 -o video-frames --step 30
</code></pre><p>Example: import a video into frames, save as &lsquo;frame_xxxxxx.png&rsquo; files:</p>
<pre><code class="language-console" data-lang="console">datum import -f video_frames video.mp4 -o video-frames --image-ext=.png --name-pattern='frame_%%06d'
</code></pre><p>Example: import a video into keyframes:</p>
<pre><code class="language-console" data-lang="console">datum import -f video_keyframes video.mp4 -o video-frames
</code></pre>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-380867834e6811ae51a317687af11e27">5.36 - VoTT CSV</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p><a href="https://github.com/microsoft/VoTT">VoTT</a> (Visual Object Tagging Tool) is
an open source annotation tool released by Microsoft.
<a href="https://roboflow.com/formats/vott-csv">VoTT CSV</a> is the format used by VoTT
when the user exports a project and selects &ldquo;CSV&rdquo; as the export format.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Bbox</code></li>
</ul>
<h2 id="import-vott-dataset">Import VoTT dataset</h2>
<p>A Datumaro project with a VoTT CSV source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format vott_csv &lt;path/to/dataset&gt;
</code></pre></div><p>It is also possible to import the dataset using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">vott_csv_dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;vott_csv&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>VoTT CSV dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>dataset/
├── dataset_meta.json # a list of custom labels (optional)
├── img0001.jpg
├── img0002.jpg
├── img0003.jpg
├── img0004.jpg
├── ...
├── test-export.csv
├── train-export.csv
└── ...
</code></pre><p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert a VoTT CSV dataset into any other format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to a format
that supports bounding boxes.</p>
<p>There are several ways to convert a VoTT CSV dataset to other dataset
formats using CLI:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f vott_csv &lt;path/to/dataset&gt;
datum <span style="color:#204a87">export</span> -f voc -o ./save_dir -- --save-media
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if vott_csv -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f voc -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;vott_csv&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/test_vott_csv_format.py">VoTT CSV tests</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-8a75782b4046ca46b25aa3933564c2f1">5.37 - VoTT JSON</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p><a href="https://github.com/microsoft/VoTT">VoTT</a> (Visual Object Tagging Tool) is
an open source annotation tool released by Microsoft.
<a href="https://roboflow.com/formats/vott-json">VoTT JSON</a> is the format used by VoTT
when the user exports a project and selects &ldquo;VoTT JSON&rdquo; as the export format.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Bbox</code></li>
</ul>
<h2 id="import-vott-dataset">Import VoTT dataset</h2>
<p>A Datumaro project with a VoTT JSON source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format vott_json &lt;path/to/dataset&gt;
</code></pre></div><p>It is also possible to import the dataset using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">vott_json_dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;vott_json&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>VoTT JSON dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>dataset/
├── dataset_meta.json # a list of custom labels (optional)
├── img0001.jpg
├── img0002.jpg
├── img0003.jpg
├── img0004.jpg
├── ...
├── test-export.json
├── train-export.json
└── ...
</code></pre><p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert a VoTT JSON dataset into any other format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
To get the expected result, convert the dataset to a format
that supports bounding boxes.</p>
<p>There are several ways to convert a VoTT JSON dataset to other dataset
formats using CLI:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f vott_json &lt;path/to/dataset&gt;
datum <span style="color:#204a87">export</span> -f voc -o ./save_dir -- --save-media
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if vott_json -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -f voc -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;vott_json&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;voc&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="examples">Examples</h2>
<p>Examples of using this format from the code can be found in
<a href="https://github.com/openvinotoolkit/datumaro/blob/develop/tests/test_vott_json_format.py">VoTT JSON tests</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a962132bc0e143f3a9b4c97def6ab2ba">5.38 - WIDER Face</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>WIDER Face dataset is a face detection benchmark dataset,
that available for download <a href="http://shuoyang1213.me/WIDERFACE/#Download">here</a>.</p>
<p>Supported types of annotation:</p>
<ul>
<li><code>Bbox</code></li>
<li><code>Label</code></li>
</ul>
<p>Supported attributes for bboxes:</p>
<ul>
<li><code>blur</code>:
<ul>
<li>0 face without blur;</li>
<li>1 face with normal blur;</li>
<li>2 face with heavy blur.</li>
</ul>
</li>
<li><code>expression</code>:
<ul>
<li>0 face with typical expression;</li>
<li>1 face with exaggerate expression.</li>
</ul>
</li>
<li><code>illumination</code>:
<ul>
<li>0 image contains normal illumination;</li>
<li>1 image contains extreme illumination.</li>
</ul>
</li>
<li><code>pose</code>:
<ul>
<li>0 pose is typical;</li>
<li>1 pose is atypical.</li>
</ul>
</li>
<li><code>invalid</code>:
<ul>
<li>0 image is valid;</li>
<li>1 image is invalid.</li>
</ul>
</li>
<li><code>occluded</code>:
<ul>
<li>0 face without occlusion;</li>
<li>1 face with partial occlusion;</li>
<li>2 face with heavy occlusion.</li>
</ul>
</li>
</ul>
<h2 id="import-wider-face-dataset">Import WIDER Face dataset</h2>
<p>Importing of WIDER Face dataset into the Datumaro project:</p>
<pre><code>datum create
datum import -f wider_face &lt;path_to_wider_face&gt;
</code></pre><p>Directory with WIDER Face dataset should has the following structure:</p>
<pre><code>&lt;path_to_wider_face&gt;
├── labels.txt  # optional file with list of classes
├── wider_face_split # directory with description of bboxes for each image
│   ├── wider_face_subset1_bbx_gt.txt
│   ├── wider_face_subset2_bbx_gt.txt
│   ├── ...
├── WIDER_subset1 # instead of 'subset1' you can use any other subset name
│   └── images
│       ├── 0--label_0 # instead of 'label_&lt;n&gt;' you can use any other class name
│       │   ├──  0_label_0_image_01.jpg
│       │   ├──  0_label_0_image_02.jpg
│       │   ├──  ...
│       ├── 1--label_1
│       │   ├──  1_label_1_image_01.jpg
│       │   ├──  1_label_1_image_02.jpg
│       │   ├──  ...
│       ├── ...
├── WIDER_subset2
│  └── images
│      ├── ...
├── ...
</code></pre><p>Check <a href="http://shuoyang1213.me/WIDERFACE/support/bbx_annotation/wider_face_split.zip">README</a>
file of the original WIDER Face dataset to get more information
about structure of <code>.txt</code> annotation files.
Also example of WIDER Face dataset available in our
<a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/assets/widerface_dataset">test assets</a>.</p>
<h2 id="export-wider-face-dataset">Export WIDER Face dataset</h2>
<p>With Datumaro you can convert WIDER Face dataset into any other
format <a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
Pay attention that this format should also support <code>Label</code> and/or <code>Bbox</code>
annotation types.</p>
<p>Few ways to export WIDER Face dataset using CLI:</p>
<pre><code># Using `convert` command
datum convert -if wider_face -i &lt;path_to_wider_face&gt; \
    -f voc -o &lt;output_dir&gt; -- --save-media

# Through the Datumaro project
datum create
datum import -f wider_face &lt;path_to_wider_face&gt;
datum export -f voc -o &lt;output_dir&gt; -- -save-media
</code></pre><p>Export WIDER Face dataset using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path_to_wider_face&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;wider_face&#39;</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#8f5902;font-style:italic"># Here you can perform some transformation using dataset.transform or</span>
<span style="color:#8f5902;font-style:italic"># dataset.filter</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;output_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;open_images&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><blockquote>
<p>Note: some formats have extra export options. For particular format see the
<a href="../../docs/formats/">docs</a> to get information about it.</p>
</blockquote>
<h2 id="export-to-wider-face-dataset">Export to WIDER Face dataset</h2>
<p>Using Datumaro you can convert your dataset into the WIDER Face format,
but for succseful exporting your dataset should contain <code>Label</code> and/or <code>Bbox</code>.</p>
<p>Here example of exporting VOC dataset (object detection task)
into the WIDER Face format:</p>
<pre><code>datum create
datum import -f voc_detection &lt;path_to_voc&gt;
datum export -f wider_face -o &lt;output_dir&gt; -- --save-media --image-ext='.png'
</code></pre><p>Available extra export options for WIDER Face dataset format:</p>
<ul>
<li><code>--save-media</code> allow to export dataset with saving media files
(by default <code>False</code>)</li>
<li><code>--image-ext IMAGE_EXT</code> allow to specify image extension
for exporting dataset (by default - keep original)</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f638f1a110145e49bc81ee72961dd7ef">5.39 - YOLO</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>The YOLO dataset format is for training and validating object detection
models. Specification for this format is available
<a href="https://github.com/AlexeyAB/darknet#how-to-train-to-detect-your-custom-objects">here</a>.</p>
<p>You can also find official examples of working with YOLO dataset <a href="https://pjreddie.com/darknet/yolo/">here</a>.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Bounding boxes</code></li>
</ul>
<p>YOLO format doesn&rsquo;t support attributes for annotations.</p>
<p>The format supports arbitrary subset names, except <code>classes</code>, <code>names</code> and <code>backup</code>.</p>
<blockquote>
<p>Note, that by default, the YOLO framework does not expect any subset names,
except <code>train</code> and <code>valid</code>, Datumaro supports this as an extension.
If there is no subset separation in a project, the data
will be saved in the <code>train</code> subset.</p>
</blockquote>
<h2 id="import-yolo-dataset">Import YOLO dataset</h2>
<p>A Datumaro project with a YOLO source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format yolo &lt;path/to/dataset&gt;
</code></pre></div><h3 id="directory-structure">Directory structure</h3>
<p>YOLO dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>└─ yolo_dataset/
   │
   ├── dataset_meta.json # a list of non-format labels (optional)
   ├── obj.names  # file with list of classes
   ├── obj.data   # file with dataset information
   ├── train.txt  # list of image paths in train subset
   ├── valid.txt  # list of image paths in valid subset
   │
   ├── obj_train_data/  # directory with annotations and images for train subset
   │    ├── image1.txt  # list of labeled bounding boxes for image1
   │    ├── image1.jpg
   │    ├── image2.txt
   │    ├── image2.jpg
   │    └── ...
   │
   └── obj_valid_data/  # directory with annotations and images for valid subset
        ├── image101.txt
        ├── image101.jpg
        ├── image102.txt
        ├── image102.jpg
        └── ...
</code></pre><h4 id="meta-file">Meta file</h4>
<ul>
<li><code>obj.data</code> should have the following content, it is not necessary to have both
subsets, but necessary to have one of them:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">classes = 5 # optional
names = &lt;path/to/obj.names&gt;
train = &lt;path/to/train.txt&gt;
valid = &lt;path/to/valid.txt&gt;
backup = backup/ # optional
</code></pre></div><h4 id="class-names-file">Class names file</h4>
<ul>
<li><code>obj.names</code> contains a list of classes.
The line number for the class is the same as its index:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">label1  # label1 has index 0
label2  # label2 has index 1
label3  # label2 has index 2
...
</code></pre></div><h4 id="subset-files">Subset files</h4>
<ul>
<li>Files <code>train.txt</code> and <code>valid.txt</code> should have the following structure:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">&lt;path/to/image1.jpg&gt;
&lt;path/to/image2.jpg&gt;
...
</code></pre></div><h4 id="bounding-box-annotation-text-file">Bounding box annotation text file</h4>
<ul>
<li>Files in directories <code>obj_train_data/</code> and <code>obj_valid_data/</code>
should contain information about labeled bounding boxes
for images:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt"># image1.txt:
# &lt;label_index&gt; &lt;x_center&gt; &lt;y_center&gt; &lt;width&gt; &lt;height&gt;
0 0.250000 0.400000 0.300000 0.400000
3 0.600000 0.400000 0.400000 0.266667
</code></pre></div><p>Here <code>x_center</code>, <code>y_center</code>, <code>width</code>, and <code>height</code> are relative to the image&rsquo;s
width and height. The <code>x_center</code> and <code>y_center</code> are center of rectangle
(are not top-left corner).</p>
<p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>.</p>
<h2 id="import-yolo-dataset-with-more-loose-format">Import YOLO dataset with more loose format</h2>
<p>Because the original YOLO format is too strict and require many meta files,
Datumaro supports to import more loose format for YOLO dataset.
Therefore, you can freely import a dataset with <a href="#bounding-box-annotation-text-file">a bounding box text file</a>,
which is the standing-out identity of the yolo format.
For examples, please see the following directory structures.</p>
<h3 id="directory-structure-1">Directory structure</h3>
<h4 id="without-subset-directories">Without subset directories</h4>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">└─ yolo_dataset/
   ├── dataset_meta.json <span style="color:#8f5902;font-style:italic"># a list of non-format labels (optional)</span>
   ├── obj.names  <span style="color:#8f5902;font-style:italic"># file with list of classes</span>
   ├── &lt;Annotations or Labels&gt;/  <span style="color:#8f5902;font-style:italic"># directory with annotations which can be Annotations/ or Labels/</span>
   │    ├── image1.txt <span style="color:#8f5902;font-style:italic"># list of labeled bounding boxes for image1</span>
   │    ├── image2.txt
   │    └── ...
   └── Images/  <span style="color:#8f5902;font-style:italic"># directory with images</span>
        ├── image1.jpg <span style="color:#8f5902;font-style:italic"># The image name (&#34;image1&#34;) should be exactly paired with the annotation txt file (&#34;image1.txt&#34;)</span>
        ├── image2.jpg
        └── ...
</code></pre></div><h4 id="with-subset-directories">With subset directories</h4>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">└─ yolo_dataset/
    ├── dataset_meta.json <span style="color:#8f5902;font-style:italic"># a list of non-format labels (optional)</span>
    ├── obj.names  <span style="color:#8f5902;font-style:italic"># file with list of classes</span>
    ├── &lt;Annotations or Labels&gt;/ <span style="color:#8f5902;font-style:italic"># directory with annotations which can be Annotations/ or Labels/</span>
    ├── labels
    │   ├── train <span style="color:#8f5902;font-style:italic"># Subset name &#34;train&#34;</span>
    │   │   ├── image1.txt <span style="color:#8f5902;font-style:italic"># list of labeled bounding boxes for image1</span>
    │   │   ├── image2.txt
    │   │   └── ...
    │   └── val <span style="color:#8f5902;font-style:italic"># Subset name &#34;val&#34;</span>
    │   │   ├── image1.txt
    │   │   ├── image2.txt
    │   │   └── ...
    └── Images/  <span style="color:#8f5902;font-style:italic"># directory with images</span>
        ├── train
        │   ├── image1.jpg <span style="color:#8f5902;font-style:italic"># The image name (&#34;image1&#34;) should be exactly paired with the annotation txt file (&#34;image1.txt&#34;)</span>
        │   ├── image2.jpg
        │   └── ...
        └── val
            ├── image1.jpg
            ├── image2.jpg
            └── ...
</code></pre></div><h4 id="class-names-file-1">Class names file</h4>
<p>Same as <a href="#class-names-file">Import YOLO dataset - Class names file section</a>. If it is not existed in the dataset, you can make this file easily. Please see the example <a href="../python-api/python-api-examples/tiling.md">here</a>.</p>
<h4 id="bounding-box-annotation-text-file-1">Bounding box annotation text file</h4>
<p>Same as <a href="#bounding-box-annotation-text-file">Import YOLO dataset - Bounding box annotation text file section</a>.</p>
<h2 id="export-to-other-formats">Export to other formats</h2>
<p>Datumaro can convert YOLO dataset into any other format
<a href="../../docs/user-manual/supported_formats/">Datumaro supports</a>.
For successful conversion the output format should support
object detection task (e.g. Pascal VOC, COCO, TF Detection API etc.)</p>
<p>There are several ways to convert a YOLO dataset to other dataset formats:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum add -f yolo &lt;path/to/yolo/&gt;
datum <span style="color:#204a87">export</span> -f voc -o &lt;output/dir&gt;
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if yolo -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>              -f coco_instances -o &lt;path/to/dataset&gt;
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;yolo&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;coco_instances&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h2 id="export-to-yolo-format">Export to YOLO format</h2>
<p>Datumaro can convert an existing dataset to YOLO format,
if the dataset supports object detection task.</p>
<p>Example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f coco_instances &lt;path/to/dataset&gt;
datum <span style="color:#204a87">export</span> -f yolo -o &lt;path/to/dataset&gt; -- --save-media
</code></pre></div><p>Extra options for exporting to YOLO format:</p>
<ul>
<li><code>--save-media</code> allow to export dataset with saving media files
(default: <code>False</code>)</li>
<li><code>--image-ext &lt;IMAGE_EXT&gt;</code> allow to specify image extension
for exporting dataset (default: use original or <code>.jpg</code>, if none)</li>
<li><code>--add-path-prefix</code> allows to specify, whether to include the
<code>data/</code> path prefix in the annotation files or not (default: <code>True</code>)</li>
</ul>
<h2 id="examples">Examples</h2>
<h3 id="example-1-prepare-pascal-voc-dataset-for-exporting-to-yolo-format-dataset">Example 1. Prepare PASCAL VOC dataset for exporting to YOLO format dataset</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o project
datum import -p project -f voc ./VOC2012
datum filter -p project -e <span style="color:#4e9a06">&#39;/item[subset=&#34;train&#34; or subset=&#34;val&#34;]&#39;</span>
datum transform -p project -t map_subsets -- -s train:train -s val:valid
datum <span style="color:#204a87">export</span> -p project -f yolo -- --save-media
</code></pre></div><h3 id="example-2-remove-a-class-from-yolo-dataset">Example 2. Remove a class from YOLO dataset</h3>
<p>Delete all items, which contain <code>cat</code> objects and remove
<code>cat</code> from list of classes:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o project
datum import -p project -f yolo ./yolo_dataset
datum filter -p project -m i+a -e <span style="color:#4e9a06">&#39;/item/annotation[label!=&#34;cat&#34;]&#39;</span>
datum transform -p project -t remap_labels -- -l cat:
datum <span style="color:#204a87">export</span> -p project -f yolo -o ./yolo_without_cats
</code></pre></div><h3 id="example-3-create-a-custom-dataset-in-yolo-format">Example 3. Create a custom dataset in YOLO format</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">numpy</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">np</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_iterable</span><span style="color:#000;font-weight:bold">([</span>
    <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;image_001&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">subset</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;train&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">20</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">20</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)),</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
            <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Bbox</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">3.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span>
            <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Bbox</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">10.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#000;font-weight:bold">]</span>
    <span style="color:#000;font-weight:bold">),</span>
    <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DatasetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;image_002&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">subset</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;train&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#000">image</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ones</span><span style="color:#000;font-weight:bold">((</span><span style="color:#0000cf;font-weight:bold">15</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)),</span>
        <span style="color:#000">annotations</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span>
            <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Bbox</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">4.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#000;font-weight:bold">]</span>
    <span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">],</span> <span style="color:#000">categories</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;house&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;bridge&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;crosswalk&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;traffic_light&#39;</span><span style="color:#000;font-weight:bold">])</span>

<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;../yolo_dataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;yolo&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h3 id="example-4-get-information-about-objects-on-each-image">Example 4. Get information about objects on each image</h3>
<p>If you only want information about label names for each
image, then you can get it from code:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;./yolo_dataset&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;yolo&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">cats</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">categories</span><span style="color:#000;font-weight:bold">()[</span><span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">AnnotationType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">label</span><span style="color:#000;font-weight:bold">]</span>

<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">item</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">dataset</span><span style="color:#000;font-weight:bold">:</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">ann</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">item</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">annotations</span><span style="color:#000;font-weight:bold">:</span>
        <span style="color:#204a87;font-weight:bold">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">item</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">cats</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">ann</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">label</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">name</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>And If you want complete information about each item you can run:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o project
datum import -p project -f yolo ./yolo_dataset
datum filter -p project --dry-run -e <span style="color:#4e9a06">&#39;/item&#39;</span>
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-b1944d9ac875eeb7ed131a1bd440f5f5">5.40 - YOLO-Ultralytics</h1>
    
	<h2 id="format-specification">Format specification</h2>
<p>The YOLO-Ultralytics dataset format is used for <a href="https://github.com/ultralytics/ultralytics">Ultralytics YOLOv8</a>, developed by <a href="https://ultralytics.com/">Ultralytics</a>. An example for this format is available <a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/datasets/coco.yaml">here</a>. This format shares the same annotation bounding box text file format with <a href="./yolo.md#bounding-box-annotation-text-file">YOLO</a>. However, it requires a YAML meta file where <code>train</code>, <code>val</code>, and <code>test</code> (optional) subsets are specified.</p>
<p>Supported annotation types:</p>
<ul>
<li><code>Bounding boxes</code></li>
</ul>
<p>YOLO-Ultralytics format doesn&rsquo;t support attributes for annotations.</p>
<p>The format only supports three subset names: <code>train</code>, <code>val</code>, and <code>test</code> (optional).</p>
<blockquote>
<p>Note, the YOLO-Ultralytics trainer does not expect any subset names,
except <code>train</code>, <code>val</code>, and <code>test</code> (optional). If there is any other subset name in your project,
Datumaro raises an exception when you export the dataset to the YOLO-Ultralytics format.</p>
</blockquote>
<h2 id="import-yolo-dataset">Import YOLO dataset</h2>
<p>A Datumaro project with a YOLO source can be created in the following way:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format yolo &lt;path/to/dataset&gt;
</code></pre></div><h3 id="directory-structure">Directory structure</h3>
<p>YOLO dataset directory should have the following structure:</p>
<!--lint disable fenced-code-flag-->
<pre><code>yolo-ultralytics/
├── dataset_meta.json   # a list of non-format labels (optional)
├── data.yaml           # YAML meta file (required)
├── train.txt           # Train image file list (required)
├── val.txt             # Validation image file list (required)
├── test.txt            # Test image file list (optional)
├── images              # Image directory
│   ├── train           # (required)
│   │   ├── img1.jpg    # Image file
│   │   ├── img2.jpg
│   │   └── ...
│   ├── val             # (required)
│   └── test            # (optional)
└── labels              # Label directory
    ├── train           # (required)
    │   ├── img1.txt    # Bounding box label file (Its name must be paired with the image)
    │   ├── img2.txt
    │   └── ...
    ├── val             # (required)
    └── test            # (optional)
</code></pre><h4 id="meta-file">Meta file</h4>
<ul>
<li><code>data.yaml</code> should have the following content:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">test</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test.txt</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># (optional)</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">train</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">train.txt</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">val</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">val.txt</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">names</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">0</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;label_name_1&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">1</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">&lt;label_name_1&gt;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div><h4 id="subset-files">Subset files</h4>
<ul>
<li>Files <code>train.txt</code>, <code>val.txt</code>, and <code>test.txt</code> (optional) should have the following structure:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">./images/&lt;subset-name&gt;/&lt;image-file-name-1.jpg&gt;
./images/&lt;subset-name&gt;/&lt;image-file-name-2.jpg&gt;
...
</code></pre></div><h4 id="bounding-box-annotation-text-file">Bounding box annotation text file</h4>
<ul>
<li>Files in directories <code>labels/&lt;subset-name&gt;</code> should contain information about labeled bounding boxes
for images:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt"># image1.txt:
# &lt;label_index&gt; &lt;x_center&gt; &lt;y_center&gt; &lt;width&gt; &lt;height&gt;
0 0.250000 0.400000 0.300000 0.400000
3 0.600000 0.400000 0.400000 0.266667
</code></pre></div><p>Here <code>x_center</code>, <code>y_center</code>, <code>width</code>, and <code>height</code> are relative to the image&rsquo;s
width and height. The <code>x_center</code> and <code>y_center</code> are center of rectangle
(are not top-left corner).</p>
<p>To add custom classes, you can use <a href="../../docs/user-manual/supported_formats/#dataset-meta-file"><code>dataset_meta.json</code></a>.</p>
<h2 id="export-to-yolo-ultralytics-format">Export to YOLO-Ultralytics format</h2>
<p>Datumaro can convert <a href="../../docs/user-manual/supported_formats/">any other image dataset format</a> which has bounding box annotations into YOLO-Ultralytics format.
After the successful conversion, you can train your own detecter with the exported dataset and  <a href="https://github.com/ultralytics/ultralytics">Ultralytics YOLOv8 trainer</a>.</p>
<blockquote>
<p>Note, if you want to see the end-to-end Jupyter-notebook example from the dataset conversion to the training, please see this <a href="https://github.com/openvinotoolkit/datumaro/blob/develop/notebooks/08_e2e_example_yolo_ultralytics_trainer.ipynb">link</a>.</p>
</blockquote>
<p>There are several ways to convert other dataset formats to the YOLO-Ultralytics format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum add -f &lt;any-other-dataset-format&gt; &lt;path/to/dataset/&gt;
datum <span style="color:#204a87">export</span> -f yolo_ultralytics -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert -if &lt;any-other-dataset-format&gt; -i &lt;path/to/dataset&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>              -f yolo_ultralytics -o &lt;output/dir&gt; -- --save-media
</code></pre></div><p>Or, using Python API:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">dataset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">import_from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;path/to/dataset&gt;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;&lt;any-other-dataset-format&gt;&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">dataset</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">export</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;save_dir&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;yolo_ultralytics&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">save_media</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><blockquote>
<p>Note, we recommend you to turn on <code>--save-media</code> (CLI) or <code>save_media=True</code> (Python API) option. This is because without this option, you would have to manually copy and paste the image into the appropriate location in the exported dataset directory. Enabling this option will save your manual effort.</p>
</blockquote>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-bb346cf0596c62e042775b393e7fd9b8">6 - Plugins</h1>
    
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-900c5314d5f38425d40d967abd17bea1">6.1 - OpenVINO™ Inference Interpreter</h1>
    <div class="lead">Interpreter samples to parse OpenVINO™ inference outputs. This section on <a href="https://github.com/openvinotoolkit/datumaro/tree/develop/datumaro/plugins/openvino_plugin">GitHub</a></div>
	<h2 id="models-supported-from-interpreter-samples">Models supported from interpreter samples</h2>
<p>There are detection and image classification examples.</p>
<ul>
<li>
<p>Detection (SSD-based)</p>
<ul>
<li>
<p>Intel Pre-trained Models &gt; Object Detection</p>
<ul>
<li><a href="https://docs.openvinotoolkit.org/latest/omz_models_intel_face_detection_0200_description_face_detection_0200.html">face-detection-0200</a></li>
<li><a href="https://docs.openvinotoolkit.org/latest/omz_models_intel_face_detection_0202_description_face_detection_0202.html">face-detection-0202</a></li>
<li><a href="https://docs.openvinotoolkit.org/latest/omz_models_intel_face_detection_0204_description_face_detection_0204.html">face-detection-0204</a></li>
<li><a href="https://docs.openvinotoolkit.org/latest/omz_models_intel_person_detection_0200_description_person_detection_0200.html">person-detection-0200</a></li>
<li><a href="https://docs.openvinotoolkit.org/latest/omz_models_intel_person_detection_0201_description_person_detection_0201.html">person-detection-0201</a></li>
<li><a href="https://docs.openvinotoolkit.org/latest/omz_models_intel_person_detection_0202_description_person_detection_0202.html">person-detection-0202</a></li>
<li><a href="https://docs.openvinotoolkit.org/latest/omz_models_intel_person_vehicle_bike_detection_2000_description_person_vehicle_bike_detection_2000.html">person-vehicle-bike-detection-2000</a></li>
<li><a href="https://docs.openvinotoolkit.org/latest/omz_models_intel_person_vehicle_bike_detection_2001_description_person_vehicle_bike_detection_2001.html">person-vehicle-bike-detection-2001</a></li>
<li><a href="https://docs.openvinotoolkit.org/latest/omz_models_intel_person_vehicle_bike_detection_2002_description_person_vehicle_bike_detection_2002.html">person-vehicle-bike-detection-2002</a></li>
<li><a href="https://docs.openvinotoolkit.org/latest/omz_models_intel_vehicle_detection_0200_description_vehicle_detection_0200.html">vehicle-detection-0200</a></li>
<li><a href="https://docs.openvinotoolkit.org/latest/omz_models_intel_vehicle_detection_0201_description_vehicle_detection_0201.html">vehicle-detection-0201</a></li>
<li><a href="https://docs.openvinotoolkit.org/latest/omz_models_intel_vehicle_detection_0202_description_vehicle_detection_0202.html">vehicle-detection-0202</a></li>
</ul>
</li>
<li>
<p>Public Pre-Trained Models(OMZ) &gt; Object Detection</p>
<ul>
<li><a href="https://docs.openvinotoolkit.org/latest/omz_models_public_ssd_mobilenet_v1_coco_ssd_mobilenet_v1_coco.html">ssd_mobilenet_v1_coco</a></li>
<li><a href="https://docs.openvinotoolkit.org/latest/omz_models_public_ssd_mobilenet_v2_coco_ssd_mobilenet_v2_coco.html">ssd_mobilenet_v2_coco</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p>Image Classification</p>
<ul>
<li>Public Pre-Trained Models(OMZ) &gt; Classification
<ul>
<li><a href="https://docs.openvinotoolkit.org/latest/omz_models_public_mobilenet_v2_pytorch_mobilenet_v2_pytorch.html">mobilenet-v2-pytorch</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>You can find more OpenVINO™ Trained Models
<a href="https://docs.openvinotoolkit.org/latest/omz_models_intel_index.html">here</a>
To run the inference with OpenVINO™, the model format should be Intermediate
Representation(IR).
For the Caffe/TensorFlow/MXNet/Kaldi/ONNX models, please see the
<a href="https://docs.openvinotoolkit.org/latest/openvino_docs_MO_DG_prepare_model_convert_model_Converting_Model.html">Model Conversion Instruction</a></p>
<p>You need to implement your own interpreter samples to support the other
OpenVINO™ Trained Models.</p>
<h2 id="model-download">Model download</h2>
<p>Prerequisites:</p>
<ul>
<li>OpenVINO™ (To install OpenVINO™, please see the
<a href="https://docs.openvinotoolkit.org/latest/openvino_docs_install_guides_installing_openvino_linux.html">OpenVINO™ Installation Instruction</a>)</li>
<li>OpenVINO™ models (To download OpenVINO™ models, please see the <a href="https://docs.openvinotoolkit.org/latest/omz_tools_downloader_README.html">Model Downloader Instruction</a>)</li>
<li>PASCAL VOC 2012 dataset (To download VOC 2012 dataset, please go <a href="http://host.robots.ox.ac.uk/pascal/VOC/voc2012/#devkit">VOC2012 download</a>)</li>
</ul>
<p>Open Model Zoo models can be downloaded with the Model Downloader tool
from OpenVINO™ distribution:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#204a87">cd</span> &lt;openvino_dir&gt;/deployment_tools/open_model_zoo/tools/downloader
./downloader.py --name &lt;model_name&gt;
</code></pre></div><p>Example: download the &ldquo;face-detection-0200&rdquo; model</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#204a87">cd</span> /opt/intel/openvino/deployment_tools/open_model_zoo/tools/downloader
./downloader.py --name face-detection-0200
</code></pre></div><h2 id="model-inference">Model inference</h2>
<p>Prerequisites:</p>
<ul>
<li>OpenVINO™ (To install OpenVINO™, please see the
<a href="https://docs.openvinotoolkit.org/latest/openvino_docs_install_guides_installing_openvino_linux.html">OpenVINO™ Installation Instruction</a>)</li>
<li>Datumaro (To install Datumaro, please see the <a href="../../docs/user-manual/">User Manual</a>)</li>
<li>OpenVINO™ models (To download OpenVINO™ models, please see the <a href="https://docs.openvinotoolkit.org/latest/omz_tools_downloader_README.html">Model Downloader Instruction</a>)</li>
<li>PASCAL VOC 2012 dataset (To download VOC 2012 dataset, please go <a href="http://host.robots.ox.ac.uk/pascal/VOC/voc2012/#devkit">VOC2012 download</a>)</li>
</ul>
<h2 id="examples">Examples</h2>
<p>To run the inference with OpenVINO™ models and the interpreter samples,
please follow the instructions below.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#204a87">source</span> &lt;openvino_dir&gt;/bin/setupvars.sh
datum create -o &lt;proj_dir&gt;
datum model add -l &lt;launcher&gt; -p &lt;proj_dir&gt; --copy -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -d &lt;path/to/xml&gt; -w &lt;path/to/bin&gt; -i &lt;path/to/interpreter/script&gt;
datum import -p &lt;proj_dir&gt; -f &lt;format&gt; &lt;path_to_dataset&gt;
datum model run -p &lt;proj_dir&gt; -m model-0
</code></pre></div><h3 id="detection-ssd_mobilenet_v2_coco">Detection: ssd_mobilenet_v2_coco</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#204a87">source</span> /opt/intel/openvino/bin/setupvars.sh
<span style="color:#204a87">cd</span> datumaro/plugins/openvino_plugin
datum create -o proj
datum model add -l openvino -p proj --copy -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    --output-layers<span style="color:#ce5c00;font-weight:bold">=</span>do_ExpandDims_conf/sigmoid <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -d model/ssd_mobilenet_v2_coco.xml <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -w model/ssd_mobilenet_v2_coco.bin <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -i samples/ssd_mobilenet_coco_detection_interp.py
datum import -p proj -f voc VOCdevkit/
datum model run -p proj -m model-0
</code></pre></div><h3 id="classification-mobilenet-v2-pytorch">Classification: mobilenet-v2-pytorch</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#204a87">source</span> /opt/intel/openvino/bin/setupvars.sh
<span style="color:#204a87">cd</span> datumaro/plugins/openvino_plugin
datum create -o proj
datum model add -l openvino -p proj --copy -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -d model/mobilenet-v2-pytorch.xml <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -w model/mobilenet-v2-pytorch.bin <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -i samples/mobilenet_v2_pytorch_interp.py
datum import -p proj -f voc VOCdevkit/
datum model run -p proj -m model-0
</code></pre></div>
</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-05b7a8e562e0a482b29460c121776963">7 - Contribution Guide</h1>
    
	<h2 id="related-sections">Related sections</h2>
<ul>
<li><a href="../../docs/design/">Design document</a></li>
<li><a href="../../api/api/developer_manual.html">Developer manual</a></li>
</ul>
<h2 id="installation">Installation</h2>
<h3 id="prerequisites">Prerequisites</h3>
<ul>
<li>Python (3.7+)</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">git clone https://github.com/openvinotoolkit/datumaro
</code></pre></div><p>Optionally, install a virtual environment (recommended):</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python -m pip install virtualenv
python -m virtualenv venv
. venv/bin/activate
</code></pre></div><p>Then install all dependencies:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pip install -r requirements.txt
</code></pre></div><p>Install Datumaro:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pip install -e /path/to/the/cloned/repo/
</code></pre></div><p><strong>Optional dependencies</strong></p>
<p>These components are only required for plugins and not installed by default:</p>
<ul>
<li>OpenVINO</li>
<li>Accuracy Checker</li>
<li>TensorFlow</li>
<li>PyTorch</li>
<li>MxNet</li>
<li>Caffe</li>
</ul>
<h2 id="usage">Usage</h2>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum --help
python -m datumaro --help
python datumaro/ --help
python datum.py --help
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span>
</code></pre></div><h2 id="code-style">Code style</h2>
<p>Try to be readable and consistent with the existing codebase.</p>
<p>The project uses Black for code formatting and isort for sorting import statements.
You can find corresponding configurations in <code>pyproject.toml</code> in the repository root.
No trailing whitespaces, at most 100 characters per line.</p>
<p>Datumaro includes a Git pre-commit hook, <code>dev/pre-commit.py</code> that can help you
follow the style requirements. See the comment at the top of that file for more information.</p>
<h2 id="environment">Environment</h2>
<p>The recommended editor is VS Code with the Python language plugin.</p>
<p><a id="testing"></a></p>
<h2 id="testing">Testing</h2>
<p>It is expected that all Datumaro functionality is covered and checked by
unit tests. Tests are placed in the <code>tests/</code> directory. Additional
pre-generated files for tests can be stored in the <code>tests/assets/</code> directory.
CLI tests are separated from the core tests, they are stored in the
<code>tests/cli/</code> directory.</p>
<p>Currently, we use <a href="https://docs.pytest.org/"><code>pytest</code></a> for testing.</p>
<p>To run tests use:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pytest -v
</code></pre></div><p>or</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python -m pytest -v
</code></pre></div><p><a id="Test_case_description"></a></p>
<h3 id="test-cases">Test cases</h3>
<p><a id="Test_marking"></a></p>
<h3 id="test-marking">Test marking</h3>
<p>For better integration with CI and requirements tracking,
we use special annotations for tests.</p>
<p>A test needs to linked with a requirement it is related to. To link a
test, use:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">unittest</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">TestCase</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">.requirements</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Requirements</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">mark_requirement</span>

<span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">MyTests</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">TestCase</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#5c35cc;font-weight:bold">@mark_requirement</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Requirements</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DATUM_GENERAL_REQ</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">test_my_requirement</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#ce5c00;font-weight:bold">...</span> <span style="color:#000">do</span> <span style="color:#000">stuff</span> <span style="color:#ce5c00;font-weight:bold">...</span>
</code></pre></div><p>Such marking will apply markings from the requirement specified.
They can be overridden for a specific test:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">pytest</span>

<span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">MyTests</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">TestCase</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#5c35cc;font-weight:bold">@pytest.mark.priority_low</span>
    <span style="color:#5c35cc;font-weight:bold">@mark_requirement</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Requirements</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DATUM_GENERAL_REQ</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">test_my_requirement</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#ce5c00;font-weight:bold">...</span> <span style="color:#000">do</span> <span style="color:#000">stuff</span> <span style="color:#ce5c00;font-weight:bold">...</span>
</code></pre></div><p><a id="Requirements"></a></p>
<h4 id="requirements">Requirements</h4>
<p>Requirements and other links need to be added to <a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/requirements.py"><code>tests/requirements.py</code></a>:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">DATUM_244</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Add Snyk integration&#34;</span>
<span style="color:#000">DATUM_BUG_219</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Return format is not uniform&#34;</span>
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#8f5902;font-style:italic"># Fully defined in GitHub issues:</span>
<span style="color:#5c35cc;font-weight:bold">@pytest.mark.reqids</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Requirements</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DATUM_244</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">Requirements</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DATUM_333</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#8f5902;font-style:italic"># And defined any other way:</span>
<span style="color:#5c35cc;font-weight:bold">@pytest.mark.reqids</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Requirements</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DATUM_GENERAL_REQ</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><h5 id="available-annotations-for-tests-and-requirements">Available annotations for tests and requirements</h5>
<p>Markings are defined in <a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/conftest.py"><code>tests/conftest.py</code></a>.</p>
<p><strong>A list of requirements and bugs</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#5c35cc;font-weight:bold">@pytest.mark.requids</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Requirements</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DATUM_123</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#5c35cc;font-weight:bold">@pytest.mark.bugs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Requirements</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DATUM_BUG_456</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p><strong>A priority</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#5c35cc;font-weight:bold">@pytest.mark.priority_low</span>
<span style="color:#5c35cc;font-weight:bold">@pytest.mark.priority_medium</span>
<span style="color:#5c35cc;font-weight:bold">@pytest.mark.priority_high</span>
</code></pre></div><p><strong>Component</strong>
The marking used for indication of different system components</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#5c35cc;font-weight:bold">@pytest.mark.components</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DatumaroComponent</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Datumaro</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p><strong>Skipping tests</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#5c35cc;font-weight:bold">@pytest.mark.skip</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">SkipMessages</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">NOT_IMPLEMENTED</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p><strong>Parametrized runs</strong></p>
<p>Parameters are used for running the same test with different parameters e.g.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#5c35cc;font-weight:bold">@pytest.mark.parametrize</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;numpy_array, batch_size&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">[</span>
    <span style="color:#000;font-weight:bold">(</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">zeros</span><span style="color:#000;font-weight:bold">([</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">]),</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">),</span>
    <span style="color:#000;font-weight:bold">(</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">zeros</span><span style="color:#000;font-weight:bold">([</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">]),</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span>
    <span style="color:#000;font-weight:bold">(</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">zeros</span><span style="color:#000;font-weight:bold">([</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">]),</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">),</span>
    <span style="color:#000;font-weight:bold">(</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">zeros</span><span style="color:#000;font-weight:bold">([</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">]),</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">),</span>
    <span style="color:#000;font-weight:bold">(</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">zeros</span><span style="color:#000;font-weight:bold">([</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">]),</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">),</span>
<span style="color:#000;font-weight:bold">])</span>
</code></pre></div><p><a id="TestDoc"></a></p>
<h3 id="test-documentation">Test documentation</h3>
<p>Tests are documented with docs strings. Test descriptions must contain
the following: sections: <code>Description</code>, <code>Expected results</code> and <code>Steps</code>.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">test_can_convert_polygons_to_mask</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#4e9a06">&#34;&#34;&#34;
</span><span style="color:#4e9a06">    &lt;b&gt;Description:&lt;/b&gt;
</span><span style="color:#4e9a06">    Ensure that the dataset polygon annotation can be properly converted
</span><span style="color:#4e9a06">    into dataset segmentation mask.
</span><span style="color:#4e9a06">
</span><span style="color:#4e9a06">    &lt;b&gt;Expected results:&lt;/b&gt;
</span><span style="color:#4e9a06">    Dataset segmentation mask converted from dataset polygon annotation
</span><span style="color:#4e9a06">    is equal to an expected mask.
</span><span style="color:#4e9a06">
</span><span style="color:#4e9a06">    &lt;b&gt;Steps:&lt;/b&gt;
</span><span style="color:#4e9a06">    1. Prepare dataset with polygon annotation
</span><span style="color:#4e9a06">    2. Prepare dataset with expected mask segmentation mode
</span><span style="color:#4e9a06">    3. Convert source dataset to target, with conversion of annotation
</span><span style="color:#4e9a06">      from polygon to mask.
</span><span style="color:#4e9a06">    4. Verify that resulting segmentation mask is equal to the expected mask.
</span><span style="color:#4e9a06">    &#34;&#34;&#34;</span>
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-bf73365d45cbeba80db44f1ed292b48e">8 - Release notes</h1>
    
	<p>Notes about the release of the developed version can be
read in the <a href="https://github.com/openvinotoolkit/datumaro/blob/develop/CHANGELOG.md">CHANGELOG.md of the develop branch</a>.</p>

</div>



    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-2 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="" aria-label="">
    <a class="text-white" rel="noopener noreferrer" href="">
      <i class=""></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-2 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" rel="noopener noreferrer" href="https://github.com/openvinotoolkit/datumaro">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-8 text-center order-sm-2">
        <small class="mr-1"><a href="https://www.intel.com/content/www/us/en/privacy/intel-privacy-notice.html">Privacy Policy</a></small>
        |
        <small class="mx-1"><a href="https://www.intel.com/content/www/us/en/legal/terms-of-use.html">Terms of Use</a></small>
        <br/>
        <div class="footer-disclaimer text-white ">
          <small>Intel technologies may require enabled hardware, software or service activation. // No product or component can be absolutely secure. // Your costs and results may vary. // Performance varies by use, configuration and other factors. // See our complete legal <u><a href="https://edc.intel.com/content/www/us/en/products/performance/benchmarks/overview/?r=219444055">Notices and Disclaimers</a></u>. // Intel is committed to respecting human rights and avoiding complicity in human rights abuses. See Intel’s <a href="https://www.intel.com/content/www/us/en/policy/policy-human-rights.html"><u>Global Human Rights Principles</u></a>. Intel’s products and software are intended only to be used in applications that do not cause or contribute to a violation of an internationally recognized human right.</small>
        </div>
        
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF" crossorigin="anonymous"></script>


<script src="https://cdn.jsdelivr.net/npm/mermaid@8.9.2/dist/mermaid.min.js" integrity="sha384-uQikAXnCAqsMb3ygtdqBYvcwvHUkzGIpjdGyy9owhURXHUxLC5LgTcSxJQH/RzjK" crossorigin="anonymous"></script>





 













<script src="../../js/main.min.ee00f42d1b949caa55ccf416202998d65afac8f58091e2719c89d4fc3518550e.js" integrity="sha256-7gD0LRuUnKpVzPQWICmY1lr6yPWAkeJxnInU/DUYVQ4=" crossorigin="anonymous"></script>



<script src='../../js/prism.js'></script>



  </body>
</html>
